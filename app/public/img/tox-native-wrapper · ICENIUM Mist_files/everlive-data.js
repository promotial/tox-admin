define(function(e){var b=e("modules/core/dialog-service"),d=e("./everlive-api");var a=window;var c=kendo.data.ObservableObject.extend({init:function(f){var g=this;g.config=f;kendo.data.ObservableObject.fn.init.apply(this,[this])},getFields:function(){var g=this;var f={transport:{read:function(j){var h=this.ApplicationId;var i=j.data.Id;d.getFields(h,i).success(function(l){if(l&&l.Result){for(var k=0;k<l.Result.length;k++){l.Result[k].NodeType="field";l.Result[k].Type="field-"+l.Result[k].DataType}}j.success(l)}).fail(function(){j.success(g.getFailureDatasource());g.trigger(a.EVERLIVE_FAILURE)})}},requestStart:function(h){this.options.transport.ApplicationId=this.parent().ApplicationId},schema:{data:"Result",model:{hasChildren:false,id:"Id",}}};return f},getContentTypes:function(){var g=this;var f={transport:{read:function(i){var h=i.data.Id;d.getContentTypes(h).success(function(k){if(k&&k.Result){for(var j=0;j<k.Result.length;j++){k.Result[j].NodeType="content-type";k.Result[j].Type="content-type-kind-"+k.Result[j].Kind}}i.success(k)}).fail(function(){i.success(g.getFailureDatasource());g.trigger(a.EVERLIVE_FAILURE)})}},schema:{data:"Result",model:{hasChildren:true,id:"Id",children:g.getFields()}}};return f},getApplications:function(){var g=this;var f={transport:{read:function(h){d.getApplications().success(function(k){if(k&&k.Result){for(var j=0;j<k.Result.length;j++){k.Result[j].NodeType="app"}}h.success(k)}).fail(function(i){h.success(g.getFailureDatasource(i));g.trigger(a.EVERLIVE_FAILURE)})}},schema:{data:"Result",model:{hasChildren:true,id:"Id",children:g.getContentTypes()}}};return f},getFailureDatasource:function(f){var g={Count:1,Result:[{NodeType:"err",Title:"Connection failure",Id:-1}]};if($.browser.msie&&$.browser.version<10&&window.XDomainRequest&&f.statusText==="No Transport"){g.Result.splice(0,1);g.Count=0;b.showMessageBox("Icenium","The Data Navigator requires the latest version of Chrome, Firefox, or Internet Explorer 10.")}return g},GetDataSource:function(f){var h=this;d.SetAccountKey(f);var g=new kendo.data.HierarchicalDataSource({transport:{read:function(i){i.success({Result:[{Id:1,Title:"Everllive",NodeType:"everlive-root"}]})}},schema:{data:"Result",model:{hasChildren:true,id:"Id",children:h.getApplications()}}});return g}});return new c()});