define(function(h){var c,a={GITHUB_SAMPLES_LOCATION_ENDPOINT:"https://api.github.com/orgs/Icenium/repos?per_page=100",GITHUB_REGEX:/https:\/\/github.com\/Icenium\/sample-.+\.git$/i,GITHUB_FAIL:"Failed to retrieve samples list. Please try again a little bit later.",REMOTE_LOCK_STATE_UNKNOWN:"unknown",REMOTE_LOCK_STATE_PUBLIC:"public",REMOTE_LOCK_STATE_PRIVATE:"private",REMOTE_TYPE_ID:"sample",LOCAL_CACHE_KEY:"CACHE_ICENUIM_SAMPLES"};var g={set:function(k,l,j){var i=new Date(),m={value:l,expire:new Date()};if(!$.isNumeric(j)){j=1}m.expire.setDate(i.getDate()+j);localStorage.setItem(k,JSON.stringify(m))},get:function(k){var i=new Date(),l=localStorage.getItem(k),m;if(l!==undefined){m=JSON.parse(l);if(m&&m.value&&m.expire){var j=new Date(m.expire);if(j>i){return m.value}}}}};function f(i){return i.match(a.GITHUB_REGEX)}function b(i){return i.charAt(0).toUpperCase()+i.slice(1)}function d(i){return b($.trim(i.replace(/(sample-|-)/gi," ")))}function e(){var j=this,i;if(c===undefined||c.state()==="rejected"){c=new $.Deferred()}else{return c.promise()}i=g.get(a.LOCAL_CACHE_KEY);if(i!==undefined&&i.length>0&&i[0].displayName!==undefined){c.resolve(i)}else{$.ajax({url:a.GITHUB_SAMPLES_LOCATION_ENDPOINT,type:"GET",dataType:"jsonp"}).done(function(o){var p=[];if(o&&o.data&&o.data.length){for(var k=0,m=o.data.length;k<m;k++){var n=o.data[k];if(j.isUrlMatch(n.clone_url)){if(!n[a.REMOTE_LOCK_STATE_PRIVATE]){p.push({remoteId:a.REMOTE_TYPE_ID,name:n.name,displayName:d(n.name),description:n.description,remoteUrl:n.clone_url})}}}p.sort(function(l,q){return(l.name.localeCompare(q.name))});g.set(a.LOCAL_CACHE_KEY,p,1);c.resolve(p)}c.reject(o.data.message)}).fail(function(k){c.reject(a.MSG_GITHUB_FAIL)})}return c.promise()}return{getAllSamples:e,isUrlMatch:f}});