define(function(h){var j,c=h("modules/core/core-module"),a=h("modules/core/base-classes"),g=h("modules/project-navigator/project-navigator-module"),k=h("modules/view-pane/view-pane-renderer-base"),i=h("modules/view-pane/view-pane-adapter"),e=h("text!./html-designer-render-template.html");h("modules/view-pane/html-view-controls-render-module");var b=window;var d=a.ViewModelBase.extend({init:function(){var l=this;a.ViewModelBase.fn.init.apply(l,[l])}});var f={EVENT_SELECT:"select",init:function(){var l=this;k.fn.init.apply(l,arguments)},appendToElement:function(){var m=this,l;k.fn.appendToElement.apply(m,arguments);m._viewModel=new d();m._$designerPane=$(".split-pane:eq(0)",m._$container);m._$element=c.viewRenderer.renderInside(e,m._viewModel,m._$designerPane);$("iframe",m._$element).one("load",function(){l=$("iframe",m._$element)[0].contentWindow;m._designer=l.designer;if(m._designer){m._designer.bind("change",$.proxy(m.onDesignerChange,m));m._designer.bind("select",$.proxy(m.onDesignerSelect,m));m._designer.bind("keypress",$.proxy(m.onDesignerKeypress,m))}})},onDesignerKeypress:function(l){c.keyBindingService.globalKeyHandler(l)},onDesignerSelect:function(l){var m=this;m.trigger(m.EVENT_SELECT,l)},onDesignerChange:function(l){var m=this;m.trigger(m.EVENT_CHANGE,l)},setMarkup:function(n){var p=this,o=g.solutionService.solution().getMobileProject(),l=c.navigationService.getMobileProjectPath(o.text,b.DEVICE_ID_HTML_DESIGNER,o.properties.FrameworkVersion);k.fn.loadViewItem.apply(p,arguments);try{p._designer.feed(n,l+"/")}catch(m){}},supress:function(){var l=this;k.fn.supress.apply(l,arguments);l._viewModel.set("config",null)}};if($.browser.webkit===true&&$.browser.chrome===true){j=k.extend(f);i.registerViewRender(b.VIEW_PANE_RENDER_HTML_DESIGNER,new j())}return f});