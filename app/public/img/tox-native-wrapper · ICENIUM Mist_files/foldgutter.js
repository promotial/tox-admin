(function(){CodeMirror.defineOption("foldGutter",false,function(l,n,m){if(m&&m!=CodeMirror.Init){l.clearGutter(l.state.foldGutter.options.gutter);l.state.foldGutter=null;l.off("gutterClick",e);l.off("change",c);l.off("viewportChange",f);l.off("fold",d);l.off("unfold",d)}if(n){l.state.foldGutter=new i(g(n));k(l);l.on("gutterClick",e);l.on("change",c);l.on("viewportChange",f);l.on("fold",d);l.on("unfold",d)}});var h=CodeMirror.Pos;function i(l){this.options=l;this.from=this.to=0}function g(l){if(l===true){l={}}if(l.gutter==null){l.gutter="CodeMirror-foldgutter"}if(l.indicatorOpen==null){l.indicatorOpen="CodeMirror-foldgutter-open"}if(l.indicatorFolded==null){l.indicatorFolded="CodeMirror-foldgutter-folded"}return l}function a(l,n){var o=l.findMarksAt(h(n));for(var m=0;m<o.length;++m){if(o[m].__isFold&&o[m].find().from.line==n){return true}}}function b(m){if(typeof m=="string"){var l=document.createElement("div");l.className=m;return l}else{return m.cloneNode(true)}}function j(l,n,p){var o=l.state.foldGutter.options,m=n;l.eachLine(n,p,function(r){var s=null;if(a(l,m)){s=b(o.indicatorFolded)}else{var t=h(m,0),q=o.rangeFinder||l.getHelper(t,"fold");var u=q&&q(l,t);if(u&&u.from.line+1<u.to.line){s=b(o.indicatorOpen)}}l.setGutterMarker(r,o.gutter,s);++m})}function k(l){var n=l.getViewport(),m=l.state.foldGutter;if(!m){return}l.operation(function(){j(l,n.from,n.to)});m.from=n.from;m.to=n.to}function e(l,n,m){var o=l.state.foldGutter.options;if(m!=o.gutter){return}l.foldCode(h(n,0),o.rangeFinder)}function c(l){var m=l.state.foldGutter;m.from=m.to=0;clearTimeout(m.changeUpdate);m.changeUpdate=setTimeout(function(){k(l)},600)}function f(l){var m=l.state.foldGutter;clearTimeout(m.changeUpdate);m.changeUpdate=setTimeout(function(){var n=l.getViewport();if(m.from==m.to||n.from-m.to>20||m.from-n.to>20){k(l)}else{l.operation(function(){if(n.from<m.from){j(l,n.from,m.from);m.from=n.from}if(n.to>m.to){j(l,m.to,n.to);m.to=n.to}})}},400)}function d(l,m){var o=l.state.foldGutter,n=m.line;if(n>=o.from&&n<o.to){j(l,n,n+1)}}})();