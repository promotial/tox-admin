(function(){CodeMirror.showHint=function(e,g,h){if(e.somethingSelected()){return}if(g==null){g=e.getHelper(e.getCursor(),"hint")}if(g==null){return}if(e.state.completionActive){e.state.completionActive.close()}var f=e.state.completionActive=new b(e,g,h||{});CodeMirror.signal(e,"startCompletion",e);if(f.options.async){g(e,function(i){f.showHints(i)},f.options)}else{return f.showHints(g(e,f.options))}};function b(e,f,g){this.cm=e;this.getHints=f;this.options=g;this.widget=this.onClose=null}b.prototype={close:function(){if(!this.active()){return}this.cm.state.completionActive=null;if(this.widget){this.widget.close()}if(this.onClose){this.onClose()}CodeMirror.signal(this.cm,"endCompletion",this.cm)},active:function(){return this.cm.state.completionActive==this},pick:function(f,g){var e=f.list[g];if(e.hint){e.hint(this.cm,f,e)}else{this.cm.replaceRange(c(e),f.from,f.to)}this.close()},showHints:function(e){if(!e||!e.list.length||!this.active()){return this.close()}if(this.options.completeSingle!=false&&e.list.length==1){this.pick(e,0)}else{this.showWidget(e)}},showWidget:function(h){this.widget=new d(this,h);CodeMirror.signal(h,"shown");var i=null,g=this,k;var f=this.options.closeCharacters||/[\s()\[\]{};:>,]/;var n=this.cm.getCursor(),m=this.cm.getLine(n.line).length;function j(){if(k){return}k=true;g.close();g.cm.off("cursorActivity",e);if(h){CodeMirror.signal(h,"close")}}function o(){if(k){return}CodeMirror.signal(h,"update");if(g.options.async){g.getHints(g.cm,l,g.options)}else{l(g.getHints(g.cm,g.options))}}function l(p){h=p;if(k){return}if(!h||!h.list.length){return j()}g.widget=new d(g,h)}function e(){clearTimeout(i);var q=g.cm.getCursor(),p=g.cm.getLine(q.line);if(q.line!=n.line||p.length-q.ch!=m-n.ch||q.ch<n.ch||g.cm.somethingSelected()||(q.ch&&f.test(p.charAt(q.ch-1)))){g.close()}else{i=setTimeout(o,170);if(g.widget){g.widget.close()}}}this.cm.on("cursorActivity",e);this.onClose=j}};function c(e){if(typeof e=="string"){return e}else{return e.text}}function a(i,g){var f={Up:function(){g.moveFocus(-1)},Down:function(){g.moveFocus(1)},PageUp:function(){g.moveFocus(-g.menuSize())},PageDown:function(){g.moveFocus(g.menuSize())},Home:function(){g.setFocus(0)},End:function(){g.setFocus(g.length)},Enter:g.pick,Tab:g.pick,Esc:g.close};var j=i.customKeys?{}:f;function e(l,m){var k;if(typeof m!="string"){k=function(n){return m(n,g)}}else{if(f.hasOwnProperty(m)){k=f[m]}else{k=m}}j[l]=k}if(i.customKeys){for(var h in i.customKeys){if(i.customKeys.hasOwnProperty(h)){e(h,i.customKeys[h])}}}if(i.extraKeys){for(var h in i.extraKeys){if(i.extraKeys.hasOwnProperty(h)){e(h,i.extraKeys[h])}}}return j}function d(k,n){this.completion=k;this.data=n;var z=this,j=k.cm,t=k.options;var q=this.hints=document.createElement("ul");q.className="CodeMirror-hints";this.selectedHint=0;var l=n.list;for(var r=0;r<l.length;++r){var o=q.appendChild(document.createElement("li")),m=l[r];var g="CodeMirror-hint"+(r?"":" CodeMirror-hint-active");if(m.className!=null){g=m.className+" "+g}o.className=g;if(m.render){m.render(o,n,m)}else{o.appendChild(document.createTextNode(m.displayText||c(m)))}o.hintId=r}var w=j.cursorCoords(t.alignWithWord!==false?n.from:null);var s=w.left,y=w.bottom,e=true;q.style.left=s+"px";q.style.top=y+"px";var B=window.innerWidth||Math.max(document.body.offsetWidth,document.documentElement.offsetWidth);var A=window.innerHeight||Math.max(document.body.offsetHeight,document.documentElement.offsetHeight);(t.container||document.body).appendChild(q);var f=q.getBoundingClientRect();var u=f.right-B,v=f.bottom-A;if(u>0){if(f.right-f.left>B){q.style.width=(B-5)+"px";u-=(f.right-f.left)-B}q.style.left=(s=w.left-u)+"px"}if(v>0){var p=f.bottom-f.top;if(f.top-(w.bottom-w.top)-p>0){v=p+(w.bottom-w.top);e=false}else{if(p>A){q.style.height=(A-5)+"px";v-=p-A}}q.style.top=(y=w.bottom-v)+"px"}j.addKeyMap(this.keyMap=a(t,{moveFocus:function(i){z.changeActive(z.selectedHint+i)},setFocus:function(i){z.changeActive(i)},menuSize:function(){return z.screenAmount()},length:l.length,close:function(){k.close()},pick:function(){z.pick()}}));if(t.closeOnUnfocus!==false){var h;j.on("blur",this.onBlur=function(){h=setTimeout(function(){k.close()},100)});j.on("focus",this.onFocus=function(){clearTimeout(h)})}var x=j.getScrollInfo();j.on("scroll",this.onScroll=function(){var i=j.getScrollInfo(),C=j.getWrapperElement().getBoundingClientRect();var D=y+x.top-i.top;var E=D-(window.pageYOffset||(document.documentElement||document.body).scrollTop);if(!e){E+=q.offsetHeight}if(E<=C.top||E>=C.bottom){return k.close()}q.style.top=D+"px";q.style.left=(s+x.left-i.left)+"px"});CodeMirror.on(q,"dblclick",function(i){var C=i.target||i.srcElement;if(C.hintId!=null){z.changeActive(C.hintId);z.pick()}});CodeMirror.on(q,"click",function(i){var C=i.target||i.srcElement;if(C.hintId!=null){z.changeActive(C.hintId)}});CodeMirror.on(q,"mousedown",function(){setTimeout(function(){j.focus()},20)});CodeMirror.signal(n,"select",l[0],q.firstChild);return true}d.prototype={close:function(){if(this.completion.widget!=this){return}this.completion.widget=null;this.hints.parentNode.removeChild(this.hints);this.completion.cm.removeKeyMap(this.keyMap);var e=this.completion.cm;if(this.completion.options.closeOnUnfocus!==false){e.off("blur",this.onBlur);e.off("focus",this.onFocus)}e.off("scroll",this.onScroll)},pick:function(){this.completion.pick(this.data,this.selectedHint)},changeActive:function(e){e=Math.max(0,Math.min(e,this.data.list.length-1));if(this.selectedHint==e){return}var f=this.hints.childNodes[this.selectedHint];f.className=f.className.replace(" CodeMirror-hint-active","");f=this.hints.childNodes[this.selectedHint=e];f.className+=" CodeMirror-hint-active";if(f.offsetTop<this.hints.scrollTop){this.hints.scrollTop=f.offsetTop-3}else{if(f.offsetTop+f.offsetHeight>this.hints.scrollTop+this.hints.clientHeight){this.hints.scrollTop=f.offsetTop+f.offsetHeight-this.hints.clientHeight+3}}CodeMirror.signal(this.data,"select",this.data.list[this.selectedHint],f)},screenAmount:function(){return Math.floor(this.hints.clientHeight/this.hints.firstChild.offsetHeight)||1}}})();