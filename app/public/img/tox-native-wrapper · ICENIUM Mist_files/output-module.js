define(function(n){var g=n("kendo"),f=n("modules/core/core-module"),b=n("modules/core/base-commands"),o=n("modules/workspace/solution-frame-service"),j=n("dom!bottomRegion"),k=n("text!./output-template.html"),h=n("modules/logging/logging-service"),c=n("text!./clear-button-template.html"),a=$(k);n("modules/workspace/sidebar-module");n("css!./output.css");var e=window;var i=g.Observable.extend({init:function(){var r=this,s,p=h.getDataSource(),q=new m();g.Observable.fn.init.apply(this,arguments);f.frameService.addItemToRegion(e.BOTTOM_REGION,{name:"Output",element:a});o.bind(e.LEFT_CENTER_SPLITTER_RESIZE,$.proxy(q.onOutputResize,q));s=new l(p);q.bindViewModel(s,a);r.registerCommand();r.clearCommand.bind(r.clearCommand.events.CLEAR_OUTPUT,$.proxy(s.clear,s))},registerCommand:function(){var p=this;p.clearCommand=new d(e.COMMAND_CLEAR_OUTPUT,"Clear",[e.OUTPUT_COMMANDS],[]);f.commandService.registerCommand(p.clearCommand);f.viewRenderer.renderInside(c,p.clearCommand,j)}});var d=b.CommandBase.extend({events:{CLEAR_OUTPUT:"clearOutput"},init:function(){var p=this;b.CommandBase.fn.init.apply(p,arguments);p.featureCategory=e.TrackingTags.featureCategory.ProjectNavigation.name;p.featureName=e.TrackingTags.featureCategory.ProjectNavigation.features.ClearConsole},execute:function(){var p=this;p.trigger(p.events.CLEAR_OUTPUT)}});var l=g.data.ObservableObject.extend({outputDS:null,init:function(p){var q=this;g.data.ObservableObject.fn.init.apply(q,[q]);q.set("outputDS",p);q.setFilter();p.bind("change",$.proxy(q.scroll,q))},clear:function(){var r=this,p=r.get("outputDS").view();for(var q=0;q<p.length;q++){p[q].set("cleared",true)}r.setFilter()},setFilter:function(){var p=this;p.get("outputDS").filter({logic:"and",filters:[{field:"type",operator:"eq",value:e.LOG_OUTPUT},{field:"cleared",operator:"eq",value:false}]})},scroll:function(p){var q=this;if(p.action==="add"){$("#entriesList").data("kendoListView").refresh();a.parent().scrollTop(a.height())}}});var m=f.ViewRendererBase.extend({bind:function(p){var q=this;q.viewModel=p.viewModel},onOutputResize:function(){window.setTimeout(function(){var s=$("#"+e.BOTTOM_REGION),p=s.children(".k-content");var t=s.parent().innerHeight(),r=s.children(".k-tabstrip-items").outerHeight(),q=t-r-8;p.height(q)},1)}});return new i()});