(function(){CodeMirror.defineOption("autoCloseTags",false,function(e,h,g){if(h&&(g==CodeMirror.Init||!g)){var f={name:"autoCloseTags"};if(typeof h!="object"||h.whenClosing){f["'/'"]=function(i){return a(i,"/")}}if(typeof h!="object"||h.whenOpening){f["'>'"]=function(i){return a(i,">")}}e.addKeyMap(f)}else{if(!h&&(g!=CodeMirror.Init&&g)){e.removeKeyMap("autoCloseTags")}}});var b=["area","base","br","col","command","embed","hr","img","input","keygen","link","meta","param","source","track","wbr"];var c=["applet","blockquote","body","button","div","dl","fieldset","form","frameset","h1","h2","h3","h4","h5","h6","head","html","iframe","layer","legend","object","ol","p","select","table","ul"];function a(f,e){var o=f.getCursor(),r=f.getTokenAt(o);var l=CodeMirror.innerMode(f.getMode(),r.state),p=l.state;if(l.mode.name!="xml"){return CodeMirror.Pass}var n=f.getOption("autoCloseTags"),j=l.mode.configuration=="html";var i=(typeof n=="object"&&n.dontCloseTags)||(j&&b);var k=(typeof n=="object"&&n.indentTags)||(j&&c);if(e==">"&&p.tagName){var q=p.tagName;if(r.end>o.ch){q=q.slice(0,q.length-r.end+o.ch)}var m=q.toLowerCase();if(r.type=="tag"&&p.type=="closeTag"||r.string.indexOf("/")==(r.string.length-1)||i&&d(i,m)>-1){return CodeMirror.Pass}var h=k&&d(k,m)>-1;var g=h?CodeMirror.Pos(o.line+1,0):CodeMirror.Pos(o.line,o.ch+1);f.replaceSelection(">"+(h?"\n\n":"")+"</"+q+">",{head:g,anchor:g});if(h){f.indentLine(o.line+1);f.indentLine(o.line+2)}return}else{if(e=="/"&&r.string=="<"){var q=p.context&&p.context.tagName;if(q){f.replaceSelection("/"+q+">","end")}return}}return CodeMirror.Pass}function d(f,h){if(f.indexOf){return f.indexOf(h)}for(var j=0,g=f.length;j<g;++j){if(f[j]==h){return j}}return -1}})();