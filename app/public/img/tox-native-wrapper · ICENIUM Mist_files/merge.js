(function(){var s=CodeMirror.Pos;var A="http://www.w3.org/2000/svg";function h(D,E){this.mv=D;this.type=E;this.classes=E=="left"?{chunk:"CodeMirror-merge-l-chunk",start:"CodeMirror-merge-l-chunk-start",end:"CodeMirror-merge-l-chunk-end",insert:"CodeMirror-merge-l-inserted",del:"CodeMirror-merge-l-deleted",connect:"CodeMirror-merge-l-connect"}:{chunk:"CodeMirror-merge-r-chunk",start:"CodeMirror-merge-r-chunk-start",end:"CodeMirror-merge-r-chunk-end",insert:"CodeMirror-merge-r-inserted",del:"CodeMirror-merge-r-deleted",connect:"CodeMirror-merge-r-connect"}}h.prototype={constructor:h,init:function(F,E,D){this.edit=this.mv.edit;this.orig=CodeMirror(F,g({value:E,readOnly:true},g(D)));this.diff=m(E,D.value);this.diffOutOfDate=false;this.showDifferences=D.showDifferences!==false;this.forceUpdate=x(this);y(this,true,false);w(this)},setShowDifferences:function(D){D=D!==false;if(D!=this.showDifferences){this.showDifferences=D;this.forceUpdate("full")}}};function x(F){var G={from:0,to:0,marked:[]};var H={from:0,to:0,marked:[]};var E;function J(K){if(K=="full"){if(F.svg){d(F.svg)}d(F.copyButtons);e(F.edit,G.marked,F.classes);e(F.orig,H.marked,F.classes);G.from=G.to=H.from=H.to=0}if(F.diffOutOfDate){F.diff=m(F.orig.getValue(),F.edit.getValue());F.diffOutOfDate=false}if(F.showDifferences){C(F.edit,F.diff,G,DIFF_INSERT,F.classes);C(F.orig,F.diff,H,DIFF_DELETE,F.classes)}j(F)}function I(K){clearTimeout(E);E=setTimeout(J,K==true?250:100)}function D(){if(!F.diffOutOfDate){F.diffOutOfDate=true;G.from=G.to=H.from=H.to=0}I(true)}F.edit.on("change",D);F.orig.on("change",D);F.edit.on("viewportChange",I);F.orig.on("viewportChange",I);J();return J}function w(D){D.edit.on("scroll",function(){B(D,DIFF_INSERT)&&j(D)});D.orig.on("scroll",function(){B(D,DIFF_DELETE)&&j(D)})}function B(G,U){if(G.diffOutOfDate){return false}if(!G.lockScroll){return true}var H,P,M=+new Date;if(U==DIFF_INSERT){H=G.edit;P=G.orig}else{H=G.orig;P=G.edit}if(H.state.scrollSetBy==G&&(H.state.scrollSetAt||0)+50>M){return false}var S=H.getScrollInfo(),I=0.5*S.clientHeight,K=S.top+I;var J=H.lineAtHeight(K,"local");var D=c(G.diff,J,U==DIFF_INSERT);var N=n(H,U==DIFF_INSERT?D.edit:D.orig);var O=n(P,U==DIFF_INSERT?D.orig:D.edit);var R=(K-N.top)/(N.bot-N.top);var T=(O.top-I)+R*(O.bot-O.top);var E,L;if(T>S.top&&(L=S.top/I)<1){T=T*L+S.top*(1-L)}else{if((E=S.height-S.clientHeight-S.top)<I){var Q=P.getScrollInfo();var F=Q.height-Q.clientHeight-T;if(F>E&&(L=E/I)<1){T=T*L+(Q.height-Q.clientHeight-E)*(1-L)}}}P.scrollTo(S.left,T);P.state.scrollSetAt=M;P.state.scrollSetBy=G;return true}function n(F,D){var E=D.after;if(E==null){E=F.lastLine()+1}return{top:F.heightAtLine(D.before||0,"local"),bot:F.heightAtLine(E,"local")}}function y(E,F,D){E.lockScroll=F;if(F&&D!=false){B(E,DIFF_INSERT)&&j(E)}E.lockButton.innerHTML=F?"\u21db\u21da":"\u21db&nbsp;&nbsp;\u21da"}function e(F,D,E){for(var G=0;G<D.length;++G){var H=D[G];if(H instanceof CodeMirror.TextMarker){H.clear()}else{F.removeLineClass(H,"background",E.chunk);F.removeLineClass(H,"background",E.start);F.removeLineClass(H,"background",E.end)}}D.length=0}function C(F,E,G,H,D){var I=F.getViewport();F.operation(function(){if(G.from==G.to||I.from-G.to>20||G.from-I.to>20){e(F,G.marked,D);p(F,E,H,G.marked,I.from,I.to,D);G.from=I.from;G.to=I.to}else{if(I.from<G.from){p(F,E,H,G.marked,I.from,G.from,D);G.from=I.from}if(I.to>G.to){p(F,E,H,G.marked,G.to,I.to,D);G.to=I.to}}})}function p(M,L,Y,R,O,V,H){var T=s(0,0);var W=s(O,0),F=M.clipPos(s(V-1));var K=Y==DIFF_DELETE?H.del:H.insert;function Q(ae,ab){var Z=Math.max(O,ae),aa=Math.min(V,ab);for(var ac=Z;ac<aa;++ac){var ad=M.addLineClass(ac,"background",H.chunk);if(ac==ae){M.addLineClass(ad,"background",H.start)}if(ac==ab-1){M.addLineClass(ad,"background",H.end)}R.push(ad)}if(ae==ab&&Z==ab&&aa==ab){if(Z){R.push(M.addLineClass(Z-1,"background",H.end))}else{R.push(M.addLineClass(Z,"background",H.start))}}}var G=0;for(var P=0;P<L.length;++P){var S=L[P],X=S[0],U=S[1];if(X==DIFF_EQUAL){var I=T.line+(z(L,P)?0:1);r(T,U);var J=T.line+(l(L,P)?1:0);if(J>I){if(P){Q(G,I)}G=J}}else{if(X==Y){var N=r(T,U,true);var D=u(W,T),E=v(F,N);if(!t(D,E)){R.push(M.markText(D,E,{className:K}))}T=N}}}if(G<=T.line){Q(G,T.line+1)}}function j(D){if(!D.showDifferences){return}if(D.svg){d(D.svg);var J=D.gap.offsetWidth;a(D.svg,"width",J,"height",D.gap.offsetHeight)}d(D.copyButtons);var E=D.type=="left";var H=D.edit.getViewport(),I=D.orig.getViewport();var F=D.edit.getScrollInfo().top,G=D.orig.getScrollInfo().top;o(D.diff,function(V,M,T,K){if(T>H.to||K<H.from||V>I.to||M<I.from){return}var U=D.orig.heightAtLine(V,"local")-G,S=U;if(D.svg){var W=D.edit.heightAtLine(T,"local")-F;if(E){var R=U;U=W;W=R}var L=D.orig.heightAtLine(M,"local")-G;var N=D.edit.heightAtLine(K,"local")-F;if(E){var R=L;L=N;N=R}var Q=" C "+J/2+" "+W+" "+J/2+" "+U+" "+(J+2)+" "+U;var P=" C "+J/2+" "+L+" "+J/2+" "+N+" -1 "+N;a(D.svg.appendChild(document.createElementNS(A,"path")),"d","M -1 "+W+Q+" L "+(J+2)+" "+L+P+" z","class",D.classes.connect)}var O=D.copyButtons.appendChild(k("div",D.type=="left"?"\u21dd":"\u21dc","CodeMirror-merge-copy"));O.title="Revert chunk";O.chunk={topEdit:T,botEdit:K,topOrig:V,botOrig:M};O.style.top=S+"px"})}function f(E,D){if(E.diffOutOfDate){return}E.edit.replaceRange(E.orig.getRange(s(D.topOrig,0),s(D.botOrig,0)),s(D.topEdit,0),s(D.botEdit,0))}var q=CodeMirror.MergeView=function(I,K){if(!(this instanceof q)){return new q(I,K)}var L=K.origLeft,M=K.origRight==null?K.orig:K.origRight;var E=L!=null,F=M!=null;var N=1+(E?1:0)+(F?1:0);var R=[],G=this.left=null,P=this.right=null;if(E){G=this.left=new h(this,"left");var H=k("div",null,"CodeMirror-merge-pane");R.push(H);R.push(b(G))}var D=k("div",null,"CodeMirror-merge-pane");R.push(D);if(F){P=this.right=new h(this,"right");R.push(b(P));var Q=k("div",null,"CodeMirror-merge-pane");R.push(Q)}(F?Q:D).className+=" CodeMirror-merge-pane-rightmost";R.push(k("div",null,null,"height: 0; clear: both;"));var S=this.wrap=I.appendChild(k("div",R,"CodeMirror-merge CodeMirror-merge-"+N+"pane"));this.edit=CodeMirror(D,g(K));if(G){G.init(H,L,K)}if(P){P.init(Q,M,K)}var J=function(){if(G){j(G)}if(P){j(P)}};CodeMirror.on(window,"resize",J);var O=setInterval(function(){for(var T=S.parentNode;T&&T!=document.body;T=T.parentNode){}if(!T){clearInterval(O);CodeMirror.off(window,"resize",J)}},5000)};function b(D){var F=D.lockButton=k("div",null,"CodeMirror-merge-scrolllock");F.title="Toggle locked scrolling";var G=k("div",[F],"CodeMirror-merge-scrolllock-wrap");CodeMirror.on(F,"click",function(){y(D,!D.lockScroll)});D.copyButtons=k("div",null,"CodeMirror-merge-copybuttons-"+D.type);CodeMirror.on(D.copyButtons,"click",function(I){var J=I.target||I.srcElement;if(J.chunk){f(D,J.chunk)}});var E=[D.copyButtons,G];var H=document.createElementNS&&document.createElementNS(A,"svg");if(H&&!H.createSVGRect){H=null}D.svg=H;if(H){E.push(H)}return D.gap=k("div",E,"CodeMirror-merge-gap")}q.prototype={constuctor:q,editor:function(){return this.edit},rightOriginal:function(){return this.right&&this.right.orig},leftOriginal:function(){return this.left&&this.left.orig},setShowDifferences:function(D){if(this.right){this.right.setShowDifferences(D)}if(this.left){this.left.setShowDifferences(D)}}};var i=new diff_match_patch();function m(D,E){var F=i.diff_main(D,E);i.diff_cleanupSemantic(F);for(var G=0;G<F.length;++G){var H=F[G];if(!H[1]){F.splice(G--,1)}else{if(G&&F[G-1][0]==H[0]){F.splice(G--,1);F[G][1]+=H[1]}}}return F}function o(H,K){var O=0,Q=0;var I=s(0,0),M=s(0,0);for(var L=0;L<H.length;++L){var N=H[L],R=N[0];if(R==DIFF_EQUAL){var P=z(H,L)?0:1;var D=I.line+P,E=M.line+P;r(I,N[1],null,M);var J=l(H,L)?1:0;var F=I.line+J,G=M.line+J;if(F>D){if(L){K(Q,E,O,D)}O=F;Q=G}}else{r(R==DIFF_INSERT?I:M,N[1])}}if(O<=I.line||Q<=M.line){K(Q,M.line+1,O,I.line+1)}}function l(D,E){if(E==D.length-1){return true}var F=D[E+1][1];if(F.length==1||F.charCodeAt(0)!=10){return false}if(E==D.length-2){return true}F=D[E+2][1];return F.length>1&&F.charCodeAt(0)==10}function z(D,E){if(E==0){return true}var F=D[E-1][1];if(F.charCodeAt(F.length-1)!=10){return false}if(E==1){return true}F=D[E-2][1];return F.charCodeAt(F.length-1)==10}function c(H,I,J){var F,D,G,E;o(H,function(M,P,K,N){var L=J?K:M;var O=J?N:P;if(D==null){if(L>I){D=K;E=M}else{if(O>I){D=N;E=P}}}if(O<=I){F=N;G=P}else{if(L<=I){F=K;G=M}}});return{edit:{before:F,after:D},orig:{before:G,after:E}}}function k(I,E,D,H){var F=document.createElement(I);if(D){F.className=D}if(H){F.style.cssText=H}if(typeof E=="string"){F.appendChild(document.createTextNode(E))}else{if(E){for(var G=0;G<E.length;++G){F.appendChild(E[G])}}}return F}function d(E){for(var D=E.childNodes.length;D>0;--D){E.removeChild(E.firstChild)}}function a(D){for(var E=1;E<arguments.length;E+=2){D.setAttribute(arguments[E],arguments[E+1])}}function g(D,F){if(!F){F={}}for(var E in D){if(D.hasOwnProperty(E)){F[E]=D[E]}}return F}function r(I,J,E,G){var H=E?s(I.line,I.ch):I,D=0;for(;;){var F=J.indexOf("\n",D);if(F==-1){break}++H.line;if(G){++G.line}D=F+1}H.ch=(D?0:H.ch)+(J.length-D);if(G){G.ch=(D?0:G.ch)+(J.length-D)}return H}function v(D,E){return(D.line-E.line||D.ch-E.ch)<0?D:E}function u(D,E){return(D.line-E.line||D.ch-E.ch)>0?D:E}function t(D,E){return D.line==E.line&&D.ch==E.ch}})();