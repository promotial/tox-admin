define(function(d){var a=d("modules/core/dialog-viewmodels"),e=d("modules/version-control/version-control-diff-dialog-module"),h=d("text!./version-control-file-history-dialog-template.html");var c={};var b=a.MessageBoxViewModel.extend({_selectedItems:[],isDiffApplicable:false,init:function(i){var j=this;j.fileName=i.fileName;j.fileHistory=i.fileHistory;a.MessageBoxViewModel.fn.init.apply(j,arguments);j.bind("bind",$.proxy(j.onBind,j))},onBind:function(){var l=this;var j=[];for(var k=0;k<l.fileHistory.length;k++){j.push({dateTime:l.fileHistory[k].CommitTime,filePath:l.fileHistory[k].FilePath,changeType:l.fileHistory[k].ChangeType,versionName:l.fileHistory[k].VersionName})}l.fileHistoryGrid=$("#fileHistoryGrid").kendoGrid({dataSource:new kendo.data.DataSource({data:j}),columns:[{title:"Date",template:"<span>#= kendo.toString(kendo.parseDate(dateTime), 'G') #</span>",width:"125px"},{field:"filePath",title:"Name",width:"300px"},{field:"status",title:"Status",template:"<span title='#=changeType#'  class='ico-version-control change-type-#=changeType#' />",width:"50px"}],selectable:"multiple, row",scrollable:true,change:function(m){var o=this.select();if(o.length>=c.versionControlDiffConsts.DIFF_TOOL_SOURCES_MIN&&o.length<=c.versionControlDiffConsts.DIFF_TOOL_SOURCES_MAX){l.set("isDiffApplicable",true);l._selectedItems=[];for(var n=0;n<o.length;n++){l._selectedItems.push(this.dataItem(o[n]))}}else{l.set("isDiffApplicable",false)}}}).data("kendoGrid")},onShowDiff:function(){var i=this;c.versionControlDiffService.showDiff({readOnly:true,filePath:i._selectedItems[0].filePath,leftSideVersionName:i._selectedItems[1].versionName,rightSideVersionName:i._selectedItems[0].versionName})}});function g(){c.versionControlDiffService=e.versionControlDiffService;c.versionControlDiffConsts=e.consts}g.prototype={init:function(){},getTemplate:function(){return h},getViewModel:function(i){if(i===undefined||i.fileName===undefined||i.fileHistory===undefined){return null}return new b(i)}};var f=new g();f.init();return f});