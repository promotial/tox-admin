(function(a){if(typeof exports=="object"&&typeof module=="object"){return a(exports,require("acorn/acorn"),require("acorn/acorn_loose"),require("acorn/util/walk"),require("./def"),require("./signal"))}if(typeof define=="function"&&define.amd){return define(["exports","acorn/acorn","acorn/acorn_loose","acorn/util/walk","./def","./signal"],a)}a(self.tern||(self.tern={}),acorn,acorn,acorn.walk,tern.def,tern.signal)})(function(n,a,b,am,m,af){var ai=n.toString=function(az,ax,ay){return !az||az==ay?"?":az.toString(ax)};var d=n.ANull=af.mixin({addType:function(){},propagate:function(){},getProp:function(){return d},forAllProps:function(){},hasType:function(){return false},isEmpty:function(){return true},getFunctionType:function(){},getType:function(){},gatherProperties:function(){},propagatesTo:function(){},typeHint:function(){},propHint:function(){}});function o(aA,az){var ax=Object.create(aA);if(az){for(var ay in az){ax[ay]=az[ay]}}return ax}var ao=100,at=90,aq=10,ar=5,an=5,ap=2,au=2;var f=n.AVal=function(){this.types=[];this.forward=null;this.maxWeight=0};f.prototype=o(d,{addType:function(ay,az){az=az||ao;if(this.maxWeight<az){this.maxWeight=az;if(this.types.length==1&&this.types[0]==ay){return}this.types.length=0}else{if(this.maxWeight>az||this.types.indexOf(ay)>-1){return}}this.signal("addType",ay);this.types.push(ay);var ax=this.forward;if(ax){aw(function(aA){for(var aB=0;aB<ax.length;++aB){aA(ay,ax[aB],az)}})}},propagate:function(ax,az){if(ax==d||(ax instanceof aj)){return}if(az&&az<ao){ax=new L(ax,az)}(this.forward||(this.forward=[])).push(ax);var ay=this.types,az=this.maxWeight;if(ay.length){aw(function(aA){for(var aB=0;aB<ay.length;++aB){aA(ay[aB],ax,az)}})}},getProp:function(ay){if(ay=="__proto__"||ay=="?"){return d}var ax=(this.props||(this.props=Object.create(null)))[ay];if(!ax){ax=this.props[ay]=new f;this.propagate(new T(ay,ax))}return ax},forAllProps:function(ax){this.propagate(new u(ax))},hasType:function(ax){return this.types.indexOf(ax)>-1},isEmpty:function(){return this.types.length==0},getFunctionType:function(){for(var ax=this.types.length-1;ax>=0;--ax){if(this.types[ax] instanceof s){return this.types[ax]}}},getType:function(ax){if(this.types.length==0&&ax!==false){return this.makeupType()}if(this.types.length==1){return this.types[0]}return i(this.types)},makeupType:function(){if(!this.forward){return null}for(var aA=this.forward.length-1;aA>=0;--aA){var az=this.forward[aA].typeHint();if(az&&!az.isEmpty()){w=true;return az}}var aF=Object.create(null),ay=null;for(var aA=0;aA<this.forward.length;++aA){var aE=this.forward[aA].propHint();if(aE&&aE!="length"&&aE!="<i>"&&aE!="?"){aF[aE]=true;ay=aE}}if(!ay){return null}var aD=P(ay);if(aD){var aB=[];search:for(var aA=0;aA<aD.length;++aA){var aC=aD[aA];for(var aE in aF){if(!aC.hasProp(aE)){continue search}}if(aC.hasCtor){aC=v(aC)}aB.push(aC)}var ax=i(aB);if(ax){w=true;return ax}}},typeHint:function(){return this.types.length?this.getType():null},propagatesTo:function(){return this},gatherProperties:function(ay,ax){for(var az=0;az<this.types.length;++az){this.types[az].gatherProperties(ay,ax)}},guessProperties:function(ax){if(this.forward){for(var ay=0;ay<this.forward.length;++ay){var az=this.forward[ay].propHint();if(az){ax(az,null,0)}}}}});function i(aI){var ax=0,ay=0,aE=0,aF=null;for(var az=0;az<aI.length;++az){var aH=aI[az];if(aH instanceof e){++ax}else{if(aH instanceof s){++ay}else{if(aH instanceof O){++aE}else{if(aH instanceof R){if(aF&&aH.name!=aF.name){return null}aF=aH}}}}}var aB=(ax&&1)+(ay&&1)+(aE&&1)+(aF&&1);if(aB>1){return null}if(aF){return aF}var aC=0,aD=null;for(var az=0;az<aI.length;++az){var aH=aI[az],aG=0;if(ax){aG=aH.getProp("<i>").isEmpty()?1:2}else{if(ay){aG=1;for(var aA=0;aA<aH.args.length;++aA){if(!aH.args[aA].isEmpty()){++aG}}if(!aH.retval.isEmpty()){++aG}}else{if(aE){aG=aH.name?100:2}else{if(prims){aG=1}}}}if(aG>=aC){aC=aG;aD=aH}}return aD}function k(){}k.prototype=o(d,{init:function(){this.origin=l.curOrigin}});var j=n.constraint=function(aC,aB){var ax="this.init();";aC=aC?aC.split(", "):[];for(var az=0;az<aC.length;++az){ax+="this."+aC[az]+" = "+aC[az]+";"}var ay=Function.apply(null,aC.concat([ax]));ay.prototype=Object.create(k.prototype);for(var aA in aB){if(aB.hasOwnProperty(aA)){ay.prototype[aA]=aB[aA]}}return ay};var T=j("prop, target",{addType:function(ax,ay){if(ax.getProp){ax.getProp(this.prop).propagate(this.target,ay)}},propHint:function(){return this.prop},propagatesTo:function(){return{target:this.target,pathExt:"."+this.prop}}});var S=n.PropHasSubset=j("prop, type, originNode",{addType:function(ay,az){if(!(ay instanceof O)){return}var ax=ay.defProp(this.prop,this.originNode);ax.origin=this.origin;this.type.propagate(ax,az)},propHint:function(){return this.prop}});var u=j("c",{addType:function(ax){if(!(ax instanceof O)){return}ax.forAllProps(this.c)}});function av(ay,ax){l.disabledComputing={fn:ay,prev:l.disabledComputing};try{return ax()}finally{l.disabledComputing=l.disabledComputing.prev}}var D=n.IsCallee=j("self, args, argNodes, retval",{init:function(){k.prototype.init();this.disabled=l.disabledComputing},addType:function(az,aB){if(!(az instanceof s)){return}for(var aA=0;aA<this.args.length;++aA){if(aA<az.args.length){this.args[aA].propagate(az.args[aA],aB)}if(az.arguments){this.args[aA].propagate(az.arguments,aB)}}this.self.propagate(az.self,this.self==l.topScope?ap:aB);var ax=az.computeRet;if(ax){for(var ay=this.disabled;ay;ay=ay.prev){if(ay.fn==az||az.name&&ay.fn.name==az.name){ax=null}}}if(ax){ax(this.self,this.args,this.argNodes).propagate(this.retval,aB)}else{az.retval.propagate(this.retval,aB)}},typeHint:function(){var ay=[];for(var ax=0;ax<this.args.length;++ax){ay.push("?")}return new s(null,this.self,this.args,ay,d)},propagatesTo:function(){return{target:this.retval,pathExt:".!ret"}}});var x=j("propName, args, argNodes, retval",{init:function(){k.prototype.init();this.disabled=l.disabledComputing},addType:function(ay,az){var ax=new D(ay,this.args,this.argNodes,this.retval);ax.disabled=this.disabled;ay.getProp(this.propName).propagate(ax,az)},propHint:function(){return this.propName}});var E=n.IsCtor=j("target, noReuse",{addType:function(ax,ay){if(!(ax instanceof s)){return}ax.getProp("prototype").propagate(new F(this.noReuse?false:ax,this.target),ay)}});var v=n.getInstance=function(aB,ax){if(ax===false){return new O(aB)}if(!ax){ax=aB.hasCtor}if(!aB.instances){aB.instances=[]}for(var az=0;az<aB.instances.length;++az){var ay=aB.instances[az];if(ay.ctor==ax){return ay.instance}}var aA=new O(aB,ax&&ax.name);aA.origin=aB.origin;aB.instances.push({ctor:ax,instance:aA});return aA};var F=n.IsProto=j("ctor, target",{addType:function(ay,ax){if(!(ay instanceof O)){return}if((this.count=(this.count||0)+1)>8){return}if(ay==l.protos.Array){this.target.addType(new e)}else{this.target.addType(v(ay,this.ctor))}}});var t=j("fn",{addType:function(az,ax){if(az instanceof O&&!az.hasCtor){az.hasCtor=this.fn;var ay=new ah(az,this.fn);ay.addType(this.fn);az.forAllProps(function(aA,aC,aB){if(aB){aC.propagate(ay)}})}}});var C=j("other, target",{addType:function(ax,ay){if(ax==l.str){this.target.addType(l.str,ay)}else{if(ax==l.num&&this.other.hasType(l.num)){this.target.addType(l.num,ay)}}},typeHint:function(){return this.other}});var y=j("target",{addType:function(ax,ay){if(ax instanceof O){this.target.addType(ax,ay)}},propagatesTo:function(){return this.target}});var ah=j("obj, ctor",{addType:function(ax){if(ax instanceof s&&ax.self&&ax.self.isEmpty()){ax.self.addType(v(this.obj,this.ctor),au)}}});var L=j("inner, weight",{addType:function(ax,ay){this.inner.addType(ax,Math.min(ay,this.weight))},propagatesTo:function(){return this.inner.propagatesTo()},typeHint:function(){return this.inner.typeHint()},propHint:function(){return this.inner.propHint()}});var aj=n.Type=function(){};aj.prototype=o(d,{propagate:function(ax,ay){ax.addType(this,ay)},hasType:function(ax){return ax==this},isEmpty:function(){return false},typeHint:function(){return this},getType:function(){return this}});var R=n.Prim=function(ay,ax){this.name=ax;this.proto=ay};R.prototype=o(aj.prototype,{toString:function(){return this.name},getProp:function(ax){return this.proto.hasProp(ax)||d},gatherProperties:function(ay,ax){if(this.proto){this.proto.gatherProperties(ay,ax)}}});var O=n.Obj=function(az,ay){if(!this.props){this.props=Object.create(null)}this.proto=az===true?l.protos.Object:az;if(az&&!ay&&az.name&&!(this instanceof s)){var ax=/^(.*)\.prototype$/.exec(this.proto.name);if(ax){ay=ax[1]}}this.name=ay;this.maybeProps=null;this.origin=l.curOrigin};O.prototype=o(aj.prototype,{toString:function(ay){if(!ay&&this.name){return this.name}var aA=[],ax=false;for(var az in this.props){if(az!="<i>"){if(aA.length>5){ax=true;break}if(ay){aA.push(az+": "+ai(this.props[az].getType(),ay-1))}else{aA.push(az)}}}aA.sort();if(ax){aA.push("...")}return"{"+aA.join(", ")+"}"},hasProp:function(az,aA){var ax=this.props[az];if(aA!==false){for(var ay=this.proto;ay&&!ax;ay=ay.proto){ax=ay.props[az]}}return ax},defProp:function(aA,az){var ay=this.hasProp(aA,false);if(ay){if(az&&!ay.originNode){ay.originNode=az}return ay}if(aA=="__proto__"||aA=="?"){return d}var ax=this.maybeProps&&this.maybeProps[aA];if(ax){delete this.maybeProps[aA];this.maybeUnregProtoPropHandler()}else{ax=new f}this.props[aA]=ax;ax.originNode=az;ax.origin=l.curOrigin;this.broadcastProp(aA,ax,true);return ax},getProp:function(ay){var ax=this.hasProp(ay,true)||(this.maybeProps&&this.maybeProps[ay]);if(ax){return ax}if(ay=="__proto__"||ay=="?"){return d}if(!this.maybeProps){if(this.proto){this.proto.forAllProps(this)}this.maybeProps=Object.create(null)}return this.maybeProps[ay]=new f},broadcastProp:function(aA,aB,az){if(az){this.signal("addProp",aA,aB);if(!(this instanceof aa)){X(aA,this)}}if(this.onNewProp){for(var ay=0;ay<this.onNewProp.length;++ay){var ax=this.onNewProp[ay];ax.onProtoProp?ax.onProtoProp(aA,aB,az):ax(aA,aB,az)}}},onProtoProp:function(az,aA,ax){var ay=this.maybeProps&&this.maybeProps[az];if(ay){delete this.maybeProps[az];this.maybeUnregProtoPropHandler();this.proto.getProp(az).propagate(ay)}this.broadcastProp(az,aA,false)},forAllProps:function(ax){if(!this.onNewProp){this.onNewProp=[];if(this.proto){this.proto.forAllProps(this)}}this.onNewProp.push(ax);for(var ay=this;ay;ay=ay.proto){for(var az in ay.props){if(ax.onProtoProp){ax.onProtoProp(az,ay.props[az],ay==this)}else{ax(az,ay.props[az],ay==this)}}}},maybeUnregProtoPropHandler:function(){if(this.maybeProps){for(var ax in this.maybeProps){return}this.maybeProps=null}if(!this.proto||this.onNewProp&&this.onNewProp.length){return}this.proto.unregPropHandler(this)},unregPropHandler:function(ax){for(var ay=0;ay<this.onNewProp.length;++ay){if(this.onNewProp[ay]==ax){this.onNewProp.splice(ay,1);break}}this.maybeUnregProtoPropHandler()},gatherProperties:function(ay,ax){for(var az in this.props){if(az!="<i>"){ay(az,this,ax)}}if(this.proto){this.proto.gatherProperties(ay,ax+1)}}});var s=n.Fn=function(az,aB,ay,ax,aA){O.call(this,l.protos.Function,az);this.self=aB;this.args=ay;this.argNames=ax;this.retval=aA};s.prototype=o(O.prototype,{toString:function(ay){if(ay){ay--}var aA="fn(";for(var ax=0;ax<this.args.length;++ax){if(ax){aA+=", "}var az=this.argNames[ax];if(az&&az!="?"){aA+=az+": "}aA+=ai(this.args[ax].getType(),ay,this)}aA+=")";if(!this.retval.isEmpty()){aA+=" -> "+ai(this.retval.getType(),ay,this)}return aA},getProp:function(ay){if(ay=="prototype"){var ax=this.hasProp(ay,false);if(!ax){ax=this.defProp(ay);var az=new O(true,this.name&&this.name+".prototype");az.origin=this.origin;ax.addType(az,aq)}return ax}return O.prototype.getProp.call(this,ay)},defProp:function(az,ay){if(az=="prototype"){var ax=this.hasProp(az,false);if(ax){return ax}ax=O.prototype.defProp.call(this,az,ay);ax.origin=this.origin;ax.propagate(new t(this));return ax}return O.prototype.defProp.call(this,az,ay)},getFunctionType:function(){return this}});var e=n.Arr=function(ay){O.call(this,l.protos.Array);var ax=this.defProp("<i>");if(ay){ay.propagate(ax)}};e.prototype=o(O.prototype,{toString:function(ax){return"["+ai(this.getProp("<i>").getType(),ax,this)+"]"}});function X(az,ay){var ax=l.props[az]||(l.props[az]=[]);ax.push(ay)}function P(ax){return l.props[ax]}n.Context=function(ax,ay){this.parent=ay;this.props=Object.create(null);this.protos=Object.create(null);this.prim=Object.create(null);this.origins=[];this.curOrigin="ecma5";this.paths=Object.create(null);this.definitions=Object.create(null);this.purgeGen=0;this.workList=null;this.disabledComputing=null;n.withContext(this,function(){l.protos.Object=new O(null,"Object.prototype");l.topScope=new aa();l.topScope.name="<top>";l.protos.Array=new O(true,"Array.prototype");l.protos.Function=new O(true,"Function.prototype");l.protos.RegExp=new O(true,"RegExp.prototype");l.protos.String=new O(true,"String.prototype");l.protos.Number=new O(true,"Number.prototype");l.protos.Boolean=new O(true,"Boolean.prototype");l.str=new R(l.protos.String,"string");l.bool=new R(l.protos.Boolean,"bool");l.num=new R(l.protos.Number,"number");l.curOrigin=null;if(ax){for(var az=0;az<ax.length;++az){m.load(ax[az])}}})};var l=null;n.cx=function(){return l};n.withContext=function(ax,ay){var az=l;l=ax;try{return ay()}finally{l=az}};n.addOrigin=function(ax){if(l.origins.indexOf(ax)<0){l.origins.push(ax)}};var g=20,V=0.0001;function aw(az){if(l.workList){return az(l.workList)}var aB=[],ay=0;var ax=l.workList=function(aE,aD,aF){if(ay<g-V*aB.length){aB.push(aE,aD,aF,ay)}};try{var aC=az(ax);for(var aA=0;aA<aB.length;aA+=4){ay=aB[aA+3]+1;aB[aA+1].addType(aB[aA],aB[aA+2])}return aC}finally{l.workList=null}}var aa=n.Scope=function(ax){O.call(this,ax||true);this.prev=ax};aa.prototype=o(O.prototype,{defVar:function(ay,az){for(var aA=this;;aA=aA.proto){var ax=aA.props[ay];if(ax){return ax}if(!aA.prev){return aA.defProp(ay,az)}}}});function I(ax,ay){if(ax.fnType){ax.fnType.instantiateScore=(ax.fnType.instantiateScore||0)+ay}}var N={};function M(az,ay){try{am.simple(az,{Expression:function(){if(--ay<=0){throw N}}});return true}catch(ax){if(ax==N){return false}throw ax}}function K(ax,ay){var az=ay.fnType.instantiateScore;if(!l.disabledComputing&&az&&ay.fnType.args.length&&M(ax,az*5)){I(ay.prev,az/2);ae(ax,ay);return true}else{ay.fnType.instantiateScore=null}}function ae(az,aA){var ax=aA.fnType;for(var ay=0;ay<ax.args.length;++ay){ax.args[ay]=new f}ax.self=new f;ax.computeRet=function(aC,aB){return av(ax,function(){var aH=l.curOrigin;l.curOrigin=ax.origin;var aI=new aa(aA.prev);for(var aJ in aA.props){var aG=aI.defProp(aJ);for(var aF=0;aF<aB.length;++aF){if(ax.argNames[aF]==aJ&&aF<aB.length){aB[aF].propagate(aG)}}}var aD=ax.argNames.length!=aB.length?ax.argNames.slice(0,aB.length):ax.argNames;while(aD.length<aB.length){aD.push("?")}aI.fnType=new s(ax.name,aC,aB,aD,d);if(ax.arguments){var aE=aI.fnType.arguments=new f;aI.defProp("arguments").addType(new e(aE));for(var aF=0;aF<aB.length;++aF){aB[aF].propagate(aE)}}az.body.scope=aI;am.recursive(az.body,aI,null,ac);am.recursive(az.body,aI,null,B);l.curOrigin=aH;return aI.fnType.retval})}}function J(aD){var az=aD.fnType,aE=az.retval;if(aE==d){return}var aF,ax;if(!aE.isEmpty()&&(aF=aE.getType()) instanceof e){aE=ax=aF.getProp("<i>")}function ay(aG,aM,aH){if(aH>3||!aG.forward){return}for(var aK=0;aK<aG.forward.length;++aK){var aN=aG.forward[aK].propagatesTo();if(!aN){continue}var aL=aM,aI;if(aN instanceof f){aI=aN}else{if(aN.target instanceof f){aL+=aN.pathExt;aI=aN.target}else{continue}}if(aI==aE){return aL}var aJ=ay(aI,aL,aH+1);if(aJ){return aJ}}}var aA=ay(az.self,"!this",0);for(var aB=0;!aA&&aB<az.args.length;++aB){aA=ay(az.args[aB],"!"+aB,0)}if(aA){if(ax){aA="["+aA+"]"}var aC=new m.TypeParser(aA);az.computeRet=aC.parseRetType();az.computeRetSource=aA;return true}}function c(ay,ax){var az=ay.defProp(ax.name,ax);if(az.maybePurge){az.maybePurge=false}return az}var ac=am.make({Function:function(aD,aF,az){var aC=aD.body.scope=new aa(aF);aC.node=aD;var ay=[],ax=[];for(var aB=0;aB<aD.params.length;++aB){var aE=aD.params[aB];ax.push(aE.name);ay.push(c(aC,aE))}aC.fnType=new s(aD.id&&aD.id.name,new f,ay,ax,d);aC.fnType.originNode=aD;if(aD.id){var aA=aD.type=="FunctionDeclaration";c(aA?aF:aC,aD.id)}az(aD.body,aC,"ScopeBody")},TryStatement:function(az,aA,ax){ax(az.block,aA,"Statement");if(az.handler){var aB=c(aA,az.handler.param);ax(az.handler.body,aA,"ScopeBody");var ay=l.definitions.ecma5;if(ay&&aB.isEmpty()){v(ay["Error.prototype"]).propagate(aB,an)}}if(az.finalizer){ax(az.finalizer,aA,"Statement")}},VariableDeclaration:function(aA,aB,ax){for(var az=0;az<aA.declarations.length;++az){var ay=aA.declarations[az];c(aB,ay.id);if(ay.init){ax(ay.init,aB,"Expression")}}}});function U(ay,aA,ax){var az=ay.property;if(!ay.computed){return az.name}if(az.type=="Literal"&&typeof az.value=="string"){return az.value}if(ax){z(az,aA,ax,d)}return"<i>"}function al(ax){switch(ax){case"+":case"-":case"~":return l.num;case"!":return l.bool;case"typeof":return l.str;case"void":case"delete":return d}}function h(ax){switch(ax){case"==":case"!=":case"===":case"!==":case"<":case">":case">=":case"<=":case"in":case"instanceof":return true}}function G(ax){switch(typeof ax){case"boolean":return l.bool;case"number":return l.num;case"string":return l.str;case"object":if(!ax){return d}return v(l.protos.RegExp)}}function Y(ax){return function(aA,aD,ay,aB,az){var aC=ax(aA,aD,ay,az);if(aB){aC.propagate(aB)}return aC}}function p(ax){return function(aA,aC,ay,aB,az){if(!aB){aB=new f}ax(aA,aC,ay,aB,az);return aB}}var A={ArrayExpression:Y(function(aB,aC,ax){var az=new f;for(var aA=0;aA<aB.elements.length;++aA){var ay=aB.elements[aA];if(ay){z(ay,aC,ax,az)}}return new e(az)}),ObjectExpression:Y(function(aB,aE,ax,aA){var aC=aB.objType=new O(true,aA);aC.originNode=aB;for(var ay=0;ay<aB.properties.length;++ay){var aD=aB.properties[ay],az=aD.key,aA;if(az.type=="Identifier"){aA=az.name}else{if(typeof az.value=="string"){aA=az.value}else{z(aD.value,aE,ax,d);continue}}var aF=aC.defProp(aA,az);aF.initializer=true;z(aD.value,aE,ax,aF,aA)}return aC}),FunctionExpression:Y(function(aB,aC,ax,aA){var az=aB.body.scope,ay=az.fnType;if(aA&&!ay.name){ay.name=aA}ax(aB.body,aC,"ScopeBody");K(aB,az)||J(az);if(aB.id){az.getProp(aB.id.name).addType(ay)}return ay}),SequenceExpression:Y(function(aA,aB,ax){for(var ay=0,az=aA.expressions.length-1;ay<az;++ay){z(aA.expressions[ay],aB,ax,d)}return z(aA.expressions[az],aB,ax)}),UnaryExpression:Y(function(ay,az,ax){z(ay.argument,az,ax,d);return al(ay.operator)}),UpdateExpression:Y(function(ay,az,ax){z(ay.argument,az,ax,d);return l.num}),BinaryExpression:Y(function(az,aC,ax){if(az.operator=="+"){var ay=z(az.left,aC,ax);var aB=z(az.right,aC,ax);if(ay.hasType(l.str)||aB.hasType(l.str)){return l.str}if(ay.hasType(l.num)&&aB.hasType(l.num)){return l.num}var aA=new f;ay.propagate(new C(aB,aA));aB.propagate(new C(ay,aA));return aA}else{z(az.left,aC,ax,d);z(az.right,aC,ax,d);return h(az.operator)?l.bool:l.num}}),AssignmentExpression:Y(function(aB,aG,ax){var aF,aA,aE;if(aB.left.type=="MemberExpression"){aE=U(aB.left,aG,ax);if(aB.left.object.type=="Identifier"){aA=aB.left.object.name+"."+aE}}else{aA=aB.left.name}if(aB.operator!="="&&aB.operator!="+="){z(aB.right,aG,ax,d);aF=l.num}else{aF=z(aB.right,aG,ax,null,aA)}if(aB.left.type=="MemberExpression"){var aC=z(aB.left.object,aG,ax);if(aE=="prototype"){I(aG,20)}if(aE=="<i>"){var aH=aB.left.property.name,az=aG.props[aH],aD=az&&az.iteratesOver;if(aD){I(aG,20);var ay=aB.right.type=="MemberExpression"&&aB.right.computed&&aB.right.property.name==aH;aD.forAllProps(function(aJ,aK,aI){if(aI&&aJ!="prototype"&&aJ!="<i>"){aC.propagate(new S(aJ,ay?aK:d))}});return aF}}aC.propagate(new S(aE,aF,aB.left.property))}else{var aH=aG.defVar(aB.left.name,aB.left);if(aH.maybePurge){aH.maybePurge=false}aF.propagate(aH)}return aF}),LogicalExpression:p(function(ay,aA,ax,az){z(ay.left,aA,ax,az);z(ay.right,aA,ax,az)}),ConditionalExpression:p(function(ay,aA,ax,az){z(ay.test,aA,ax,d);z(ay.consequent,aA,ax,az);z(ay.alternate,aA,ax,az)}),NewExpression:p(function(aC,aE,ay,aD,aB){if(aC.callee.type=="Identifier"&&aC.callee.name in aE.props){I(aE,20)}for(var aA=0,ax=[];aA<aC.arguments.length;++aA){ax.push(z(aC.arguments[aA],aE,ay))}var az=z(aC.callee,aE,ay);var aF=new f;az.propagate(new E(aF,aB&&/\.prototype$/.test(aB)));aF.propagate(aD,at);az.propagate(new D(aF,ax,aC.arguments,new y(aD)))}),CallExpression:p(function(aC,aF,ay,aD){for(var aA=0,ax=[];aA<aC.arguments.length;++aA){ax.push(z(aC.arguments[aA],aF,ay))}if(aC.callee.type=="MemberExpression"){var aG=z(aC.callee.object,aF,ay);var aE=U(aC.callee,aF,ay);if((aE=="call"||aE=="apply")&&aF.fnType&&aF.fnType.args.indexOf(aG)>-1){I(aF,30)}aG.propagate(new x(aE,ax,aC.arguments,aD))}else{var az=z(aC.callee,aF,ay);if(aF.fnType&&aF.fnType.args.indexOf(az)>-1){I(aF,30)}var aB=az.getFunctionType();if(aB&&aB.instantiateScore&&aF.fnType){I(aF,aB.instantiateScore/5)}az.propagate(new D(l.topScope,ax,aC.arguments,aD))}}),MemberExpression:Y(function(az,aD,ax){var ay=U(az,aD);var aA=z(az.object,aD,ax);var aB=aA.getProp(ay);if(ay=="<i>"){var aC=z(az.property,aD,ax);if(!aC.hasType(l.num)){var aE=new f;aB.propagate(aE,ar);return aE}}return aB}),Identifier:Y(function(ax,ay){if(ax.name=="arguments"&&ay.fnType&&!(ax.name in ay.props)){ay.defProp(ax.name,ay.fnType.originNode).addType(new e(ay.fnType.arguments=new f))}return ay.getProp(ax.name)}),ThisExpression:Y(function(ax,ay){return ay.fnType?ay.fnType.self:l.topScope}),Literal:Y(function(ax){return G(ax.value)})};function z(az,aB,ax,aA,ay){return A[az.type](az,aB,ax,aA,ay)}var B=am.make({Expression:function(ay,az,ax){z(ay,az,ax,d)},FunctionDeclaration:function(aA,aC,ax){var az=aA.body.scope,ay=az.fnType;ax(aA.body,aC,"ScopeBody");K(aA,az)||J(az);var aB=aC.getProp(aA.id.name);aB.addType(ay)},VariableDeclaration:function(aA,aC,ax){for(var az=0;az<aA.declarations.length;++az){var ay=aA.declarations[az],aB=aC.getProp(ay.id.name);if(ay.init){z(ay.init,aC,ax,aB,ay.id.name)}}},ReturnStatement:function(ay,az,ax){if(ay.argument&&az.fnType){if(az.fnType.retval==d){az.fnType.retval=new f}z(ay.argument,az,ax,az.fnType.retval)}},ForInStatement:function(ay,az,ax){var aA=z(ay.right,az,ax);if((ay.right.type=="Identifier"&&ay.right.name in az.props)||(ay.right.type=="MemberExpression"&&ay.right.property.name=="prototype")){I(az,5);var aB;if(ay.left.type=="Identifier"){aB=ay.left.name}else{if(ay.left.type=="VariableDeclaration"){aB=ay.left.declarations[0].id.name}}if(aB&&aB in az.props){az.getProp(aB).iteratesOver=aA}}ax(ay.body,az,"Statement")},ScopeBody:function(ay,az,ax){ax(ay,ay.scope||az)}});function Z(aB,aA){var ay=aB&&aB[aA];var ax=Array.prototype.slice.call(arguments,2);if(ay){for(var az=0;az<ay.length;++az){ay[az].apply(null,ax)}}}var Q=n.parse=function(aA,az){var ax;try{ax=a.parse(aA)}catch(ay){ax=b.parse_dammit(aA)}Z(az,"postParse",ax,aA);return ax};n.analyze=function(ax,ay,aA,az){if(typeof ax=="string"){ax=Q(ax)}if(!ay){ay="file#"+l.origins.length}n.addOrigin(l.curOrigin=ay);if(!aA){aA=l.topScope}am.recursive(ax,aA,null,ac);Z(az,"preInfer",ax,aA);am.recursive(ax,aA,null,B);Z(az,"postInfer",ax,aA);l.curOrigin=null};n.purgeTypes=function(aB,aD,ax){var aE=H(aB,aD,ax);++l.purgeGen;l.topScope.purge(aE);for(var aC in l.props){var az=l.props[aC];for(var ay=0;ay<az.length;++ay){var aA=az[ay];if(aE(aA,aA.originNode)){az.splice(ay--,1)}}}};function H(az,aA,ay){var ax=Array.isArray(az);if(ax&&az.length==1){az=az[0];ax=false}if(ax){if(ay==null){return function(aB){return az.indexOf(aB.origin)>-1}}return function(aB,aC){return aC&&aC.start>=aA&&aC.end<=ay&&az.indexOf(aB.origin)>-1}}else{if(ay==null){return function(aB){return aB.origin==az}}return function(aB,aC){return aC&&aC.start>=aA&&aC.end<=ay&&aB.origin==az}}}f.prototype.purge=function(az){if(this.purgeGen==l.purgeGen){return}this.purgeGen=l.purgeGen;for(var ay=0;ay<this.types.length;++ay){var aA=this.types[ay];if(az(aA,aA.originNode)){this.types.splice(ay--,1)}else{aA.purge(az)}}if(this.forward){for(var ay=0;ay<this.forward.length;++ay){var ax=this.forward[ay];if(az(ax)){this.forward.splice(ay--,1);if(this.props){this.props=null}}else{if(ax.purge){ax.purge(az)}}}}};d.purge=function(){};O.prototype.purge=function(ay){if(this.purgeGen==l.purgeGen){return true}this.purgeGen=l.purgeGen;for(var ax in this.props){this.props[ax].purge(ay)}};s.prototype.purge=function(ay){if(O.prototype.purge.call(this,ay)){return}this.self.purge(ay);this.retval.purge(ay);for(var ax=0;ax<this.args.length;++ax){this.args[ax].purge(ay)}};n.markVariablesDefinedBy=function(aC,ay,aD,ax){var aE=H(ay,aD,ax);for(var aB=aC;aB;aB=aB.prev){for(var az in aB.props){var aA=aB.props[az];if(aE(aA,aA.originNode)){aA.maybePurge=true;if(aD==null&&aA.originNode){aA.originNode=null}}}}};n.purgeMarkedVariables=function(az){for(var ay=az;ay;ay=ay.prev){for(var ax in ay.props){if(ay.props[ax].maybePurge){delete ay.props[ax]}}}};function q(az){w=true;var ax=P(az);if(ax){for(var ay=0;ay<ax.length;++ay){var aA=ax[ay].getProp(az);if(!aA.isEmpty()){return aA}}}return d}var ak={ArrayExpression:function(aA,aB){var ay=new f;for(var az=0;az<aA.elements.length;++az){var ax=aA.elements[az];if(ax){r(ax,aB).propagate(ay)}}return new e(ay)},ObjectExpression:function(ax){return ax.objType},FunctionExpression:function(ax){return ax.body.scope.fnType},SequenceExpression:function(ax,ay){return r(ax.expressions[ax.expressions.length-1],ay)},UnaryExpression:function(ax){return al(ax.operator)},UpdateExpression:function(){return l.num},BinaryExpression:function(ay,aA){if(h(ay.operator)){return l.bool}if(ay.operator=="+"){var ax=r(ay.left,aA);var az=r(ay.right,aA);if(ax.hasType(l.str)||az.hasType(l.str)){return l.str}}return l.num},AssignmentExpression:function(ax,ay){return r(ax.right,ay)},LogicalExpression:function(ay,az){var ax=r(ay.left,az);return ax.isEmpty()?r(ay.right,az):ax},ConditionalExpression:function(ay,az){var ax=r(ay.consequent,az);return ax.isEmpty()?r(ay.alternate,az):ax},NewExpression:function(ay,aA){var ax=r(ay.callee,aA).getFunctionType();var az=ax&&ax.getProp("prototype").getType();if(!az){return d}return v(az,ax)},CallExpression:function(aA,aB){var ay=r(aA.callee,aB).getFunctionType();if(!ay){return d}if(ay.computeRet){for(var az=0,ax=[];az<aA.arguments.length;++az){ax.push(r(aA.arguments[az],aB))}var aC=d;if(aA.callee.type=="MemberExpression"){aC=r(aA.callee.object,aB)}return ay.computeRet(aC,ax,aA.arguments)}else{return ay.retval}},MemberExpression:function(ax,aA){var az=U(ax,aA),ay=r(ax.object,aA).getType();if(ay){return ay.getProp(az)}if(az=="<i>"){return d}return q(az)},Identifier:function(ax,ay){return ay.hasProp(ax.name)||d},ThisExpression:function(ax,ay){return ay.fnType?ay.fnType.self:l.topScope},Literal:function(ax){return G(ax.value)}};function r(ay,az){var ax=ak[ay.type](ay,az);return ax}var ad=n.searchVisitor=am.make({Function:function(aA,ax,ay){var aB=aA.body.scope;if(aA.id){ay(aA.id,aB)}for(var az=0;az<aA.params.length;++az){ay(aA.params[az],aB)}ay(aA.body,aB,"ScopeBody")},TryStatement:function(ay,az,ax){if(ay.handler){ax(ay.handler.param,az)}am.base.TryStatement(ay,az,ax)},VariableDeclaration:function(aA,aB,ax){for(var az=0;az<aA.declarations.length;++az){var ay=aA.declarations[az];ax(ay.id,aB);if(ay.init){ax(ay.init,aB,"Expression")}}}});n.fullVisitor=am.make({MemberExpression:function(ay,az,ax){ax(ay.object,az,"Expression");ax(ay.property,az,ay.computed?"Expression":null)},ObjectExpression:function(az,aA,ax){for(var ay=0;ay<az.properties.length;++ay){ax(az.properties[ay].value,aA,"Expression");ax(az.properties[ay].key,aA)}}},ad);n.findExpressionAt=function(ax,aB,az,ay,aA){var aC=aA||function(aD,aE){return ak.hasOwnProperty(aE.type)};return am.findNodeAt(ax,aB,az,aC,ad,ay||l.topScope)};n.findExpressionAround=function(ax,aB,az,ay,aA){var aC=aA||function(aD,aE){if(aB!=null&&aE.start>aB){return false}return ak.hasOwnProperty(aE.type)};return am.findNodeAround(ax,az,aC,ad,ay||l.topScope)};n.expressionType=function(ax){return r(ax.node,ax.state)};var w=false;n.resetGuessing=function(ax){w=ax};n.didGuess=function(){return w};n.forAllPropertiesOf=function(ay,ax){ay.gatherProperties(ax,0)};var W=am.make({},ad);n.findRefs=function(ax,ay,aA,aB,az){W.Identifier=function(aC,aE){if(aC.name!=aA){return}for(var aD=aE;aD;aD=aD.prev){if(aD==aB){az(aC,aE)}if(aA in aD.props){return}}};am.recursive(ax,ay,null,W)};var ag=am.make({Function:function(az,ax,ay){ay(az.body,az.body.scope,"ScopeBody")}});n.findPropRefs=function(ax,aB,az,aA,ay){am.simple(ax,{MemberExpression:function(aC,aD){if(aC.computed||aC.property.name!=aA){return}if(r(aC.object,aD).getType()==az){ay(aC.property)}},ObjectExpression:function(aD,aE){if(r(aD,aE).getType()!=az){return}for(var aC=0;aC<aD.properties.length;++aC){if(aD.properties[aC].key.name==aA){ay(aD.properties[aC].key)}}}},ag,aB)};var ab=n.scopeAt=function(ax,aA,ay){var az=am.findNodeAround(ax,aA,function(aC,aB){return aC=="ScopeBody"&&aB.scope});if(az){return az.node.scope}else{return ay||l.topScope}};n.forAllLocalsAt=function(ax,aA,ay,az){var aB=ab(ax,aA,ay);aB.gatherProperties(az,0)};m=n.def=m.init({},n)});