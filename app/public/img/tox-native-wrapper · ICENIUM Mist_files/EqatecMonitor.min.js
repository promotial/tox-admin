(function(b){function e(i){var c=!1,o="",l=0,n=1,p={},q=[],r=[],s=function(g){if(a.isString(g)){var h=a.trim(a.asString(g));if(h){if(a.stringTooLong(i,h,1000)){return null}var g="eq_"+g,j=p[g];j||(j={featureName:h,sessionHitCount:0,timingStart:0},p[g]=j);return j}return null}},t=function(){r=[];q=[]};return{addFeatureUsage:function(f){if(f=s(f)){f.sessionHitCount+=1,n++}},startFeatureTiming:function(f){if((f=s(f))&&!(0<f.timingStart)){f.timingStart=a.getTimeStamp()}},endFeatureTiming:function(g){if((g=s(g))&&0!==g.timingStart){var h=a.getTimeStamp(),j=h-g.timingStart;g.timingStart=0;q.push({name:g.featureName,value:j,type:1,runtime:h-l});n++}},cancelFeatureTiming:function(f){if(f=s(f)){f.timingStart=0}},addFeatureValue:function(h,j){var k=a.trim(a.asString(h));if(k&&a.isNumber(j)){var m=a.getTimeStamp();q.push({name:k,value:j,type:0,runtime:m-l});n++}},addException:function(j,u){if(j){var v=a.asString(u),w=a.getTimeStamp(),A="",z=typeof j,y=j.message||j.name||"";try{A=a.stackTrace({e:j})}catch(x){a.error(i,"could not format stacktrace: "+x.message)}10<r.length&&(a.logMessage(i,"removing oldest exception"),r.pop());r.push({type:z,message:y,runtime:w-l,info:v,stacktrace:A});n++}},setInstallationID:function(f){if(!a.stringTooLong(i,f,50)&&(f=a.asString(f))){o=f,n++}},reset:t,clear:function(){t();p={}},getPayload:function(){var f=[],g;for(g in p){if(p.hasOwnProperty(g)){var h=p[g];h.sessionHitCount&&f.push({name:h.featureName,sessionHitCount:h.sessionHitCount})}}return{installationId:o,stopped:c?"0":"1",features:f,exceptions:r,featurevalues:q}},startTime:l,version:function(){return n},startSession:function(){l=a.getTimeStamp();c=!0},stopSession:function(){c=!1}}}var a={isFunction:function(c){return c&&"function"===typeof c},callIfFunction:function(f){try{a.isFunction(f)&&f()}catch(c){}},isString:function(c){return c&&"string"===typeof c},asString:function(f){var c="";f&&(c=a.isFunction(f)?a.asString(f()):f.toString());return c},trim:function(c){return c?!String.prototype.trim?c.replace(/^\s\s*/,"").replace(/\s\s*$/,""):c.trim():""},getTimeStamp:function(){return(new Date).getTime()},isNumber:function(c){return"number"===typeof c},parseURL:function(g){for(var f="source protocol authority userInfo user password host port relative path directory file query anchor".split(" "),h={},i=14,g=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/.exec(g);i--;){h[f[i]]=g[i]||""}return h},getServerUri:function(g,c,j){if(j&&a.isString(j)){try{var h=a.parseURL(j);if(h&&h.host){return(h.protocol?h.protocol+"://":"//")+h.host+(h.port?":"+h.port:"")+"/json.ashx"}a.log(g,"Could not parse serverUri to valid format:"+j)}catch(i){a.log(g,"unable to parse serverUri to valid format:"+j)}}g="https";window&&(window.location&&"https:"!=window.location.protocol)&&(g="http");return g+"://"+c+".monitor-eqatec.com/json.ashx"},log:function(g,c){try{g&&(a.isFunction(g.logMessage)&&c&&a.isString(c))&&g.logMessage(c)}catch(h){}},error:function(g,c){try{g&&(a.isFunction(g.logError)&&c&&a.isString(c))&&g.logError(c)}catch(h){}},getInfo:function(i){var c={},n=navigator,l=screen,m=document;c.screen=l?l.width+"x"+l.height:"-";c.depth=l?l.colorDepth+"-bit":"-";c.language=(n&&(n.language||n.userLanguage)||"-").toLowerCase();c.characterSet=m.characterSet||m.charset||"-";try{var o=m.documentElement,p=m.body,q=p&&p.clientWidth&&p.clientHeight,n=[];o&&(o.clientWidth&&o.clientHeight&&("CSS1Compat"===m.compatMode||!q)?n=[o.clientWidth,o.clientHeight]:q&&(n=[p.clientWidth,p.clientHeight]));c.clientsize=n.join("x")}catch(r){a.error(i,"Unable to read browser info: "+r.message)}return c},generateId:function(){for(var f=void 0,c=void 0,c=f="";36>f++;c+=51*f&52?(f^15?8^Math.random()*(f^20?16:4):4).toString(16):"-"){}return c},setCookie:function(h,c,k,i,j){var l=document;l&&(h=h+"="+c+";path="+k+";",i&&0<i&&(i=new Date(a.getTimeStamp()+i),h+="expires="+i.toUTCString()+";"),j&&(h+="domain="+j+";"),l.cookie=h)},getCookie:function(g){var f=document.cookie.split(";"),h;for(h=0;h<f.length;h++){var i=f[h].split("=");if(2==i.length&&g==i[0]){return i[1]}}return null},setTimeout:function(g,c){try{if(a.isFunction(g)&&a.isNumber(c)){return b.setTimeout(g,c)}}catch(h){}return 0},clearTimeout:function(f){try{a.isNumber(f)&&b.clearTimeout(f)}catch(c){}},cookiesEnabled:function(){try{var f=navigator.cookieEnabled?!0:!1;"undefined"==typeof navigator.cookieEnabled&&!f&&(document.cookie="testcookie",f=-1!=document.cookie.indexOf("testcookie")?!0:!1);return f}catch(c){}return !1},trackingDisabled:function(){return !1},stringTooLong:function(g,c,h){return !a.isString(c)||!a.isNumber(h)?!0:a.asString(c).length>h?(a.error(g,"Input is too long: "+c),!0):!1}};(function(){function i(f){return 10>f?"0"+f:f}function c(f){m.lastIndex=0;return m.test(f)?'"'+f.replace(m,function(g){var h=q[g];return"string"===typeof h?h:"\\u"+("0000"+g.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+f+'"'}function n(f,g){var h,k,t,v,u=o,w,s=g[f];s&&"object"===typeof s&&"function"===typeof s.toJSON&&(s=s.toJSON(f));"function"===typeof r&&(s=r.call(g,f,s));switch(typeof s){case"string":return c(s);case"number":return isFinite(s)?""+s:"null";case"boolean":case"null":return""+s;case"object":if(!s){return"null"}o+=p;w=[];if("[object Array]"===Object.prototype.toString.apply(s)){v=s.length;for(h=0;h<v;h+=1){w[h]=n(h,s)||"null"}t=0===w.length?"[]":o?"[\n"+o+w.join(",\n"+o)+"\n"+u+"]":"["+w.join(",")+"]";o=u;return t}if(r&&"object"===typeof r){v=r.length;for(h=0;h<v;h+=1){"string"===typeof r[h]&&(k=r[h],(t=n(k,s))&&w.push(c(k)+(o?": ":":")+t))}}else{for(k in s){Object.prototype.hasOwnProperty.call(s,k)&&(t=n(k,s))&&w.push(c(k)+(o?": ":":")+t)}}t=0===w.length?"{}":o?"{\n"+o+w.join(",\n"+o)+"\n"+u+"}":"{"+w.join(",")+"}";o=u;return t;default:return""+s}}var l;l||(l={});"function"!==typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+i(this.getUTCMonth()+1)+"-"+i(this.getUTCDate())+"T"+i(this.getUTCHours())+":"+i(this.getUTCMinutes())+":"+i(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()});var m=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,o,p,q={"\u0008":"\\b","\t":"\\t","\n":"\\n","\u000c":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},r;"function"!==typeof l.stringify&&(l.stringify=function(f,g,h){var j;p=o="";if("number"===typeof h){for(j=0;j<h;j+=1){p+=" "}}else{"string"===typeof h&&(p=h)}if((r=g)&&"function"!==typeof g&&("object"!==typeof g||"number"!==typeof g.length)){throw Error("JSON.stringify")}return n("",{"":f})});a.encodeJSON=l.stringify})();(function(){function c(f){f=f&&f.e?f.e:null;return(new c.implementation).run(f)}c.implementation=function(){};c.implementation.prototype={run:function(f){if(!f){return""}var g;if(!(g=f)){g=void 0}f=g;g=this._mode||this.mode(f);return"other"===g?this.other(arguments.callee):this[g](f)},mode:function(f){return f.arguments?this._mode="chrome":window.opera&&f.stacktrace?this._mode="opera10":f.stack?this._mode="firefox":window.opera&&!("stacktrace" in f)?this._mode="opera":this._mode="other"},chrome:function(f){return f.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@").split("\n")},firefox:function(f){return f.stack.replace(/(?:\n@:0)?\s+$/m,"").replace(/^\(/gm,"{anonymous}(").split("\n")},opera10:function(f){var f=f.stacktrace.split("\n"),i=/.*line (\d+), column (\d+) in ((<anonymous function\:?\s*(\S+))|([^\(]+)\([^\)]*\))(?: in )?(.*)\s*$/i,k,l,m;k=2;l=0;for(m=f.length;k<m-2;k++){if(i.test(f[k])){var n=RegExp.$6+":"+RegExp.$1+":"+RegExp.$2,o=RegExp.$3,o=o.replace(/<anonymous function\:?\s?(\S+)?>/g,"{anonymous}");f[l++]=o+"@"+n}}f.splice(l,f.length-l);return f},opera:function(f){var f=f.message.split("\n"),h=/Line\s+(\d+).*script\s+(http\S+)(?:.*in\s+function\s+(\S+))?/i,i,j,k;i=4;j=0;for(k=f.length;i<k;i+=2){h.test(f[i])&&(f[j++]=(RegExp.$3?RegExp.$3+"()@"+RegExp.$2+RegExp.$1:"{anonymous}()@"+RegExp.$2+":"+RegExp.$1)+" -- "+f[i+1].replace(/^\s+/,""))}f.splice(j,f.length-j);return f},other:function(f){for(var i=/function\s*([\w\-$]+)?\s*\(/i,k=[],l=0,m,n;f&&10>k.length;){m=i.test(f.toString());n=[];try{n=Array.prototype.slice.call(f.arguments),f=f.caller}catch(o){f=null}m=m?RegExp.$1||"{anonymous}":"{anonymous}";k[l++]=m+"("+this.stringifyArguments(n)+")";if(!f){break}}return k},stringifyArguments:function(f){for(var g=0;g<f.length;++g){var h=f[g];void 0===h?f[g]="undefined":null===h?f[g]="null":h.constructor&&(h.constructor===Array?f[g]=3>h.length?"["+this.stringifyArguments(h)+"]":"["+this.stringifyArguments(Array.prototype.slice.call(h,0,1))+"..."+this.stringifyArguments(Array.prototype.slice.call(h,-1))+"]":h.constructor===Object?f[g]="#object":h.constructor===Function?f[g]="#function":h.constructor===String&&(f[g]='"'+h+'"'))}return f.join(",")}};a.stackTrace=c})();var d=b._eqatec||{};b._eqatec=d;d.createMonitor=function(n){var c=0,w="",s=!1,v={logError:function(){},logMessage:function(){}},z=0,A=!1,C=!1,D="",F="",H="",I={},K=!1,J=!1,L="",E={};try{n=n||{},w=a.trim(a.asString(n.productId))||"",v=n.loggingInterface||v,H=n.version,I=n.location||{},K=a.cookiesEnabled()&&n.useCookies,J=a.trackingDisabled(),L=a.getServerUri(v,w,n.serverUri),E=e(v),(32>w.length||36<w.length)&&a.error(v,"Invalid productId assigned, expecting between 32 and 36 characters: "+w)}catch(G){a.log(v,"failed while initializing monitor")}var B=function(f){try{!s&&!f?a.log(v,"monitor not started"):A&&!f?C=!0:(M(f),E.reset())}catch(g){a.log(v,"failed while calling forceSync")}},N=function(f){var g=a.getTimeStamp(),k=g-c,j={version:H,monitorversion:"3.2.9",productId:w,sessionId:D,startCount:startCount,userId:F,runtime:k,clienttime:g,starttime:c,session:E.getPayload()};I&&(I.latitude&&I.longitude)&&(j.location=I);f.push("pv=4");f.push("mv=3.2.9");f.push("pi="+encodeURIComponent(w));f.push("av="+encodeURIComponent(H));f.push("mt=js");f.push("ps="+(z+1));f.push("ct="+g);f.push("rt="+k);0===z&&(j.info=a.getInfo(v));return a.encodeJSON(j)},M=function(g){try{var h=!0===g?" Monitor stopped.":"";a.getTimeStamp();C=!1;var i,j,g=[];E.version();j=N(g);var l="?"+g.join("&"),l=L+l;if(XMLHttpRequest&&void 0===i){var p=new XMLHttpRequest;"withCredentials" in p&&void 0!==p.withCredentials&&(p.open("POST",l,!0),p.setRequestHeader("Content-Type","text/plain"),p.onreadystatechange=function(){try{if(4==p.readyState){A=!1;var f=a.asString(p.status);0===f.indexOf("2")?(z++,a.log(v,"Statistics was sent successfully (xhr)."+h)):a.log(v,"Statistics failed to be sent: "+f);C&&B()}}catch(k){a.error(v,"failed to handle server reply")}},i=p)}void 0!==b.XDomainRequest&&void 0===i&&(i=new b.XDomainRequest,i.open("POST",l),i.onprogress=function(){},i.onerror=function(){A=!1;a.log(v,"Statistics failed to be sent. (XDomainRequest error)")},i.onload=function(){z++;A=!1;a.log(v,"Statistics was sent successfully (xdr)."+h);C&&B()},i.ontimeout=function(){A=!1;a.log(v,"Statistics failed to be sent. Timeout")});i&&j?(i.send(j),A=!0):a.log(v,"Statistics failed to be sent. No valid request object could be created.")}catch(q){a.error(v,"failed to send data:"+q.message)}},n={start:function(){try{if(!s&&!J){var f="",g=F||"",i=1,k=a.getTimeStamp();if(K){var l=!1,m=a.getCookie("__eqtSession");if(m){var r=m.split(".");2==r.length?(f=r[0],k=parseInt(r[1])):(f=a.generateId(w),l=!0,a.setCookie("__eqtSession",f+"."+k,"/",0,""))}else{f=a.generateId(w),l=!0,a.setCookie("__eqtSession",f+"."+k,"/",0,"")}var x=a.getCookie("__eqtUser");if(x){var u=x.split(".");2!=u.length?(g=a.generateId(w),i=1):(g=u[0],i=parseInt(u[1])+(l?1:0))}else{g=a.generateId(w),i=1}a.setCookie("__eqtUser",F+"."+i,"/",31536000000,"")}D=f||a.generateId(w);F=g;startCount=i;c=k;E.startSession();z=0;E.clear();s=!0;a.log(v,"monitor has started, connecting to "+L);B()}}catch(t){a.log(v,"failed while calling start. "+t.description)}},stop:function(){try{s&&!J&&(K&&a.setCookie("__eqtSession",""),E.stopSession(),B(!0),s=!1,a.log(v,"monitor has stopped"))}catch(f){a.log(v,"failed while calling stop")}},setInstallationID:function(f){try{E.setInstallationID(f),B()}catch(g){a.log(v,"failed while calling setInstallationID")}},setUserID:function(f){try{F?a.logMessage(v,"UserID has already been assigned"):f&&(F=a.asString(f),B())}catch(g){a.log(v,"failed while calling setUserID")}},trackFeature:function(f){try{s?(E.addFeatureUsage(f),B()):a.log(v,"Monitor is not started")}catch(g){a.log(v,"failed while calling trackFeature")}},trackException:function(g,h){try{s&&(E.addException(g,h),B())}catch(i){a.log(v,"failed while calling trackException")}},trackFeatureValue:function(g,h){try{s&&(E.addFeatureValue(g,h),B())}catch(i){a.log(v,"failed while calling trackFeatureValue")}},trackFeatureStart:function(f){try{s&&E.startFeatureTiming(f)}catch(g){a.log(v,"failed while calling trackFeatureStart")}},trackFeatureStop:function(f){try{s&&(E.endFeatureTiming(f),B())}catch(g){a.log(v,"failed while calling trackFeatureStop")}},trackFeatureCancel:function(f){try{s&&E.cancelFeatureTiming(f)}catch(g){a.log(v,"failed while calling trackFeatureCancel")}},status:function(){return{payloads:z,isStarted:s,isDisabled:J}}};b._eqatecDebug&&(n.statisticsContainer=E);return n};d.createSettings=function(c){return{productId:c,serverUri:"",loggingInterface:void 0,version:"0.0.0.0",useCookies:!1,location:{latitude:"",longitude:""}}};d.createTraceLogger=function(){var c=function(f,g){console&&(console.log&&a.isFunction(console.log)&&g)&&console.log(f+g)};return{logMessage:function(f){c("",f)},logError:function(f){c("Error: ",f)}}};b._eqatecDebug&&(d.eqatecUtil=a)})(window);