define(function(an,J,Q){var at,ad,ay,aa,U,O=an("kendo"),y=an("modules/core/core-module"),q=an("modules/core/base-classes"),r=an("modules/core/base-commands"),C=an("modules/core/dialog-viewmodels"),B=an("modules/core/dialog-service"),ax=an("modules/workspace/solution-frame-service"),aA=an("modules/workspace/solution-settings-service"),ao=an("modules/core/rest-proxy"),ap=ao.init(window.location.host,serviceConfiguration.backendServiceScheme),P=an("modules/logging/logging-service"),aC=an("modules/tracking/tracking-service"),L=an("modules/core/helpers"),af=an("text!./project-navigator-template.html"),M=an("text!./item-name-dialog-template.html"),j=an("text!./add-new-file-dialog-template.html"),d=an("text!./add-existing-files-template.html"),g=an("text!./add-from-archive-template.html"),u=an("text!./build-settings-template.html");an("modules/workspace/sidebar-module");var w=window,b={},ag;b.MESSAGE_RENAME_TITLE="Renaming...";b.MESSAGE_RENAME_PROJECT_TASK="Renaming project...";b.MESSAGE_RENAME_REPO_TASK="Renaming repository...";b.MESSAGE_ICENIUM="Icenium";var Y=[{field:"isSpecialFolder",dir:"desc"},{field:"isFolder",dir:"desc"},{field:"_sortText",dir:"asc"}];var az=O.Observable.extend({PROJECT_NAVIGATOR_INIT_MSG:"Initializing Project Navigator...",PROJECT_PARSING_MSG:"Parsing project data...",UPGRADE_NEEDED_MSG:'<p>Icenium needs to upgrade your workspace. For more information, click <a href="http://docs.icenium.com/release-notes/v1-7#proj" target="_blank">here</a>. If you do not upgrade now, newly built apps might not run properly.</p> <br/> <p><strong>Note:</strong> After the upgrade is complete, commit changes to version control.</p><br/><p>Do you want to upgrade now?</p>',cachedFunc:{},init:function(){var aD=this;O.Observable.fn.init.apply(aD,arguments);aD.solutionTreeParser=new aB();aD._subscribeToEvents();aD.canAddNewItem=aD.memorize(aD.canAddNewItem);aD.canRenameItem=aD.memorize(aD.canRenameItem)},_subscribeToEvents:function(){var aD=this;at.bind(w.SOLUTION_DATA_REQUESTED,$.proxy(aD.loadSolutionData,aD));at.bind(w.SOLUTION_METADATA_ITEM_DELETE,$.proxy(aD.deleteProject,aD));at.bind(w.FILE_SYSTEM_REFERENCE_DELETE,$.proxy(aD.deleteFromFileSystem,aD));at.bind(w.FILE_SYSTEM_REFERENCE_RENAME,$.proxy(aD._onFileSystemReferenceRename,aD));at.bind(w.PROJECT_ITEM_PROPERTY_CHANGED,$.proxy(aD._onProjectItemPropertyChanged,aD));at.bind(w.CREATE_PROJECT_ITEM_BY_TEMPLATE,$.proxy(aD.createProjectItemByTemplate,aD));at.bind(w.CREATE_NEW_DIRECTORY,$.proxy(aD.createNewDirectory,aD));at.bind(w.FILE_SYSTEM_REFERENCE_COPY,$.proxy(aD.copyFile,aD))},loadExistingSolutions:function(){var aD=this;return ap.projectService.getExistingClientSolutionNames().done(function(aE){aD.solutionNames=aE})},solutionNameExists:function(aE){var aG=this;var aF=aG.solutionNames;for(var aD=0;aD<aF.length;aD++){if(aE.toLowerCase()===aF[aD].toLowerCase()){return true}}return false},solution:function(){return this._solution},loadSolutionData:function(aD){var aF=this,aE=false;if(aD.checkUpgradability===true){aE=true}P.logOutputMessage(["Mist version:",serviceConfiguration.assemblyVersion,"location:",location.hostname].join(" "));P.logOutputMessage(["Loading solution",iceConfiguration.solutionName,"..."].join(" "));y.progressService.beginSubtask({identifier:aF.PROJECT_NAVIGATOR_INIT_MSG,totalWorkCount:1});ap.projectService.getSolution({solutionName:iceConfiguration.solutionName,checkUpgradability:!!aE}).done(function(aG){if(aE&&aG.IsUpgradeable){aF.handleSolutionUpgrade.apply(aF,[aG])}else{aF._loadSolutionInternal.apply(aF,arguments)}y.progressService.updateTaskProgress({identifier:aF.PROJECT_NAVIGATOR_INIT_MSG,completedUnitsCount:1})}).fail(function(aH){var aG=true;if(aH.isHandled){y.dataLossProtectionService.unbind();y.navigationService.navigateToDashboard(aG)}else{B.showMessageBox(b.MESSAGE_ICENIUM,"Mist cannot load '"+iceConfiguration.solutionName+"' workspace!").always(function(){y.navigationService.navigateToDashboard(aG)})}y.progressService.updateTaskProgress({identifier:aF.PROJECT_NAVIGATOR_INIT_MSG,completedUnitsCount:1})})},_loadSolutionInternal:function(aE){var aH=this;ap.solutionUserSettingsService.getSettings({solutionName:iceConfiguration.solutionName}).done(function(aI){aA.codeSignSettings(aI.CodesigningSettings);aA.provisionSettings(aI.ProvisionSettings);aA.solutionSettings(aI.SolutionSettings);aA.areSettingsLoaded(true)});y.progressService.beginSubtask({identifier:aH.PROJECT_PARSING_MSG,totalWorkCount:1});var aF=aH.solutionTreeParser.parse(aE);y.progressService.updateTaskProgress({identifier:aH.PROJECT_PARSING_MSG,completedUnitsCount:1});if(!aF){return}aF.expanded=true;var aG=aF.childItems();if(aG){for(var aD=0;aD<aG.length;aD++){aG[aD].expanded=true}}aH._solution=aF;aH.handleCustomPlugins();aH.trigger(w.SOLUTION_OPENED,{solution:aF});ag.onSolutionOpened({solution:aF});P.logOutputMessage("Solution loading finished.");P.logOutputMessage(["Logged as:",iceConfiguration.loggedUser].join(" "));$("#loadingMask").css("display","none")},handleSolutionUpgrade:function(aD){var aE=this;B.showConfirmationDialog("Upgrade Needed",{message:aE.UPGRADE_NEEDED_MSG}).done(function(){y.progressService.showProgress("Upgrading...");ap.projectService.upgradeSolution({solutionName:iceConfiguration.solutionName}).done(function(){at.loadSolutionData(false)}).fail(function(){y.progressService.hideProgress()})}).fail(function(){aE._loadSolutionInternal.apply(aE,[aD])})},handleCustomPlugins:function(){var aG=this;var aF=aG._solution.getMobileProject()._getPluginsDir();var aD=aG._solution.getMobileProject().getChild("Plugins",w.PROJECT_ITEM_DIRECTORY);if(aD&&aD.items&&aD.items.length>0){while(aD.items.length>0){var aE=aD.items[0];aF.addItem(aE)}}if(aD!==null){aD.parentItem.removeItem(aD);aD=null}},deleteProject:function(aD){ap.projectService.deleteProject({solutionName:iceConfiguration.solutionName,projectName:aD.projectName})},isSolutionLoaded:function(){return(this._solution!==undefined)},isNotItemExtensionProj:function(aF){var aE=aF.lastIndexOf(".");if(aE!==-1){var aD=$.trim(aF.slice(aE).toLowerCase()),aG=(aD===".proj");return !aG}else{return true}},canAddNewItem:function(aD){var aG=aD[0],aF=aD[1];var aI=this;var aE=[];if(aG){var aH=aG.childItems();if(w.PLATFORM_TARGETED_FILE_REGEX.test(aF)){return aI.canAddDependencyItem(aH,aF)}aE=$(aH).filter(function(aJ){return aI._isItemNameSame(aH[aJ].text,aF)})}else{return true}return(aE.length===0)&&(aF)},canAddDependencyItem:function(aH,aG){var aJ=this,aI,aD=aG.replace(w.PLATFORM_EXTRACTION_REGEX,"");if(aH===null){return true}for(var aE=0;aE<aH.length;aE++){if(!aJ._isItemNameSame(aH[aE].text,aD)){continue}if(aH[aE].projectItemType()!==w.PROJECT_ITEM_PLATFORM_TARGET_GROUP){return false}aI=aH[aE].childItems();for(var aF=0;aF<aI.length;aF++){if(aJ._isItemNameSame(aI[aF].text,aG)){return false}}}return true},canRenameItem:function(aD){var aE=aD[0],aF=aD[1],aG=aE.parentItem,aH=aF;if(aE.properties&&aE.properties.DependentUpon){aG=aG.parentItem}else{if(w.PLATFORM_TARGETED_FILE_REGEX.test(aF)){aH=aF.replace(w.PLATFORM_EXTRACTION_REGEX,"")}}return(this.canAddNewItem(aG,aF)||this._isItemNameSame(aE.text,aH))},_isItemNameSame:function(aD,aE){return $.trim(aD).toLowerCase()===$.trim(aE).toLowerCase()},_onProjectItemPropertyChanged:function(aD){var aF={};aF[aD.propName]=aD.value;if(aD.dataItem instanceof X){ap.projectService.setProjectProperty({solutionName:iceConfiguration.solutionName,projectName:aD.dataItem.text,changeset:aF}).done(function(){var aG=aD.callback;if(aG){aG()}})}else{var aE=aD.callback;if(aE){aE()}}},_onFileSystemReferenceRename:function(aD){ap.fileSystemService.rename({path:aD.previousPath,newName:aD.newPath})},createProjectItemByTemplate:function(aD){ap.projectService.createNewProjectItem({solutionName:iceConfiguration.solutionName,projectName:aD.projectName,itemIdentifier:aD.itemIdentifier,expansionData:{TemplateIdentifier:aD.template.Identifier,Arguments:{}}})},deleteFromFileSystem:function(aD){ap.fileSystemService.remove({path:aD.filePath}).done(function(){P.logOutputMessage("Item Deleted: "+aD.fileName)})},copyFile:function(aD){ap.fileSystemService.copy({path:aD.oldPathData,destination:aD.newPathData})},createNewDirectory:function(aD){ap.fileSystemService.createDirectory({path:aD.filePath})},getProjectPath:function(){var aI=this,aG=aI.solution(),aD=aG.getMobileProject(),aE=aD.text,aH=aD.solution.text,aF=[aH,aE].join("/");return aF},memorize:function(aD){var aE=this;return function(){var aF=Array.prototype.slice.call(arguments),aH="",aG=aF.length;while(aG--){currentArg=aF[aG];aH+=(currentArg===Object(currentArg))?currentArg.uid:currentArg}if(aE.cachedFunc[aH]===undefined){aE.cachedFunc[aH]=$.proxy(aD,aE,arguments)()}return aE.cachedFunc[aH]}},onReloadSolutionWithoutFiles:function(){this.trigger(w.SOLUTION_RELOADED_WITHOUT_FILES,{})}});var ae=O.Observable.extend({init:function(){var aD=this;O.Observable.fn.init.apply(aD,arguments);aD._subscribeToEvents();aD.selectedDomElements([])},selectedDomElements:function(aD){return w.Property.call.apply(this,["selectedDomElements",aD])},getSelectedItems:function(){var aI=this,aH,aE,aF=[],aG=aI.selectedDomElements().slice();for(var aD=0;aD<aG.length;aD++){aH=aG[aD];aE=$(aH).data("dataItem");if(aE){aF.push(aE)}}return aF},raiseSelectionChanged:function(){this.trigger(w.PROJECT_NAVIGATOR_SELECTION_CHANGED)},isProjectSelected:function(){var aE=ad.selectedDomElements();if(aE===undefined||aE.length===0||aE.length>1){return false}var aD=$(aE[0]).data("dataItem");if(aD!==undefined){return aD instanceof X}return false},_subscribeToEvents:function(){var aD=this;at.bind(w.DATA_ITEM_REMOVED,aD.onDataItemRemoved);at.bind(w.DATA_ITEM_RENAMED,aD.onDataItemRenamed);at.bind(w.PROJECT_ITEM_IDENTIFIER_UPDATED,aD.onProjectItemIdentifierUpdated);at.bind(w.PROJECT_ITEM_PROPERTY_CHANGED,aD.onProjectItemPropertyChanged);at.bind(w.DATA_ITEM_ADDED,aD.onDataItemAdded);at.bind(w.DATA_ITEM_ADDED_TO_PROJECT,aD.onDataItemAddedToProject);at.bind(w.DATA_ITEM_VERSION_CONTROL_STATUS_CHANGE,aD.onVersionControlStatusChange)},onDataItemRemoved:function(aD){var aE=aD.item;var aF=aE.parentItem;if(aF){aF.removeItem(aE)}},onDataItemRenamed:function(aD){var aE=aD.dataItem;aE.itemText(aD.newText);var aF=aE.parentItem;if(aF){aF.sort();L.assignTreeViewDataItems(aF.element(),aF.childItems())}},onProjectItemIdentifierUpdated:function(aD){var aF=aD.dataItem,aE=aF.documentType();aF.identifier(aF.generateIdentifier());if(aE!==w.DOCUMENT_TYPE_DIRECTORY&&aE!==w.DOCUMENT_TYPE_REFERENCE){aF.documentType(aa.getDocumentType(aF.identifier()))}},onProjectItemPropertyChanged:function(aD){aD.dataItem.properties[aD.propName]=aD.value},onDataItemAdded:function(aD){var aE=aD.parent;aE.addItem(aD.child);aE.sort();L.assignTreeViewDataItems(aE.element(),aE.childItems())},onDataItemAddedToProject:function(aD){var aE=aD.project;aE.addItemToProject(aD.item);aE.sort();L.assignTreeViewDataItems(aE.element(),aE.childItems())},onVersionControlStatusChange:function(aD){aD.dataItem.versionControlStatus(aD.newStatus)}});var V=O.Observable.extend({init:function(){var aD=this;O.Observable.fn.init.apply(aD,arguments);aD.copiedItems=[];aD.areItemsCut=false},copyProjectItems:function(aD){var aE=this;aE.copiedItems=aD;aE.areItemsCut=false},cutProjectItems:function(aD){var aE=this;aE.copiedItems=aD;aE.areItemsCut=true},getCopiedItems:function(){return this.copiedItems},getAreItemsCut:function(){return this.areItemsCut}});var au=O.Observable.extend({CANT_REPLACE_FOLDER_MESSAGE:"<p>Icenium cannot store a file and a folder with identical names in the same location.</p> <p>Choose another location or rename one of the conflicting items and try again.</p>",DELETE_ITEMS_FAILED_MESSAGE:"Unable to complete the file removal. One or more of the selected files might not have been removed successfully. Refresh your browser to retrieve the latest state of your project.",init:function(){var aD=this;O.Observable.fn.init.apply(aD,arguments)},loadSolutionData:function(aD){var aE=this;aE.trigger(w.SOLUTION_DATA_REQUESTED,{checkUpgradability:aD})},unloadSolution:function(){var aD=this;aD.trigger(w.UNLOAD_SOLUTION);a.remove()},reloadSolution:function(){var aD=this;aD.unloadSolution();aD.loadSolutionData();aD.trigger(w.SOLUTION_RELOADED,{})},reloadSolutionWithoutFiles:function(){var aD=this;aD.unloadSolution();aD.loadSolutionData();ay.onReloadSolutionWithoutFiles()},reloadItemByPath:function(aD){var aE=this;aE.trigger(w.FILE_RELOAD_REQUESTED,{filePath:aD})},deleteItems:function(aE){var aF=this;for(var aD=0;aD<aE.length;aD++){aF.deleteItem($(aE[aD]).data("dataItem"))}},deleteItem:function(aD){var aF=this,aE=aF.getItemsFlatList(aD);if(aD instanceof X){aF.deleteProject(aD.element(),aD)}else{aF.deleteListedItems(aE)}},getItemsFlatList:function(aE){var aH=this,aG=[aE];for(var aF=0;aF<aG.length;aF++){var aD=aG[aF].childItems();if(aD!=null){aG=aG.concat(aD)}}return aG},deleteListedItems:function(aD){var aE=this;y.progressService.showProgress("Deleting..");aE.deleteListedItemsFromFS(aD).fail(function(aF){y.progressService.hideProgress();B.showMessageBox("Icenium",aE.DELETE_ITEMS_FAILED_MESSAGE)}).always(function(){for(var aG=0;aG<aD.length;aG++){var aF=aD[aG];aE.handleDeletedItem(aF.element(),aF)}y.progressService.hideProgress()})},deleteListedItemsFromFS:function(aG){var aH=this,aD=ap.batchingManager.CreateBatch(),aE;aD.Begin();for(var aF=0;aF<aG.length;aF++){aE=aG[aF];aH.deleteItemFromFS(aE)}return aD.SendSequential()},deleteProjectItem:function(aE,aD){var aF=this;aF.deleteItemFromFS(aD);aF.handleDeletedItem(aE,aD)},deleteItemFromFS:function(aD){var aE=this;switch(aD.type()){case w.MSBUILD_PROJECT_REFERENCE:case w.MSBUILD_REFERENCE:P.logOutputMessage("Reference Removed: "+aD.text);break;default:aE.trigger(w.FILE_SYSTEM_REFERENCE_DELETE,{filePath:aD.getPath(),fileIcon:aD.iconType(),fileName:aD.text});P.logOutputMessage("Item Deleting: "+aD.text)}},handleDeletedItem:function(aE,aD){var aG=this,aF=aD.parentItem;aG.triggerVersionControl(w.VERSION_CONTROL_DELETE,{dataItem:aD});aG.refreshProjectVersionControlStatus(aD.project);aG.trigger(w.DATA_ITEM_REMOVED,{item:aD});aG.trigger(w.VISUAL_ITEM_REMOVED,{domElement:aE,item:aD});ag.onVisualItemRemoved({domElement:aE,item:aD});aG._tryCreateEmptyFolder(aF)},deleteProject:function(aE,aD){var aF=this;aF.trigger(w.SOLUTION_METADATA_ITEM_DELETE,{projectName:aD.text});aF.trigger(w.FILE_SYSTEM_REFERENCE_DELETE,{filePath:aD.getPath()});aF.trigger(w.DATA_ITEM_REMOVED,{item:aD});aF.trigger(w.VISUAL_ITEM_REMOVED,{domElement:aE,item:aD});ag.onVisualItemRemoved({domElement:aE,item:aD})},openProjectItemByFilePath:function(aE){var aG=this,aF=ay.solution(),aD=aF.getItemByFilePath(aE);aG.openProjectItem(aD)},openProjectItem:function(aD){this.trigger(w.FILE_OPEN_REQUESTED,{fileName:aD.itemText(),filePath:aD.getPath(),iconType:aD.iconType(),dataItem:aD,readOnly:aD.getIsReadonly(),virtual:aD.getIsVirtual()})},triggerOpenFile:function(aD){this.trigger(w.FILE_OPEN_REQUESTED,{fileName:aD.filename,filePath:aD.filePath,fileContent:aD.fileContent,iconType:aD.dataItem.iconType(),dataItem:aD.dataItem,readOnly:aD.readOnly,virtual:aD.virtual})},renameItem:function(aD,aE,aG){var aF=this;originalPath=aD.getPath();aE=$.trim(aE);if(aD.isSolution){aF.renameSolution(aD,aE,aG);return}else{if(aD.isProject){aF.renameProject(aD,aE,aG);return}else{if(!aG){aF.trigger(w.FILE_SYSTEM_REFERENCE_RENAME,{previousPath:aD.getPath(),newPath:aD.getPathFromText(aE)});P.logOutputMessage("Item Renamed: '"+aD.itemText()+"' => '"+aE+"'")}}}if(aD.hasDependencies()){aF._renameItemDependencies(aD,aE)}aF.trigger(w.DATA_ITEM_RENAMED,{dataItem:aD,newText:aE});aF._tryUpdateProjectItemIdentifier(aD);aF.trigger(w.PROJECT_ITEM_RENAMED,{dataItem:aD,newKey:aD.getPath(),oldKey:originalPath});aF.trigger(w.VISUAL_ITEM_RENAMED,{dataItem:aD,newText:aE});ag.onVisualItemRenamed({dataItem:aD,newText:aE});aF._tryUpdateChildrenIdentifiers(aD);aF.handleRenameDependentFiles(aD,aE)},handleRenameDependentFiles:function(aD,aE){var aF=this;if(aD.properties&&aD.properties.DependentUpon&&w.PLATFORM_TARGETED_FILE_REGEX.test(aE)){if(aD.properties.DependentUpon===aE.replace(w.PLATFORM_EXTRACTION_REGEX,"")){return}aF.moveItem(aD.parentItem.parentItem,aD)}else{if(w.PLATFORM_TARGETED_FILE_REGEX.test(aE)){aF.moveItem(aD.parentItem,aD)}else{if(aD.properties&&aD.properties.DependentUpon&&!w.PLATFORM_TARGETED_FILE_REGEX.test(aE)){if(aD.parentItem.text===aD.properties.DependentUpon){aD.properties.DependentUpon=""}aF.moveItem(aD.parentItem.parentItem,aD)}}}},renameSolution:function(aD,aE,aG){var aF=this;aF.trigger(w.SOLUTION_RENAMED,{dataItem:aD,newText:aE})},renameSolutionOnServer:function(aD,aE){return ap.projectService.renameSolution({solutionName:aD.text,newSolutionName:aE})},renameProject:function(aD,aE,aH){var aG=this,aF=aD.getProjectIdentifier();if(!aH){y.progressService.showProgress(b.MESSAGE_RENAME_TITLE);y.progressService.beginSubtask({identifier:b.MESSAGE_RENAME_PROJECT_TASK,totalWorkCount:1});y.progressService.beginSubtask({identifier:b.MESSAGE_RENAME_REPO_TASK,totalWorkCount:1});ap.projectService.renameProject({solutionName:iceConfiguration.solutionName,projectName:aD.text,newProjectName:aE}).done(function(){y.progressService.updateTaskProgress({identifier:b.MESSAGE_RENAME_PROJECT_TASK,completedUnitsCount:1});aG.moveProject(aD,aE).done(function(){aG.notifyProjectRenamedAndReload(aD,aE,aF);aG.updateSolutionUserSettings(aF,aD.getProjectIdentifier());y.progressService.updateTaskProgress({identifier:b.MESSAGE_RENAME_REPO_TASK,completedUnitsCount:1})}).fail(function(aI){y.progressService.hideProgress();if(!aI.isHandled){B.showMessageBox(b.MESSAGE_ICENIUM,aI.statusText)}})}).fail(function(aI){y.progressService.hideProgress();if(!aI.isHandled){B.showMessageBox(b.MESSAGE_ICENIUM,aI.statusText)}})}else{aG.notifyProjectRenamedAndReload(aD,aE,aF);aG.updateSolutionUserSettings(aF,aD.getProjectIdentifier())}},updateSolutionUserSettings:function(aE,aD){return ap.solutionUserSettingsService.updateSettingsProjectIdentifier({solutionName:iceConfiguration.solutionName,projectIdentity:aE,newProjectIdentity:aD})},moveProject:function(aD,aE){return ap.versionControlService.move({workspaceName:iceConfiguration.solutionName,oldPaths:[aD.text],newPaths:[aE]})},notifyProjectRenamedAndReload:function(aD,aE,aF){var aG=this;aG.trigger(w.DATA_ITEM_RENAMED,{dataItem:aD,newText:aE});aG.trigger(w.PROJECT_RENAMED,{oldIdentifier:aF,newIdentifier:aD.getProjectIdentifier()});aG.reloadSolutionWithoutFiles()},setItemProperty:function(aF,aE,aG,aD){this.trigger(w.PROJECT_ITEM_PROPERTY_CHANGED,{dataItem:aE,propName:aF,value:aG,callback:aD})},expandItems:function(aD){for(var aE=0;aE<aD.length;aE++){this.expandItem(aD[aE])}},expandItem:function(aD){this.trigger(w.VISUAL_ITEM_EXPAND,{dataItem:aD});ag.onVisualItemExpand({dataItem:aD})},addNewItemByTemplate:function(aI,aD,aG,aF){var aL=this,aJ=aI.identifier(),aK;if(aI instanceof X){aK=aI}else{aK=aI.project}var aE=(aJ)?[aJ,aG].join("\\"):aG;aL.trigger(w.CREATE_PROJECT_ITEM_BY_TEMPLATE,{projectName:aK.text,itemIdentifier:aE,template:aD,fileName:aG});var aH=aL.addNewItem(aI,aG,aF);aL.openProjectItem(aH);aL.trigger(w.REGION_FOCUSED,{name:w.VIEWPANE_REGION});ag.triggerRegionFocusChange({name:w.VIEWPANE_REGION});return aH},createNewItem:function(aE){var aD=aa.getDocumentType(aE),aF=aa.getType(aD);return this._createNewItem(aE,aF,aD,w.PROJECT_ITEM_FILE)},addNewItem:function(aG,aF,aD){var aH=this;var aE=aH.createNewItem(aF);aH._addItemToProject(aG,aE,aD);aH.expandItem(aG);if(aG!==aE.parentItem){aH.expandItem(aE.parentItem)}if(!aD){aH.selectItem(aE)}return aE},addNewFolder:function(aF,aE,aG){var aH=this;var aD=aH._createNewItem(aE,w.MSBUILD_FOLDER,w.DOCUMENT_TYPE_DIRECTORY,w.PROJECT_ITEM_DIRECTORY);aH._addItemToProject(aF,aD,false,null,function(){aH.refreshProjectVersionControlStatus(aD.project)});aH.trigger(w.CREATE_NEW_DIRECTORY,{filePath:aD.getPath()});aH.expandItem(aF);if(aG){aH.selectItem(aD)}return aD},handleAddDependentFile:function(aG,aF){var aH=this,aE=aF.itemText().replace(w.PLATFORM_EXTRACTION_REGEX,""),aD=aG.getChild(aE,w.PROJECT_ITEM_PLATFORM_TARGET_GROUP);if(aF.type()===w.MSBUILD_FOLDER){return}if(aD===null){aD=aH._createNewItem(aE,w.MSBUILD_FOLDER,w.DOCUMENT_TYPE_DIRECTORY,w.PROJECT_ITEM_PLATFORM_TARGET_GROUP);aD.setIsDraggable(false);aD.setIsDropTarget(false);aD.identifier(aE);aD.itemText(aE);aD.hasDependencies(true);aD.setIsRenamable(false);aE.project=aG.project;aH._addItemToProject(aG,aD,false)}aF.properties={};aF.properties.DependentUpon=aD.itemText();return aD},ensureFolderByPath:function(aD){var aK=this,aG=ay.solution().getMobileProject(),aI=aD.split("\\");aI.splice(0,1);var aJ=aI.shift();masterLoop:while(aJ){if(aG.childItems()){for(var aE=0,aF=aG.childItems().length-1;aE<=aF;aE++){var aH=aG.childItems(aE);if(aH.text===aJ&&((aI.length===0)||aH.isProject||aH.projectItemType()===w.PROJECT_ITEM_DIRECTORY)){aG=aH;aJ=aI.shift();continue masterLoop}}}aG=aK.addNewFolder(aG,aJ);aJ=aI.shift()}return aG},moveProjectItemsInternally:function(aD,aH){var aJ=this,aG=aJ._getItemsToReplace(aD,aH),aF=aJ._getFileFolderConflict(aG),aE=aJ._getFilesListForReplaceMessage(aG),aI="The destination already contains these items:";if(aF.length>0){return B.showFileListConfirmationDialog("Cannot replace existing items",{message:aJ.CANT_REPLACE_FOLDER_MESSAGE,fileList:aJ._getFilesListForReplaceMessage(aF),cancelVisible:false,rejectVisible:false,acceptText:"OK"})}else{if(aG.length>0){return B.showFileListConfirmationDialog("Replace existing items?",{message:aI,fileList:aE,accept:function(){P.logOutputMessage(aI+"Yes.");aJ._replaceItems(aD,aH,true)},reject:function(){P.logOutputMessage(aI+"Skip.");aJ._replaceItems(aD,aH,false)},cancelVisible:true,rejectText:w.SKIP_TEXT})}else{aJ._replaceItems(aD,aH,false)}}},_getFileFolderConflict:function(aF){var aG=this,aD=[];for(var aE=0;aE<aF.length;aE++){if((aF[aE].destination.type()===w.MSBUILD_FOLDER&&aF[aE].item.type()===w.MSBUILD_CONTENT)||aF[aE].destination.type()===w.MSBUILD_CONTENT&&aF[aE].item.type()===w.MSBUILD_FOLDER){aD.push(aF[aE])}}return aD},pasteProjectItemsInternally:function(aG,aE,aD){var aH=this;if(aE){var aF=$(aD.slice()).filter(function(aI){return aD[aI].parentItem===aG});if(aF.length===0){aH.moveProjectItemsInternally(aG,aD)}else{B.showMessageBox("Pasted in the same location.","Pasting in the same location isn't allowed.")}}else{aH.copyProjectItemsInternally(aG,aD)}},copyProjectItemsInternally:function(aD,aI){var aK=this;var aG=(aD.childItems())?aD.childItems().length:0;for(var aF=0;aF<aI.length;aF++){var aH=aI[aF];if(aH.parentItem===null){continue}if(aH.projectItemType()===w.PROJECT_ITEM_PLATFORM_TARGET_GROUP){aK.copyProjectItemsInternally(aD,aH.childItems())}else{if(aH.type()===w.MSBUILD_FOLDER){aK._copyDirectory(aD,aH)}else{var aJ=aK._getCopiedItemText(aD,aH);var aE=aK._copyFile(aD,aH,aJ);if(aH.hasDependencies()){aK._copyDependencies(aD,aH,aE,aJ)}}}}aK.expandItem(aD)},selectItem:function(aD){this.trigger(w.VISUAL_ITEM_SELECTED,{node:aD.element()});ag.onVisualItemSelected({node:aD.element()})},toggleItemChangeType:function(aE,aF){if(aE.projectItemType()===w.PROJECT_ITEM_PLATFORM_TARGET_GROUP){return}this.trigger(w.DATA_ITEM_VERSION_CONTROL_STATUS_CHANGE,{dataItem:aE,newStatus:aF});var aD=aE.versionControlCssClassPrefix;this.trigger(w.VISUAL_ITEM_TOGGLE_CLASS,{node:aE.element(),removeClassNamespace:aD,addClass:aD+aF});ag.onVisualItemToggleClass({node:aE.element(),removeClassNamespace:aD,addClass:aD+aF})},clearItemChangeType:function(aE){this.trigger(w.DATA_ITEM_VERSION_CONTROL_STATUS_CHANGE,{dataItem:aE,newStatus:null});var aD=aE.versionControlCssClassPrefix;this.trigger(w.VISUAL_ITEM_TOGGLE_CLASS,{node:aE.element(),removeClassNamespace:aD});ag.onVisualItemToggleClass({node:aE.element(),removeClassNamespace:aD})},applyInitialVersionControlStatuses:function(aE,aL){var aM=this;var aN=function(aQ){var aR=aQ.slice();for(var aO=0;aO<aQ.length;aO++){var aP=aQ[aO].childItems();if(aP){aR=aR.concat(aN(aP,aR))}}return aR};if(aL){var aH=aN([aL]);var aF=[];for(var aI=0;aI<aH.length;aI++){var aJ=aH[aI];if((aJ._identifier||aJ.isProject)&&aJ.projectItemType()!==w.PROJECT_ITEM_PLATFORM_TARGET_GROUP){var aK=aJ.getFullPath(),aD=aE[aK];if(aD){aM.toggleItemChangeType(aJ,aD);if(aD===w.VERSION_CONTROL_CHANGE_TYPE.Conflict){var aG={};aG.name=aJ.getFullPath();aG.changeType=w.VERSION_CONTROL_CHANGE_TYPE.Conflict;aG.isSelected=true;aG.iconType=aJ.iconType();aF.push(aG)}}else{aM.clearItemChangeType(aJ)}}}aM.triggerVersionControl(w.VERSION_CONTROL_CONFLICT,{conflictingFiles:aF})}},markFileAsModified:function(aE){var aH=this,aG=ay.solution(),aD=aG.getItemByFilePath(aE),aF=aG.getMobileProject();if(!aD){resourcePath=aE.split("\\").splice(2).join("\\");aD=aF._getResourceItem(resourcePath)}aH.trigger(w.VERSION_CONTROL_MODIFY,{dataItem:aD})},triggerVersionControl:function(aE,aD){var aF=this;aF.trigger(aE,aD)},onVersionControlLoaded:function(){var aD=this.ctx;aD.trigger(this.eventName,this.eventArgs)},refreshProjectVersionControlStatus:function(aD){this.trigger(w.VERSION_CONTROL_PROJECT_FILE_STATUS_REFRESH,{dataItem:aD})},changeCordovaVersion:function(){this.trigger(w.PROPERTIES_PLUGINS_REINIT)},setAndroidPermissions:function(aG,aE,aD,aH){var aI=this;var aF=aI._generatePermissionsString(aE);aI.setItemProperty("AndroidPermissions",aG,aF,function(){if(aD){aD(aF)}if(aH){aI.trigger(w.ANDROID_PERMISSIONS_CHANGED)}})},_generatePermissionsString:function(aG){var aD=$.map(w.AndroidPermissions,function(aI){return aI.id});var aH=[];for(var aE=0;aE<aG.length;aE++){var aF=aG[aE].id;aH[aD.indexOf(aF)]=aF}return L.removeArrayPaddings(aH).join(";")},_getItemsToReplace:function(aD,aF){var aH=this,aG=$.map(aF,function(aJ,aI){var aK;if(aJ.parentItem===aD||aJ===aD){return null}if(aJ.properties&&aJ.properties.DependentUpon){aK=aH.getReplaceItemForDependency(aD,aJ)}else{aK=aD.getItemByText(aJ.text)}if(aK!==null){return{destination:aK,item:aJ}}else{return null}});var aE=0;while(aE<aG.length){if(aG[aE].item.childItems()){aG=aG.concat($.map(aG[aE].item.childItems(),function(aJ,aI){var aK=aG[aE].destination.getItemByText(aJ.text);return(aK)?{destination:aK,item:aJ}:null}))}aE++}return aG},getReplaceItemForDependency:function(aD,aE){var aF=aD.getItemByText(aE.properties.DependentUpon);if(aF!==null&&aF.hasDependencies()){aF=aF.getItemByText(aE.text)}return aF},_getFilesListForReplaceMessage:function(aE){if(!aE){return""}var aF=[];for(var aD=0;aD<aE.length;aD++){aF.push({FilePath:aE[aD].destination._identifier,IconType:aE[aD].destination.iconType()})}return aF},_replaceItems:function(aD,aG,aI){var aJ=this;for(var aE=0;aE<aG.length;aE++){var aF=aG[aE],aH;if(aF.properties&&aF.properties.DependentUpon){aH=aJ.getReplaceItemForDependency(aD,aF)}else{aH=aD.getItemByText(aF.text)}if(aF.parentItem===null||aF.parentItem===aD||aF===aD){continue}if(!aH){aJ.moveItem(aD,aF)}else{if((aH.type()===w.MSBUILD_FOLDER)&&aF.type()===w.MSBUILD_FOLDER){if(aH.projectItemType()===w.PROJECT_ITEM_PLATFORM_TARGET_GROUP&&aF.childItems()){aJ._replaceItems(aD,aF.childItems().slice(),aI)}else{if(aF.childItems()){aJ._replaceItems(aH,aF.childItems().slice(),aI)}}aJ.deleteProjectItem(aF.element(),aF)}else{if(aI){aJ.deleteProjectItem(aH.element(),aH);aJ.moveItem(aD,aF)}}}}},moveItem:function(aD,aE,aI){var aH=this;var aG=aE.getPath();var aF=aE.parentItem;if(w.PLATFORM_TARGETED_FILE_REGEX.test(aE.itemText())){aH.handleAddDependentFile(aD,aE)}aH.trigger(w.DATA_ITEM_ADDED,{parent:aD,child:aE});aH.trigger(w.VISUAL_ITEM_REMOVED,{domElement:aE.element(),item:aE});ag.onVisualItemRemoved({domElement:aE.element(),item:aE});if(!aI){aH.trigger(w.FILE_SYSTEM_REFERENCE_RENAME,{previousPath:aG,newPath:aE.getPathFromText(aE.text)});P.logOutputMessage(["Item moved: ",aE.identifier()," -> ",aD.identifier()].join(""))}aH._tryUpdateProjectItemIdentifier(aE);aH._tryUpdateChildrenIdentifiers(aE);aH._tryMoveDependencies(aD,aE);aH._tryCreateEmptyFolder(aF);aH.expandItem(aD);if(aD!==aE.parentItem){aH.expandItem(aE.parentItem)}aH.selectItem(aE)},_copyDependencies:function(aH,aK,aE,aL){var aM=this;var aG=aK.childItems();if(aG&&aG.length>0){var aF=aE.identifier();for(var aI=0;aI<aG.length;aI++){var aJ=aG[aI];var aD=aJ.clone();aD.itemText(aL+aJ.text);aD.properties={DependentUpon:aF};aM._addItemToProject(aH,aD,false);aM.trigger(w.FILE_SYSTEM_REFERENCE_COPY,{oldPathData:aJ.getPath(),newPathData:aD.getPath()})}}},_copyDirectory:function(aE,aF){var aI=this;var aH=aI._getCopiedItemText(aE,aF)+aF.text;if(aI._tryValidateCopyText(aH,aF.text)){var aD=aI.addNewFolder(aE,aH);var aG=aF.childItems();if(aG&&aG.length>0){aI.copyProjectItemsInternally(aD,aG)}return aD}},_copyFile:function(aE,aF,aG){var aI=this;var aH=aG+aF.text;if(aI._tryValidateCopyText(aH,aF.text)){var aD=aF.clone();aD.itemText(aH);aI._addItemToProject(aE,aD,false,function(){aI.trigger(w.FILE_SYSTEM_REFERENCE_COPY,{oldPathData:aF.getPath(),newPathData:aD.getPath()})});return aD}},_tryValidateCopyText:function(aE,aD){if(aE.length>30){P.logOutputMessage("'"+aD+"' couldn't be coppied. The new name exceeds the allowed 30 characters.");return false}return true},_createNewItem:function(aF,aH,aD,aG){var aE=new Z();aE.itemText($.trim(aF));aE.type(aH);aE.documentType(aD);aE.projectItemType(aG);return aE},_tryMoveDependencies:function(aD,aH){var aJ=this;if(aH.hasDependencies()){var aG=aH.childItems();for(var aE=0;aE<aG.length;aE++){var aF=aG[aE];var aI=aF.getPath();aJ._tryUpdateProjectItemIdentifier(aF);aJ.trigger(w.FILE_SYSTEM_REFERENCE_RENAME,{previousPath:aI,newPath:aF.getPath()});aJ.setItemProperty("DependentUpon",aG[aE],aH.identifier())}}},_tryCreateEmptyFolder:function(aD){var aF=this;if(aD&&(aD.childItems().length===0)&&(aD.projectItemType()===w.PROJECT_ITEM_DIRECTORY)){var aE={dataItem:aD,projectInfo:aD.project.getProjectItemInfo(),projectItemInfo:aD.getProjectItemInfo(),itemPath:aD.getPath(),isFile:false};aF.triggerVersionControl(w.VERSION_CONTROL_ADD,aE)}},_tryUpdateChildrenIdentifiers:function(aD){if(aD.projectItemType()===w.PROJECT_ITEM_DIRECTORY){var aF=aD.childItems();if(aF){var aG=[].concat(aF);while(aG.length>0){var aE=aG.shift();aF=aE.childItems();if(aF){aG=aG.concat(aF)}this._tryUpdateProjectItemIdentifier(aE)}}}},_tryUpdateProjectItemIdentifier:function(aD){var aF=this;if(aD.identifier()){var aE={dataItem:aD,projectItemInfo:aD.getProjectItemInfo(),oldIdentifier:aD.identifier(),newIdentifier:aD.generateIdentifier()};aF.trigger(w.PROJECT_ITEM_IDENTIFIER_UPDATE,aE);aF.trigger(w.PROJECT_ITEM_IDENTIFIER_UPDATED,aE);aF.triggerVersionControl(w.VERSION_CONTROL_RENAME,aE)}},_associateItemWithParent:function(aG,aE){var aF=aG.identifier();var aD=(aF)?[aF,aE.text].join("\\"):aE.text;aE.identifier(aD)},_addItemToProject:function(aI,aF,aE,aG,aH){var aM=this;var aL=(aI.childItems())?aI.childItems().length:0;if(w.PLATFORM_TARGETED_FILE_REGEX.test(aF.itemText())){aM.handleAddDependentFile(aI,aF)}if(aF.projectItemType()!==w.PROJECT_ITEM_PLATFORM_TARGET_GROUP){aM._associateItemWithParent(aI,aF)}aM.trigger(w.DATA_ITEM_ADDED,{parent:aI,child:aF});if(aG){aG()}var aJ;if(aI instanceof X){aJ=aI}else{aJ=aI.project}var aK=aF.getProjectItemInfo();if(aE){aK.Type="Resource"}var aD={dataItem:aF,projectInfo:aJ.getProjectItemInfo(),projectItemInfo:aK,itemPath:aF.getFullPath(),isFile:(aF.projectItemType()===w.PROJECT_ITEM_FILE),callback:aH};aM.triggerVersionControl(w.VERSION_CONTROL_ADD,aD);P.logOutputMessage("Item added to solution: "+aF.identifier())},_renameItemDependencies:function(aD,aE){var aF=this;if(aF._followsNEConvention(aD)){aF._renameDependenciesUsingNEConvention(aD,aE)}else{aF._renameDependenciesUsingNConvention(aD,aE)}},_renameDependenciesUsingNConvention:function(aD,aL){var aM=this,aI=aD.childItems();for(var aF=0;aF<aI.length;aF++){var aG=aI[aF];var aJ=aG.text;if(!aM._isExtensionChanged(aD.text,aL)){var aK=aM._getFileNameParts(aL);var aE=aJ.lastIndexOf(aK.postfix);if(aE!==-1){var aH=aJ.substr(aE,aJ.length-aE+1);aM.setItemProperty("DependentUpon",aG,aD.generateIdentifier(aL));aM.renameItem(aG,[aK.prefix,aH].join("."))}}}},_isExtensionChanged:function(aG,aE){var aH=this,aF=aH._getFileNameParts(aG),aD=aH._getFileNameParts(aE);return aF.postfix!==aD.postfix},_renameDependenciesUsingNEConvention:function(aF,aN){var aP=this,aI=aF.childItems(),aJ=aP._getFileNameParts(aF.text),aM=aP._getFileNameParts(aN);for(var aG=0;aG<aI.length;aG++){var aH=aI[aG],aE=aJ.prefix.length,aD=(aJ.postfix.length>0)?aH.text.lastIndexOf(aJ.postfix)-1:aH.text.length,aO;if(aJ.prefix!==""){aE++}aO=aH.text.substr(aE,aD-aE);var aL=[aM.prefix,aO,aM.postfix],aK=$(aL).filter(function(aQ){return aL[aQ].length>0}).toArray().join(".");aP.setItemProperty("DependentUpon",aH,aF.generateIdentifier(aN));aP.renameItem(aH,aK)}},_followsNEConvention:function(aD){var aI=this,aH=aI._getFileNameParts(aD.text),aG=aD.childItems();for(var aE=0;aE<aG.length;aE++){var aF=aI._getFileNameParts(aG[aE].text);if((aF.prefix.indexOf(aH.prefix)!==0)||((aH.postfix!=="")&&(aH.postfix!==aF.postfix))){return false}}return true},_getFileNameParts:function(aE){var aD=aE.split(".");if(aD.length>1){return{postfix:aD.splice(aD.length-1,1)[0],prefix:aD.join(".")}}else{return{prefix:aD[0],postfix:""}}},_getCopiedItemText:function(aE,aG){var aI="",aH=aG.text,aF;if(aG.properties&&aG.properties.DependentUpon){aF=aE.getItemByText(aG.properties.DependentUpon);if(aF&&aF.hasDependencies()){if(aF.getItemByText(aH)===null){return aI}}aH=aG.properties.DependentUpon}if(aE.getItemByText(aH)){aI="Copy of ";if(aE.getItemByText(aI+aH)){var aD=2;while(true){aI=["Copy (",aD++,") of "].join("");aI=aI+"";if(!aE.getItemByText(aI+aH)){break}}}}return aI}});var ah=q.ViewModelBase.extend({init:function(){var aD=this;aD._treeView=null;aD._pluginInfo=null;q.ViewModelBase.fn.init.apply(aD,arguments);y.keyBindingService.bind(w.REGION_FOCUS_CHANGE,$.proxy(aD.onRegionFocusChange,aD));aD.bind("bind",$.proxy(aD.onBind,aD))},onBind:function(aD){var aE=this;aE.placeHolder=aD.view},onVisualItemToggleClass:function(aD){var aE=this;if(aD.node){aE._toggleItemClass($(">div>span>span.ico-version-control",aD.node),aD.removeClassNamespace,aD.addClass)}},_toggleItemClass:function(aF,aG,aE){var aH=this,aD=$(aF);aH._removeClassByNamespace(aD,aG);if(aE!==undefined){aD.addClass(aE)}},_removeClassByNamespace:function(aD,aE){var aF=new RegExp("\\b"+aE+"\\S+","g");aD.removeClass(function(aH,aG){return(aG.match(aF)||[]).join(" ")})},onSolutionOpened:function(aD){var aJ=this,aI=aD.solution;aJ.projectTreeNode=a=$("<div></div>");var aF=$("<span id='theMessage' class='loadingMessage'>Loading Solution...</span>");aF.hide().appendTo(aJ.placeHolder).fadeIn();var aH=[aI];var aE=new O.data.HierarchicalDataSource({data:aH});aJ.projectTreeNode.appendTo($(aJ.placeHolder).find("#projectTreePane"));aJ._treeView=$(aJ.projectTreeNode).hide().kendoTreeView({animation:false,dataSource:aE,loadOnDemand:false,select:$.proxy(aJ.onTreeItemSelected,aJ),dragAndDrop:true,dragstart:$.proxy(aJ.onDragStart,aJ),drop:$.proxy(aJ.onDrop,aJ),template:O.template("# var iconType = item.iconType(); ## var versionControlClass = item.getVersionControlClass(); #<span class='ico-version-control #= versionControlClass #'></span><span class='k-icon ico-#= iconType #'></span><span class='tnode'>#= item.displayText() #</span>")}).fadeIn().data("kendoTreeView");aF.remove();L.assignTreeViewDataItems(aJ._treeView.element,aH);if(aI.childItems()&&(aI.childItems().length>0)){at.selectItem(aI.getMobileProject());y.keyBindingService.focusRegion(w.PROJECT_NAVIGATOR_REGION)}$(aJ.projectTreeNode).on("dblclick",".k-item",function(aK){aJ._onTreeItemDblClick({node:this,isSimulated:false});aK.stopPropagation()});$(aJ.projectTreeNode).on("click",".k-item",function(aL){var aK=$(aL.target),aM=$(this).closest(".k-item")[0];if(aJ.projectTreeNode[0]!==document.activeElement){aJ.projectTreeNode.focus();aJ.lastNode=null}y.keyBindingService.focusRegion(w.PROJECT_NAVIGATOR_REGION);if($.browser.msie&&Math.floor($.browser.version)===10){aJ.contextMenu.hideContextMenu()}if(aK.hasClass("k-plus")||aK.hasClass("k-minus")){return}aJ.selectNodes([aM]);aL.stopPropagation();if(aM===aJ.lastNode){aL.preventDefault();aJ._onTreeItemDblClick({node:aM,isSimulated:true})}else{aJ.clicksHandled=0;aJ.lastNode=aJ._treeView.select()[0]}});var aG=aI.getMobileProject();aJ._buildContextMenus(aG)},_onTreeItemDblClick:function(aE){var aH=this,aD=$(aE.node),aF=aD.data("dataItem"),aG=aF.projectItemType();if(aG===w.PROJECT_ITEM_FILE||aG===w.PROJECT_ITEM_PROPERTIES_DIRECTORY){at.openProjectItem(aF);aH.lastNode=null}else{aH.clicksHandled+=1;if(aH.clicksHandled<=2||aE.isSimulated){aH._treeView.toggle(aD[0])}}},onRegionFocusChange:function(aD){var aE=this;if(aD.newRegionName===w.PROJECT_NAVIGATOR_REGION&&aE.projectTreeNode[0]!==document.activeElement){aE.projectTreeNode.focus();aE.lastNode=null}},onVisualItemRemoved:function(aD){var aG=this;var aE=aG._treeView.select();if(aE.length===0){var aF=ay.solution();at.selectItem(aF.getMobileProject());ad.raiseSelectionChanged()}},onVisualItemRenamed:function(aD){var aE=aD.dataItem;var aG=aE.element();var aF="k-icon ico-"+aE.iconType();$(".k-in>.k-icon:first",aG).removeAttr("class").attr("class",aF);$(">div>.k-in>.tnode",aG).text(aD.newText);this.selectNodes([aD.dataItem.element()])},onVisualItemExpand:function(aD){this._treeView.expand(aD.dataItem.element())},onTreeItemSelected:function(aD){var aE=this;aE.selectNodes([aD.node])},onDragStart:function(aD){aC.logEvent("ProjectNavigation","onDragStart");var aE=[aD.sourceNode];if(!this._itemsAreDraggable(aE)){aD.preventDefault()}}.attribute("track",{featureCategory:w.TrackingTags.featureCategory.ProjectNavigation.name,featureName:w.TrackingTags.featureCategory.ProjectNavigation.features.Move}),onDrop:function(aG){aC.logEvent("ProjectNavigation","onDrop");aG.preventDefault();var aN=this;var aL=[aG.sourceNode];var aF=aG.destinationNode;var aD=$(aF).data("dataItem");var aE=(aG.dropPosition==="over")?aD:aN._getParentDataItem(aD);if(aF&&aE){var aK=$.map(aL,function(aO,aP){return $(aO).data("dataItem")});if(aE.getIsDropTarget()&&!aE.getIsChildOf(aK)){aN._deferred=at.moveProjectItemsInternally(aE,aK)}}else{var aM=aG.dropTarget;var aJ=$(aM).closest(ax.getViewNavigationPane()).length>0;var aI=$(aM).closest(ax.getViewPane()).length>0;if(aJ||aI){for(var aH=0;aH<aL.length;aH++){aN._onTreeItemDblClick({node:aL[aH]})}}}}.attribute("track",{featureCategory:w.TrackingTags.featureCategory.ProjectNavigation.name,featureName:w.TrackingTags.featureCategory.ProjectNavigation.features.Move}),onVisualItemSelected:function(aD){this.selectNodes([aD.node])},selectNodes:function(aD){var aE=this;aE._treeView.select(aD);ad.selectedDomElements(aD);ad.raiseSelectionChanged()},triggerRegionFocusChange:function(aD){y.keyBindingService.focusRegion(aD.name)},_buildContextMenus:function(aE){var aM=this;var aD=y.commandService.getCommandsByCategory(w.PROJECT_NAVIGATOR_NODE_COMMANDS);if(!aD||aD.length===0){return}var aJ=aM.projectTreeNode;var aG=function(aN){var aP=aN.item;var aO=$(aP).data("command");if(aO&&aO.canExecute()&&aO.getSubCommands().length===0){var aQ=$(aP).data("menu"),aR=$(aP).data("regionName");aQ.hideContextMenu();aO.execute();aO.executeLogLambda(function(){aC.logEvent(aO.featureCategory,aO.featureName)})}};aM.contextMenu=y.commandMenuService.buildContextMenu(aD,aG,{shouldAddMenuClass:true,dataItem:aE});if(aM.contextMenu.element.children()===0){return}var aH=function(aN){var aO=this;aM._treeView.select(aO);aM.onTreeItemSelected({node:aO});aM.lastNode=aM._treeView.select()[0];aK();if(aM.contextMenu.element.children().length===0){aM.contextMenu.disposeContextMenu();aN.preventDefault();aN.stopPropagation();return}aM.contextMenu.openOn($(">div",aO),aN.pageX,aN.pageY);aN.preventDefault();aN.stopPropagation()};var aI=function(aN){if(aM.contextMenu&&aM.contextMenu.element&&$(aM.contextMenu.element).is(":visible")){aM.contextMenu.hideContextMenu();$("#projectTreeMenu").removeClass("k-state-border-down")}else{aK();aM.contextMenu.openOn(this)}};$(aJ).delegate(".k-item","contextmenu",aH);$("#projectTreeMenu").bind("click",aI);var aK=function(){var aO=aM.lastNode,aN=aM._treeView.dataItem(aO);if(!aO||!aN){var aQ=ay.solution();var aP=aQ.getMobileProject();aO=aP.element();aN=aM._treeView.dataItem(aO)}aF();aM._buildContextMenus(aN)};var aF=function(){aM.contextMenu.disposeContextMenu();y.commandService.unbind(w.COMMAND_REGISTERED,aK);at.unbind(w.UNLOAD_SOLUTION,aF);$(aJ).undelegate(".k-item","contextmenu",aH);$("#projectTreeMenu").unbind("click",aI)};var aL=function(aN){if(aN.command.categories().indexOf(w.PROJECT_NAVIGATOR_NODE_COMMANDS)!==-1){aK()}};y.commandService.bind(w.COMMAND_REGISTERED,aL);at.bind(w.UNLOAD_SOLUTION,aF)},_getParentDataItem:function(aD){var aE=null;if(!(aD instanceof ar)){aE=aD.parentItem}return aE},_itemsAreDraggable:function(aE){for(var aD=0;aD<aE.length;aD++){if(!$(aE[aD]).data("dataItem").getIsDraggable()){return false}}return true}});var av=O.Class.extend({init:function(){},parse:function(){},_cleanUpReferences:function(aD){aD.Properties=null}});var aB=av.extend({init:function(){this._solutionFolderParser=null;this._projectParser=null},parse:function(aE){var aI=this;if(aE!==undefined){var aF=aI._createSolutionItem(aE);var aH=aE.Items;for(var aD=0;aD<aH.length;aD++){var aG=aI._parseSolutionItem(aH[aD]);aF.addItem(aG)}return aF}},_parseSolutionItem:function(aE){var aF=this;var aD;if(aF._isSolutionFolder(aE)){aD=aF._getSolutionFolderParser()}else{aD=aF._getProjectParser()}return aD.parse(aE)},_getSolutionFolderParser:function(){var aD=this;if(!aD._solutionFolderParser){aD._solutionFolderParser=new aw()}return aD._solutionFolderParser},_getProjectParser:function(){var aD=this;if(!aD._projectParser){aD._projectParser=new ai()}return aD._projectParser},_isSolutionFolder:function(aD){return false},_createSolutionItem:function(aE){if(aE===null){B.showMessageBox(b.MESSAGE_ICENIUM,"Mist cannot load '"+iceConfiguration.solutionName+"' workspace!").always(function(){y.navigationService.navigateToDashboard(dontAddSolutionName)});return}var aD=new ar();aD.itemText(aE.Name);return aD}});var aw=av.extend({});var ai=av.extend({init:function(){this._itemParser=null},parse:function(aH){var aI=this;var aE=aI._createProjectItem(aH);var aG=aH.Items;for(var aD=0;aD<aG.length;aD++){var aF=aI._parseProjectItem(aG[aD]);aE.addItemToProject(aF)}aI._finalizeParsing(aE);return aE},_finalizeParsing:function(aE){var aF=aE._getItem("Properties",w.PROJECT_ITEM_DIRECTORY);if(!aF){aF=new Z();aF.itemText("Properties");aE.addItem(aF)}aF.projectItemType(w.PROJECT_ITEM_PROPERTIES_DIRECTORY);if(aE.type()===w.MSBUILD_PROJECT_TYPE_CALLBACK){var aD=aE._getItem("App_Resources",w.PROJECT_ITEM_DIRECTORY);if(aD){aD.hide()}}this._groupPlatformFiles(aE)},_getItemParser:function(){var aD=this;if(!aD._itemParser){aD._itemParser=new N()}return aD._itemParser},_parseProjectItem:function(aD){return this._getItemParser().parse(aD)},_createProjectItem:function(aE){var aD=new X();aD.itemText(aE.Name);aD.setProperties(aE.Properties);if(aD.properties&&aD.properties.TemplateAppName){aD.properties.FrameworkVersion=w.CordovaVersions[aD.properties.TemplateAppName].replace("Cordova ","")}if(aD.properties&&aD.properties.ProjectTypeGuids){aD.type(aa.getProjectType(aD.properties.ProjectTypeGuids))}if(aD.properties&&aD.properties.CorePlugins===undefined){aD.properties.CorePlugins=""}this._cleanUpReferences(aE);return aD},_groupPlatformFiles:function(aN){var aR=this,aO=w.PLATFORM_TARGETED_FILE_REGEX,aM=w.PLATFORM_EXTRACTION_REGEX,aL=aN.getItems(function(aS){return(aO.test(aS.identifier())&&aS.type()!==w.MSBUILD_FOLDER)});var aE={};if(aL.length>0){for(var aI=0;aI<aL.length;aI++){var aK=aL[aI],aQ=aK.text,aG=aQ.replace(aM,""),aJ=aK.parentItem;parentIdentifier=aJ.identifier();if(aE[parentIdentifier+aG]===undefined){aE[parentIdentifier+aG]={groupName:aG,platformFiles:[],parent:aK.parentItem}}aE[parentIdentifier+aG].platformFiles.push(aK)}}for(var aF in aE){var aD=new Z(),aG=aE[aF].groupName,aJ=aE[aF].parent,aH;if(aG==="cordova.js"){aH=w.PROJECT_ITEM_CORDOVA_GROUP}else{aH=w.PROJECT_ITEM_PLATFORM_TARGET_GROUP}aD.itemText(aG);aD.identifier(aG);aD.type(w.MSBUILD_FOLDER);aD.documentType(w.DOCUMENT_TYPE_DIRECTORY);aD.projectItemType(aH);aD.project=aN;aD.hasDependencies(true);aD.setIsDraggable(false);aD.setIsDropTarget(false);aD.setIsRenamable(false);aR._protectItem(aD);aJ.addItem(aD);for(var aI=0;aI<aE[aF].platformFiles.length;aI++){var aP=aE[aF].platformFiles[aI];if(aG==="cordova.js"){aR._protectItem(aP);aP.setIsReadonly(true)}aP.properties={};aP.properties.DependentUpon=aD.itemText();aD.addItem(aP)}}},_protectItem:function(aD){aD.setIsDraggable(false);aD.setIsDropTarget(false);aD.setIsPasteTarget(false);aD.setIsDeletable(false);aD.setIsRenamable(false);aD.setIsCopyable(false)}});var N=av.extend({parse:function(aD){var aE=this;switch(aD.Type){case w.MSBUILD_REFERENCE:return aE._parseReference(aD);case w.MSBUILD_PROJECT_REFERENCE:return aE._parseProjectReference(aD);case w.MSBUILD_COMPILE:return aE._parseCompile(aD);case w.MSBUILD_CONTENT:return aE._parseContent(aD);case w.MSBUILD_FOLDER:return aE._parseFolder(aD);default:return aE._parseUnknown(aD)}},_parseReference:function(aE){var aG=this;var aF=aE.Identifier.split(",")[0];var aD=this._initializeSolutionItem(aE.Identifier,aF,aE.Type,w.DOCUMENT_TYPE_REFERENCE,w.PROJECT_ITEM_ASSEMBLY_REFERENCE,aE.Properties);aG._cleanUpReferences(aE);return aD},_parseProjectReference:function(aE){var aF=this;var aD=aF._initializeSolutionItem(aE.Identifier,aF._extractProjectReferenceText(aE.Identifier),aE.Type,w.DOCUMENT_TYPE_REFERENCE,w.PROJECT_ITEM_PROJECT_REFERENCE,aE.Properties);aF._cleanUpReferences(aE);return aD},_parseCompile:function(aE){var aF=this;var aD=aF._initializeSolutionItem(aE.Identifier,aF._extractTextFromPath(aE.Identifier),aE.Type,aa.getDocumentType(aE.Identifier),w.PROJECT_ITEM_FILE,aE.Properties);aF._cleanUpReferences(aE);return aD},_parseContent:function(aE){var aF=this;var aD=aF._initializeSolutionItem(aE.Identifier,aF._extractTextFromPath(aE.Identifier),aE.Type,aa.getDocumentType(aE.Identifier),null,aE.Properties);aD.projectItemType((aD.documentType()===w.DOCUMENT_TYPE_DB_SDF)?w.PROJECT_ITEM_DB:w.PROJECT_ITEM_FILE);aF._cleanUpReferences(aE);return aD},_parseFolder:function(aE){var aF=this;var aD=aF._initializeSolutionItem(aE.Identifier,aF._extractTextFromPath(aE.Identifier),aE.Type,w.DOCUMENT_TYPE_DIRECTORY,w.PROJECT_ITEM_DIRECTORY,aE.Properties);aF._cleanUpReferences(aE);return aD},_parseUnknown:function(aE){var aD=this._parseContent(aE);aD.type(w.MSBUILD_UNKNOWN);return aD},_initializeSolutionItem:function(aE,aI,aJ,aD,aG,aH){var aF=new Z();aF.identifier(aE);aF.itemText(aI);aF.type(aJ);aF.documentType(aD);aF.projectItemType(aG);aF.setProperties(aH);return aF},_extractTextFromPath:function(aF){var aE=aF.split("\\");var aD=aE[aE.length-1];return(aD.length>0)?aD:aE[aE.length-2]},_extractProjectReferenceText:function(aF){var aG=aF.split("\\");var aD=aG[aG.length-1];var aE=aD.split(".");return aE.splice(0,aE.length-1).join(".")}});var ab=O.Class.extend({init:function(){},getType:function(aD){if((aD===w.DOCUMENT_TYPE_CSHARP)||(aD===w.DOCUMENT_TYPE_VB)){return w.MSBUILD_COMPILE}return w.MSBUILD_CONTENT},getDocumentType:function(aE){var aF=this;var aD=L.getDocumentTypeByFilePath(aE);return aD},getProjectType:function(aD){if(aD.indexOf(w.MSBUILD_PROJECT_TYPE_CALLBACK)>-1){return w.MSBUILD_PROJECT_TYPE_CALLBACK}else{return w.MSBUILD_PROJECT_TYPE_MVC3}}});var Z=O.data.Node.define({init:function(){var aD=this;aD.children={sort:Y};O.data.Node.fn.init.apply(aD,arguments);aD.hiddenItems=null;aD.properties=null;aD.text=null;aD.expanded=false;aD.project=null;aD.properties=null;aD.isFolder=false;aD.isSpecialFolder=false;aD.visible=true;aD.versionControlCssClassPrefix="change-type-";aD._sortText=null;aD._identifier=null;aD._type=null;aD._projectItemType=null;aD._documentType=null;aD._element=null;aD._hasDependencies=false;aD._versionControlStatus=null;aD._isDraggable=true;aD._isDropTarget=true;aD._isPasteTarget=true;aD._isReadonly=false;aD._isVirtual=false;aD._isDeletable=true;aD._isRenamable=true;aD._isCopyable=true},childItems:function(aE){var aG=null;var aD=this.children;if(aD&&aD.view){var aF=aD.view();aF=(aF)?aF.slice():null;aG=aF;if(aE!==undefined){aG=null;if(aE>-1&&aF.length>aE){aG=aF[aE]}}}return aG},getChild:function(aD,aH){var aI=this;var aE=aI.childItems();var aF=function(aJ){return(aE[aJ].identifier()===aD)&&aE[aJ].projectItemType()===aH};var aG=$(aE).filter(aF);return(aG.length>0)?aG[0]:null},getPropertiesFolderItem:function(){var aF=this,aE,aD=aF.childItems();aE=aF.getItems(function(aG){return aG.projectItemType()===w.PROJECT_ITEM_PROPERTIES_DIRECTORY});if(aE.length>0){return aE[0]}return null},itemText:function(aD){var aE=this;if(aD){aE.text=aD;aE._sortText=aD.toLowerCase()}return w.Property.call.apply(aE,["itemText",aD])},displayText:function(){return this.itemText()},sort:function(){var aD=this.children;if(aD){aD.sort(Y)}},identifier:function(aD){return w.Property.call.apply(this,["identifier",aD])},generateIdentifier:function(aF){var aG=this,aD=(aG.parentItem.hasDependencies())?aG.parentItem.parentItem:aG.parentItem,aE=aD.generateIdentifier();aF=(aF===undefined)?aG.text:aF;return(aE==="")?aF:aE+"\\"+aF},type:function(aD){return w.Property.call.apply(this,["type",aD])},projectItemType:function(aE){var aD=this;if(aE){aD.isFolder=aD._isFolder(aE);aD.isSpecialFolder=aD._isSpecialFolder(aE)}return w.Property.call.apply(this,["projectItemType",aE])},documentType:function(aD){return w.Property.call.apply(this,["documentType",aD])},element:function(aD){return w.Property.call.apply(this,["element",aD])},hasDependencies:function(aD){return w.Property.call.apply(this,["hasDependencies",aD])},iconType:function(){var aG=this,aH=aG.projectItemType(),aE=w.ICON_UNKNOWN;try{switch(aH){case w.PROJECT_ITEM_REFERENCES_DIRECTORY:aE=w.ICON_REFERENCES;break;case w.PROJECT_ITEM_PROJECT_REFERENCE:case w.PROJECT_ITEM_ASSEMBLY_REFERENCE:aE=w.ICON_REFERENCE;break;case w.PROJECT_ITEM_PROPERTIES_DIRECTORY:aE=w.ICON_PROPERTIES;break;case w.PROJECT_ITEM_APP_DATA_DIRECTORY:case w.PROJECT_ITEM_DIRECTORY:aE=w.ICON_DIRECTORY;break;case w.PROJECT_ITEM_PLATFORM_TARGET_GROUP:aE=w.ICON_TARGET_GROUP+"-"+L.getDocumentTypeByFilePath(aG.text)+" "+w.ICON_TARGET_GROUP;break;case w.PROJECT_ITEM_FILE:if(aG.documentType()!==w.DOCUMENT_TYPE_UNKNOWN){if(w.ICON_FILE_EXTENSIONS.indexOf(aG.documentType())!==-1){aE=aG.documentType()}}else{var aF=L.isImageFile(aG.text);if(aF){aE=w.ICON_IMAGE}}break;case w.PROJECT_ITEM_DB:aE=w.ICO_DB;break;case w.PROJECT_ITEM_CORDOVA_GROUP:aE=w.ICON_CORDOVA;break;case w.PROJECT_ITEM_CORDOVA_PLUGINS_DIRECTORY:aE=w.ICON_CORDOVA_PLUGINS_DIR;break;case w.PROJECT_ITEM_PLUGIN_ASSET_GROUP:aE=w.DOCUMENT_TYPE_JAVA_SCRIPT;break;default:if(aG.isProject){aE=w.ICON_PROJECT}else{if(aG.isSolution){aE=w.ICON_SOLUTION}}}}catch(aD){P.logOutputMessage("failed icon type: "+aD.message)}return aE},setProperties:function(aD){var aE=this;aE.properties=aD},hide:function(){var aE=this;if(aE.visible){var aD=aE.parentItem;if(aD){aD._removeItem(aE);aD._initializeHiddenItemCollection();aD.hiddenItems.push(aE);aE.visible=false}}},hasItem:function(aF,aG){var aH=this;var aD=aH.childItems();var aE=function(aI){return(aD[aI].text===aF)&&aD[aI].projectItemType()===aG};return aD&&$(aD).filter(aE).length>0},hasItemWithIdentifier:function(aD,aG){var aH=this;var aE=aH.childItems();var aF=function(aI){return(aE[aI].identifier()===aD)&&aE[aI].projectItemType()===aG};return aE&&$(aE).filter(aF).length>0},addItem:function(aE){var aF=this;if(aE.parentItem){aE.parentItem.removeItem(aE)}aF.append(aE);aE.parentItem=aF;aE.project=aF.project;var aD={item:aE,parent:aF};aF.trigger(w.ITEM_ADDED,aD);aF._handleDependencies(aE);aF._notifySolution(w.ITEM_ADDED,aD)},removeItem:function(aE){var aF=this;aF._removeItem(aE);aE.parentItem=null;var aD={item:aE,parent:aF};aF.trigger(w.ITEM_REMOVED,aD);aF._notifySolution(w.ITEM_REMOVED,aD)},getPath:function(){var aE=this;var aD=aE.identifier();aD=(aD)?aD:aE.generateIdentifier();return aE.getPathFromIdentifier(aD)},getFullPath:function(){var aE=this;var aD=aE.identifier();aD=(aD)?aD:aE.generateIdentifier();return aE.getProjectPathFromIdentifier(aD)},getPathWithoutText:function(){var aD=this;return aD.getFullPath()},getProjectItemInfo:function(){var aF=this,aD=aF.project.getProjectItemInfo(),aE=aF._extractPropertiesInArray();return{Project:aD,Type:aF.type(),Identifier:aF.identifier(),Properties:aE}},getPathFromText:function(aE){var aF=this,aD=aF.generateIdentifier(aE);return aF.getPathFromIdentifier(aD)},getPathFromIdentifier:function(aE){var aH=this;if(aE){var aG=aH.project;var aF=aE.split("\\");var aD=(aF[0]!=="")?aE:aF.splice(1,aF.length-1).join("\\");return["",aG.solution.text,aG.text,aD].join("\\")}else{return null}},getProjectPathFromIdentifier:function(aE){var aH=this;if(aE){var aG=aH.project;var aF=aE.split("\\");var aD=(aF[0]!=="")?aE:aF.splice(1,aF.length-1).join("\\");return[aG.text,aD].join("\\")}else{return null}},getHierarchicalIndex:function(){var aH=this;var aE=aH.parentItem;var aG=null;if(aE){var aD=$(aE.childItems()).index(aH);if((aD!==null)&&(aD>=0)){var aF=aE.getHierarchicalIndex();if(aF===""){aG=aD+""}else{aG=[aF,aD].join(":")}}}else{if((!aE)&&(aH instanceof ar)){aG=""}}return aG},getIsDraggable:function(){var aE=this,aD=aE.projectItemType();return(aE._isDraggable&&!(aE instanceof ar)&&!(aE instanceof X)&&aD!==w.PROJECT_ITEM_APP_DATA_DIRECTORY&&aD!==w.PROJECT_ITEM_REFERENCES_DIRECTORY&&aD!==w.PROJECT_ITEM_PROPERTIES_DIRECTORY&&aD!==w.PROJECT_ITEM_PROJECT_REFERENCE&&aD!==w.PROJECT_ITEM_ASSEMBLY_REFERENCE&&aD!==w.PROJECT_ITEM_CORDOVA_GROUP&&(aE.parentItem&&aE.parentItem.projectItemType()!==w.PROJECT_ITEM_CORDOVA_GROUP))},setIsDraggable:function(aD){this._isDraggable=aD},getIsDropTarget:function(){var aD=this;return(aD._isDropTarget&&(!(aD instanceof ar))&&(aD.projectItemType()!==w.PROJECT_ITEM_REFERENCES_DIRECTORY)&&(aD.projectItemType()!==w.PROJECT_ITEM_CORDOVA_GROUP)&&((aD.type()===w.MSBUILD_FOLDER)||(aD instanceof X)||aD.projectItemType()===w.PROJECT_ITEM_CORDOVA_PLUGINS_DIRECTORY))},setIsDropTarget:function(aD){this._isDropTarget=aD},getIsPasteTarget:function(){var aD=this;return aD._isPasteTarget&&aD.getIsDropTarget()},setIsPasteTarget:function(aD){this._isPasteTarget=aD},getIsReadonly:function(){return this._isReadonly},setIsReadonly:function(aD){this._isReadonly=aD},getIsVirtual:function(){return this._isVirtual},setIsVirtual:function(aD){this._isVirtual=aD},getIsDeletable:function(){return this._isDeletable},setIsDeletable:function(aD){this._isDeletable=aD},getIsRenamable:function(){return this._isRenamable},setIsRenamable:function(aD){this._isRenamable=aD},getIsCopyable:function(){return this._isCopyable},setIsCopyable:function(aD){this._isCopyable=aD},getIsChildOf:function(aE){var aF=this.parentItem;if(aF){var aG=[aF];while(true){aF=aF.parentItem;if(aF){aG.push(aF)}else{break}}for(var aD=0;aD<aE.length;aD++){if(aG.indexOf(aE[aD])!==-1){return true}}}return false},getItemByText:function(aG){var aE=this.childItems();var aD=function(aH){return aE[aH].text===aG};var aF=$(aE).filter(aD);return(aF.length>0)?aF[0]:null},versionControlStatus:function(aD){return w.Property.call.apply(this,["versionControlStatus",aD])},getVersionControlClass:function(){var aE=this;var aD=aE.versionControlStatus();return(aD)?aE.versionControlCssClassPrefix+aD:""},clone:function(){var aE=this;var aF;if(aE instanceof Z){aF=Z}else{if(aE instanceof X){aF=X}else{if(aE instanceof ar){aF=ar}}}var aD=new aF();aD.itemText(aE.text);aD.type(aE.type());aD.documentType(aE.documentType());aD.projectItemType(aE.projectItemType());return aD},getParent:function(aD){var aE=this.parentItem;while(!aD(aE)){aE=aE.parentItem;if(!aE){break}}return aE},getItems:function(aG){var aH=[];var aF=this.childItems();if(aF){aF=aF.slice();while(aF.length>0){var aE=aF.shift();var aD=aE.childItems();if(aD){aD=aD.slice();aF=aF.concat(aD)}if(aG(aE)){aH.push(aE)}}}return aH},_isFolder:function(aD){return aD===w.PROJECT_ITEM_DIRECTORY||this._isSpecialFolder(aD)},_isSpecialFolder:function(aD){return aD===w.PROJECT_ITEM_REFERENCES_DIRECTORY||aD===w.PROJECT_ITEM_PROPERTIES_DIRECTORY||aD===w.PROJECT_ITEM_APP_DATA_DIRECTORY||aD===w.PROJECT_ITEM_CORDOVA_GROUP||aD===w.PROJECT_ITEM_CORDOVA_PLUGINS_DIRECTORY},_extractPropertiesInArray:function(){var aE=this.properties,aF=[];if(aE){for(var aD in aE){aF.push({Key:aD,Value:aE[aD]})}}return aE},_notifySolution:function(aE,aD){var aH=this;var aF=aH.project;if(aF){var aG=aF.solution;if(aG){aG.onChildEventRaised(aE,aD)}}},_removeItem:function(aD){var aF=this;aF.children.remove(aD);if(aF.projectItemType()===PROJECT_ITEM_PLATFORM_TARGET_GROUP&&aF.childItems().length===0){var aE=aF.parentItem;if(aE){aE.removeItem(aF)}}},_initializeHiddenItemCollection:function(){var aD=this;if(!aD.hiddenItems){aD.hiddenItems=[]}},_handleDependencies:function(aD){var aE=this;if(aD.properties&&aD.properties.DependentUpon){if(!aE._tryAssignDependentItem(aD)){aD._sibblingAddedHandler=$.proxy(aD._resolveItemDependency,aD);aD.parentItem.bind(w.ITEM_ADDED,aD._sibblingAddedHandler)}}},_tryAssignDependentItem:function(aF,aI){var aH=aF.parentItem;var aJ=false;var aD=function(aK){return aK.identifier()===aF.properties.DependentUpon};if(aI){if(aD(aI)){aI.addItem(aF);aI.hasDependencies(true);aJ=true}}else{var aG=aH.childItems();for(var aE=0;aE<aG.length;aE++){if(aD(aG[aE])){aG[aE].addItem(aF);aG[aE].hasDependencies(true);aJ=true;break}}}return aJ},_resolveItemDependency:function(aD){var aE=this;if(aE._tryAssignDependentItem(aE,aD.item)){aE.parentItem.unbind(w.ITEM_ADDED,aE._sibblingAddedHandler)}},addCommands:[w.COMMAND_ADD_ROOT,w.COMMAND_ADD_FILE,w.COMMAND_ADD_FOLDER,w.COMMAND_ADD_EXISTING_FILES,w.COMMAND_ADD_FROM_ARCHIVE],vcCommands:[w.COMMAND_VERSION_CONTROL_ROOT,w.COMMAND_VERSION_CONTROL_CONFIG_REMOTE_REPO,w.COMMAND_VERSION_CONTROL_PULL,w.COMMAND_VERSION_CONTROL_PUSH,w.COMMAND_VERSION_CONTROL_DIFF,w.COMMAND_VERSION_CONTROL_COMMIT,w.COMMAND_VERSION_CONTROL_REVERT,w.COMMAND_VERSION_CONTROL_HISTORY,w.COMMAND_VERSION_CONTROL_CONFLICTS],getApplicableCommandTypes:function(){var aD=this,aE=aD.projectItemType(),aF=[];switch(aE){case w.PROJECT_ITEM_REFERENCES_DIRECTORY:return[];case w.PROJECT_ITEM_PROJECT_REFERENCE:case w.PROJECT_ITEM_ASSEMBLY_REFERENCE:return[];case w.PROJECT_ITEM_PROPERTIES_DIRECTORY:return this.vcCommands.concat([COMMAND_OPEN_PROJECT_PROPERTIES]);case w.PROJECT_ITEM_APP_DATA_DIRECTORY:case w.PROJECT_ITEM_DIRECTORY:aF=this.addCommands.concat(this.vcCommands).concat([w.COMMAND_RENAME_ITEM]).concat([w.COMMAND_CUT_ITEMS]).concat([w.COMMAND_COPY_ITEMS]).concat([w.COMMAND_DELETE_ITEMS]).concat([w.COMMAND_PASTE_ITEMS]);return aF;case w.PROJECT_ITEM_FILE:aF=[w.COMMAND_OPEN_ITEM].concat(this.vcCommands).concat([w.COMMAND_RENAME_ITEM]).concat([w.COMMAND_CUT_ITEMS]).concat([w.COMMAND_COPY_ITEMS]).concat([w.COMMAND_DELETE_ITEMS]);return aF;case w.PROJECT_ITEM_DB:return[];case w.PROJECT_ITEM_CORDOVA_GROUP:return this.vcCommands;case w.PROJECT_ITEM_PLATFORM_TARGET_GROUP:return this.vcCommands;case w.PROJECT_ITEM_CORDOVA_PLUGINS_DIRECTORY:aF=this.addCommands.concat(this.vcCommands).concat([w.COMMAND_PASTE_ITEMS]);return aF;case w.PROJECT_ITEM_PLUGIN_ASSET_GROUP:return[];default:if(aD.isProject){return[]}else{if(aD.isSolution){return[]}}}}});var X=Z.extend({init:function(){Z.fn.init.apply(this,arguments);var aD=this;aD.solution=null;aD.isProject=true;aD._dirReferences=null;aD._dirAppData=null},generateIdentifier:function(){return""},addItem:function(aE){var aF=this;if(aE.parentItem){aE.parentItem.removeItem(aE)}aF.append(aE);aE.parentItem=aF;aE.project=aF;var aD={item:aE,parent:aF};aF.trigger(w.ITEM_ADDED,aD);aF._handleDependencies(aE);aF._notifySolution(w.ITEM_ADDED,aD)},addItemToProject:function(aD){var aE=this;switch(aD.type()){case w.MSBUILD_REFERENCE:case w.MSBUILD_PROJECT_REFERENCE:aE._addReference(aD);break;case w.MSBUILD_COMPILE:case w.MSBUILD_CONTENT:case w.MSBUILD_FOLDER:case w.MSBUILD_UNKNOWN:aE._addFileSystemItem(aD);break}},getPath:function(){var aE=this;var aD=aE;return["",aD.solution.text,aD.text].join("\\")},getProjectIdentifier:function(){var aD=this;return[aD.solution.text,aD.text].join("\\")},getProjectInfo:function(){var aD=this;return{SolutionName:aD.solution.text,ProjectIdentifier:aD.getProjectIdentifier(),ProjectName:aD.text}},getLiveSyncTokenAsync:function(){var aD=this;return ap.cordovaService.getLiveSyncToken({solutionName:aD.solution.text,projectName:aD.text})},getProjectItemInfo:function(){return this.getProjectInfo()},getFullPath:function(){var aD=this;return aD.text+"\\"+aD.text+".proj"},getPathWithoutText:function(){var aD=this;return aD.text},getTemplate:function(){var aK=this;var aJ=w.TEMPLATE_BLANK;var aG=aK.getItemByText("kendo");var aF=null;if(aG){var aH=aG.getItemByText("js");if(aH){var aI=aH.getItemByText("kendo.mobile.min.js");if(aI){aF=aH.getItemByText("jquery.min.js");if(aF){aJ=w.TEMPLATE_KENDO}}}}else{var aD=aK.getItemByText("jquery-mobile");if(aD){aF=aD.getItemByText("jquery-1.7.2.min.js");if(aF){var aE=aD.getItemByText("jquery.mobile-1.1.0.min.js");if(aE){aJ=w.TEMPLATE_JQUERY}}}}return aJ},getUsedPluginsIdentification:function(){var aH=this,aG="org.apache.cordova.core",aF="org.apache.cordova",aD=aH.properties.CorePlugins.split(";");for(var aE=0;aE<aD.length;aE++){if(aD[aE].startsWith(aG)){aD[aE]=aD[aE].replace(aG,aF)}}return aD},getPermissions:function(){var aL={};var aI=this.properties.AndroidPermissions;var aG=function(aP){var aO=aK[aP];return aO.id===aE};var aM=[];var aK=$.map(w.AndroidPermissions,function(aO){return{id:aO.id,Name:$.map(aO.id.split(".")[2].split("_"),function(aP){aP=aP.toLowerCase();return aP.charAt(0).toUpperCase()+aP.slice(1)}).join(""),Description:aO.description}});var aJ=$.map(w.AndroidPermissions,function(aO){return aO.id});if(aI&&aI.length>0){var aN=aI.split(";");for(var aD=0;aD<aN.length;aD++){var aE=aN[aD];var aF=$(aK).filter(aG)[0];var aH=aK.indexOf(aF);aK.splice(aH,1);aM[aJ.indexOf(aE)]=aF}}aL.selected=L.removeArrayPaddings(aM);aL.remaining=aK;return aL},_notifySolution:function(aE,aD){var aG=this;var aF=aG.solution;if(aF){aF.onChildEventRaised(aE,aD)}},_addReference:function(aD){var aF=this;var aE=aF._getReferencesDir();aE.addItem(aD)},_addFileSystemItem:function(aD){var aI=this;var aG=aD.identifier().split("\\");var aH=1;if(aG[aG.length-1].length===0){aH=2}var aF=aG.splice(0,aG.length-aH).join("\\");var aE=aI._ensurePathExistence(aF);if(!aE.hasItem(aD.text,aD.projectItemType())){aE.addItem(aD)}},_getReferencesDir:function(){var aE=this;if(!aE._dirReferences){var aD=new Z();aD.itemText("References");aD.projectItemType(w.PROJECT_ITEM_REFERENCES_DIRECTORY);aD.documentType(w.DOCUMENT_TYPE_DIRECTORY);aD.project=aE;aE.addItem(aD);aE._dirReferences=aD}return aE._dirReferences},_getPluginsDir:function(){var aF=this;var aD="Plugins";var aE;if(aF.hasItemWithIdentifier(aD,w.PROJECT_ITEM_CORDOVA_PLUGINS_DIRECTORY)){aE=aF.getChild(aD,w.PROJECT_ITEM_CORDOVA_PLUGINS_DIRECTORY)}else{aE=aF._createPluginsDirectory();aF.addItem(aE)}return aE},_ensurePathExistence:function(aI,aH){var aJ=this;aH=aH?aH:aJ;if(aI.length>0){var aF=aI.split("\\");var aD="";for(var aG=0;aG<aF.length;aG++){if(!aH.hasItem(aF[aG],w.PROJECT_ITEM_DIRECTORY)){var aE=aJ._createDirectory(aF[aG]);aH.addItem(aE);aE.identifier(aE.generateIdentifier());aH=aE}else{aD=(aD!=="")?[aD,aF[aG]].join("\\"):aF[aG];aH=aJ._getItem(aD,w.PROJECT_ITEM_DIRECTORY)}}}return aH},_createDirectory:function(aE){var aD=new Z();aD.itemText(aE);aD.type(w.MSBUILD_FOLDER);aD.documentType(w.DOCUMENT_TYPE_DIRECTORY);aD.projectItemType(w.PROJECT_ITEM_DIRECTORY);aD.project=this;return aD},_createPluginsDirectory:function(){var aE=new Z();var aD="Plugins";aE.itemText(aD);aE.identifier(aD);aE.documentType(w.DOCUMENT_TYPE_DIRECTORY);aE.projectItemType(w.PROJECT_ITEM_CORDOVA_PLUGINS_DIRECTORY);aE.project=this;aE.setIsDraggable(false);aE.setIsDropTarget(true);aE.setIsPasteTarget(true);aE.setIsDeletable(false);aE.setIsRenamable(false);aE.setIsCopyable(false);return aE},_getItem:function(aK,aL,aD){var aJ=aK.split("\\"),aE=this,aI;if(aD){aE=aD}var aG=function(aM){return aE.childItems(aM).text===aI&&(aF===(aJ.length-1)||aE.childItems(aM).projectItemType()===w.PROJECT_ITEM_DIRECTORY)};for(var aF=0;aF<aJ.length;aF++){aI=aJ[aF];var aH=$(aE.childItems()).filter(aG);if(aH[0]){aE=aH[0]}else{return undefined}}return aE},applicableCommandTypes:[w.COMMAND_ADD_ROOT,w.COMMAND_ADD_FILE,w.COMMAND_ADD_FOLDER,w.COMMAND_ADD_EXISTING_FILES,w.COMMAND_ADD_FROM_ARCHIVE,w.COMMAND_EDIT_CONFIGURATION,w.COMMAND_EDIT_ANDROID_MANIFEST,w.COMMAND_EDIT_ANDROID_CONFIG,w.COMMAND_EDIT_iOS_INFO_PLIST,w.COMMAND_EDIT_iOS_CONFIG,w.COMMAND_VERSION_CONTROL_ROOT,w.COMMAND_VERSION_CONTROL_CONFIG_REMOTE_REPO,w.COMMAND_VERSION_CONTROL_PULL,w.COMMAND_VERSION_CONTROL_PUSH,w.COMMAND_VERSION_CONTROL_COMMIT,w.COMMAND_VERSION_CONTROL_REVERT,w.COMMAND_VERSION_CONTROL_HISTORY,w.COMMAND_VERSION_CONTROL_CONFLICTS,w.COMMAND_RENAME_ITEM,w.COMMAND_PASTE_ITEMS,w.COMMAND_PUBLISH_BUILD,w.COMMAND_PROJECT_PROPERTIES],getApplicableCommandTypes:function(){return this.applicableCommandTypes},_getResourceItem:function(aD,aE){var aG=this;var aF=aG.hiddenItems[0];return aG._getItem(aD,w.PROJECT_ITEM_DIRECTORY,aF)}});var ar=Z.extend({init:function(){Z.fn.init.apply(this,arguments);this.isSolution=true},addItem:function(aD){var aE=this;Z.fn.addItem.apply(aE,arguments);aD.solution=aE},onChildEventRaised:function(aE,aD){this.trigger(aE,aD)},getItemByHierarchicalIndex:function(aF){var aI=this;var aH;if(aF!==null){if(aF.length>0){var aG=aF.split(":");aH=aI;for(var aE=0;aE<aG.length;aE++){var aD=parseInt(aG[aE],10);if((aD<aH.childItems().length)&&(aD>=0)){aH=aH.childItems(aD)}else{aH=null;break}}}else{if(aF.length===0){aH=aI}}}return aH},getItemByFilePath:function(aK){var aH=this,aJ=aK.split("\\");if(aK.indexOf(".proj")>=0){return aH.childItems(0)}if(aJ.length&&aJ.length>0&&aJ[0]===""){aJ.shift()}var aL=aJ.shift();masterLoop:while(aL){for(var aE=0,aG=aH.childItems().length-1;aE<=aG;aE++){var aI=aH.childItems(aE);if(aI.itemText()===aL&&((aJ.length===0)||aI.isProject||aI.projectItemType()===w.PROJECT_ITEM_DIRECTORY||aI.projectItemType()===PROJECT_ITEM_CORDOVA_PLUGINS_DIRECTORY)){aH=aI;aL=aJ.shift();continue masterLoop}else{if(aI.hasDependencies()){for(var aF=0;aF<aI.childItems().length;aF++){var aD=aI.childItems(aF);if(aD.itemText()===aL){aH=aD;aL=aJ.shift();continue masterLoop}}}}}return null}return aH},getPath:function(){return["",this.text].join("\\")},getFullPath:function(){return""},getPathWithoutText:function(){return""},_notifySolution:function(){},displayText:function(){var aD=this;return O.format(w.SOLUTION_DISPLAY_FORMAT,aD.text)},getApplicableCommandTypes:function(){var aD=[w.COMMAND_VERSION_CONTROL_ROOT,w.COMMAND_VERSION_CONTROL_CONFIG_REMOTE_REPO,w.COMMAND_VERSION_CONTROL_PULL,w.COMMAND_VERSION_CONTROL_PUSH,w.COMMAND_VERSION_CONTROL_COMMIT,w.COMMAND_VERSION_CONTROL_REVERT,w.COMMAND_VERSION_CONTROL_HISTORY,w.COMMAND_VERSION_CONTROL_CONFLICTS,w.COMMAND_BUILD_SETTINGS,w.COMMAND_RENAME_ITEM];return aD},getMobileProject:function(){var aG=this,aD=aG.childItems();if(!aD||aD.length===0){return null}for(var aE=0;aE<aD.length;aE++){var aF=aD[aE];if("{"+aF._type+"}"===w.MOBILE_PROJECT_GUID){return aF}}return null}});var e=q.ViewModelBase.extend({init:function(aD){var aE=this;aE._itemToPopulate=aD;q.ViewModelBase.fn.init.apply(aE,arguments);aE.set("afterSelectCanUpload",(w.BrowserDetect.browser==="Explorer"))},initializeView:function(aF){var aE=this;aE.view=aF;aE.upload=aF.find("#existingFilesUpload").kendoUpload({async:{autoUpload:false,saveUrl:"/webapi/",saveField:"content"},localization:{select:"Select",uploadSelectedFiles:"Upload"},select:$.proxy(aE.onFilesSelected,aE),upload:$.proxy(aE.onUpload,aE),success:$.proxy(aE.onFileUploadedIE,aE),error:$.proxy(aE.onUploadError,aE),complete:$.proxy(aE.onAllDone,aE),showFileList:true}).data("kendoUpload");var aD=w.BrowserDetect.browser==="Explorer";aE._validator=aE.view.kendoValidator({rules:{isValidExtension:function(){if(aE._files===undefined){return true}for(var aH=0;aH<aE._files.length;aH++){var aG=aE._files[aH].extension;aG=(aG.length>0)?aG.substring(1,aG.length):"";if(w.DENIED_FILE_TYPES.indexOf(aG)!==-1){return false}}return true},isFolder:function(){if(aE._files===undefined){return true}for(var aG=0;aG<aE._files.length;aG++){if(aE._files[aG].size===undefined){return false}}return true},isSize:function(){if(!aD){if(aE._files===undefined){return true}for(var aG=0;aG<aE._files.length;aG++){if(aE._files[aG].size!==undefined&&aE._files[aG].size>w.MAX_UPLOAD_SIZE){return false}}return true}else{return true}},isNotReplacingFolder:function(){if(aE._files===undefined){return true}for(var aG=0;aG<aE._files.length;aG++){var aH=aE.findMatchingItem(aE._itemToPopulate,aE._files[aG].name);if(aH&&aH.type()===w.MSBUILD_FOLDER){return false}}return true},canAddDependencyItem:function(){if(aE._files===undefined){return true}for(var aG=0;aG<aE._files.length;aG++){var aI=aE._files[aG].name;if(w.PLATFORM_TARGETED_FILE_REGEX.test(aI)){var aH=aE.findMatchingItem(aE._itemToPopulate,aI.replace(w.PLATFORM_EXTRACTION_REGEX,""));if(aH&&aH.projectItemType()!==w.PROJECT_ITEM_PLATFORM_TARGET_GROUP){return false}}}return true},isValidFileName:function(){if(aE._files===undefined){return true}for(var aH=0;aH<aE._files.length;aH++){var aG=aE._files[aH].name;w.ALLOWED_FILENAME_CHARACTERS.lastIndex=0;if(!w.ALLOWED_FILENAME_CHARACTERS.test(aG)){return false}}return true}},messages:{isValidExtension:'The following extensions are not allowed: "exe", "dll", "msi", "cmd", "bat", "proj".',isSize:"Max. upload size is 50MB.",isFolder:"Folder or empty files cannot be uploaded.",isNotReplacingFolder:"Icenium cannot store a file and a folder with identical names in the same location.",canAddDependencyItem:"Group name of platform-specific file conflicts with existing project item.",isValidFileName:"Invalid file name."}}).data("kendoValidator")},onFilesSelected:function(aD){var aN=this,aI=aD.files,aP=true,aM=aN._itemToPopulate;aN._files=aD.files;if(aN._validator.validate()){for(var aK=0;aK<aI.length;aK++){var aL=w.BrowserDetect.browser==="Explorer",aF=aI[aK].extension,aG=aI[aK].name,aH=[aN._itemToPopulate.getPath(),aG].join("\\"),aO=ap.fileSystemService.save.url({path:aH,validatorTypeName:""});aF=(aF.length>0)?aF.substring(1,aF.length):"";if(aN.findMatchingItem(aM,aG)){var aE=aN.get("existingFiles");aE.push({FilePath:aG,IconType:L.getIconTypeByFilePath(aH)})}aN.upload.options.async.saveUrl=aO}}else{aP=false;aD.preventDefault()}var aJ=this.get("canUpload");aN.set("canUpload",(aJ)?aJ:aP);aN.set("afterSelectCanUpload",(w.BrowserDetect.browser!=="Explorer")?!aP:true)},onUpload:function(aD){var aH=this,aF=w.BrowserDetect.browser==="Explorer",aE=aD.files[0],aG=[aH._itemToPopulate.getPath(),aE.name].join("\\");y.progressService.showProgress("Uploading...");aH.fileCount+=1;if(!aF){ap.fileSystemService.save({path:aG,content:aE.rawFile,validatorTypeName:""}).done($.proxy(aH.onFileUploaded,{view:aH,fileName:aE.name})).fail($.proxy(aH.onUploadError,aH));aD.preventDefault()}}.attribute("track",{featureCategory:w.TrackingTags.featureCategory.ProjectManagement.name,featureName:w.TrackingTags.featureCategory.ProjectManagement.features.AddExistingFiles}),onUploadError:function(aD){var aE=this,aF=aE.view.kendoValidator({rules:{isValid:function(){return false}},messages:{isValid:"File upload has failed."}}).data("kendoValidator");aF.validate();y.progressService.hideProgress();this.view.set("uploadFailed",true)},onCancel:function(){this.dialog().close()},dialog:function(aD){return w.Property.call.apply(this,["dialog",aD])},onFileUploadedIE:function(aD){var aE=this;aE.onFileUploaded.apply({view:aE,fileName:aD.files[0].name})},onFileUploaded:function(){var aH=this.view,aE=this.fileName,aG=aH._itemToPopulate,aD=ay.canAddNewItem(aG,aE);if(aD){at.addNewItem(aG,aE)}else{var aF=aH.findMatchingItem(aG,aE);at.reloadItemByPath(aF.getPath())}aH.fileCount-=1;aH.onAllDone()},startUpload:function(){var aD=this;if(aD.existingFiles.length>0){return B.showFileListConfirmationDialog("Replace existing items?",{message:"The destination already contains these items:",fileList:aD.existingFiles,accept:function(){aD.fileCount=0;aD.view.find(".k-upload button").trigger("click")}})}else{aD.fileCount=0;aD.view.find(".k-upload button").trigger("click")}},onAllDone:function(aD){var aE=this;y.progressService.hideProgress();if((aE.fileCount===0)&&!aE.get("uploadFailed")){this.dialog().close()}},findMatchingItem:function(aH,aD){var aJ=this,aG,aE,aI=aH;if(w.PLATFORM_TARGETED_FILE_REGEX.test(aD)){aE=aJ.findMatchingItem(aI,aD.replace(w.PLATFORM_EXTRACTION_REGEX,""));if(aE){aI=aE}}aG=aI.childItems();if(aG){for(var aF=0;aF<aG.length;aF++){if(aG[aF].text.toLowerCase()===aD.toLowerCase()){return aG[aF]}}}return null},canUpload:false,afterSelectCanUpload:false,uploadFailed:false,existingFiles:[]});var h=q.ViewModelBase.extend({init:function(aD){var aE=this;aE._itemToPopulate=aD;q.ViewModelBase.fn.init.apply(aE,arguments);aE.set("afterSelectCanUpload",(w.BrowserDetect.browser==="Explorer"))},onUploadBtnClicked:function(){var aD=this;B.showConfirmationDialog("Import and overwrite files",{message:"This operation will overwrite all your existing files. Are you sure you want to continue?",accept:function(){aD.view.find(".k-upload button").trigger("click")}})},initializeView:function(aE){var aD=this;aD.view=aE;aD.upload=aE.find("#existingFilesUpload").kendoUpload({async:{autoUpload:false,saveUrl:"/webapi/",saveField:"archivePackage"},localization:{select:"Select",uploadSelectedFiles:"Upload"},select:$.proxy(aD.onArchiveSelected,aD),upload:$.proxy(aD.onUpload,aD),success:$.proxy(aD.onFileUploadedIE,aD),error:$.proxy(aD.onUploadError,aD),complete:$.proxy(aD.onComplete,aD),showFileList:true,multiple:false}).data("kendoUpload")},onArchiveSelected:function(aD){var aK=this,aF=aD.files[0],aM=true,aJ=ay.solution(),aI=aJ.getMobileProject(),aH="";if(aK._itemToPopulate.isFolder){aH=aK._itemToPopulate.identifier()}var aE=aF.extension,aL=ap.projectService.importPackage.url({solutionName:iceConfiguration.solutionName,projectName:aI.text,parentIdentifier:aH});aE=(aE.length>0)?aE.substring(1,aE.length):"";aK._validator=aK.view.kendoValidator({rules:{isValidExtension:function(){return w.ARCHIVE_FILE_TYPE.indexOf(aE)!==-1},isSizeValid:function(){return aF.size<=w.MAX_UPLOAD_SIZE}},messages:{isValidExtension:"Importing packages other than zip, rar and 7z is not supported!",isSizeValid:"Max. upload size is 50MB."}}).data("kendoValidator");if(!aK._validator.validate()){aM=false;aD.preventDefault();return}aK.upload.options.async.saveUrl=aL;var aG=this.get("canUpload");aK.set("canUpload",(aG)?aG:aM);aK.set("afterSelectCanUpload",(w.BrowserDetect.browser!=="Explorer")?!aM:true)},onUpload:function(aD){var aJ=this,aF=w.BrowserDetect.browser==="Explorer",aE=aD.files[0],aG="",aI=ay.solution(),aH=aI.getMobileProject();y.progressService.showProgress("Uploading...");if(!aF){if(aJ._itemToPopulate.isFolder){aG=aJ._itemToPopulate.identifier()}ap.projectService.importPackage({solutionName:iceConfiguration.solutionName,projectName:aH.text,parentIdentifier:aG,archivePackage:aE.rawFile}).done($.proxy(aJ.onFileUploaded,{view:aJ,fileName:aE.name})).fail($.proxy(aJ.onUploadError,aJ));aD.preventDefault()}}.attribute("track",{featureCategory:w.TrackingTags.featureCategory.ProjectManagement.name,featureName:w.TrackingTags.featureCategory.ProjectManagement.features.AddFromArchive}),onUploadError:function(aD){var aE=this,aF=aE.view.kendoValidator({rules:{isValid:function(){return false}},messages:{isValid:"Adding from archive has failed."}}).data("kendoValidator");aF.validate();y.progressService.hideProgress();aE.set("uploadFailed",true);aE.logUploadError(aD)},logUploadError:function(aD){var aE=JSON.parse(aD.responseText);P.logOutputMessage(["Exception Message:",aE.ExceptionMessage,"<br>","Stack Trace:",aE.StackTrace].join(""))},onCancel:function(){this.dialog().close()},dialog:function(aD){return w.Property.call.apply(this,["dialog",aD])},onFileUploadedIE:function(aD){var aE=this;aE.onFileUploaded.apply({view:aE,fileName:aD.files[0].name})},onFileUploaded:function(){var aD=this.view;at.reloadSolution();aD.onComplete()},onComplete:function(aD){var aE=this;y.progressService.hideProgress();if(!aE.get("uploadFailed")){aE.dialog().close()}},canUpload:false,afterSelectCanUpload:false,uploadFailed:false,existingFiles:[]});var s=C.ConfirmationDialogViewModel.extend({init:function(){C.ConfirmationDialogViewModel.fn.init.apply(this,[])},clearItemName:function(aD){$(aD.target).prev("input").val("");this.set("itemName","");return false},getTrimmedName:function(){return $.trim(this.get("itemName").replace(/[. ]+$/,""))},itemName:""});var k=s.extend({init:function(aG,aF){var aJ=this;aJ._populatedItem=aG;var aH=aJ.getProjectType(aG);var aD=aJ.getTemplateCategory(aH);var aI=$.grep(aF,function(aK){return aK.Category===aD&&aK.LanguageName!=="Cordova"});for(var aE=0;aE<aI.length;aE++){aI[aE].iconType="ico-"+L.getIconTypeByFilePath(aI[aE].DefaultName)}aJ.itemTemplates=new O.data.DataSource({data:aI});aJ.selectedTemplate=aI[0];aJ.itemName=aJ.selectedTemplate.DefaultName;aJ._previouslySelectedTemplate=null;aJ._dialog=null;aJ.acceptClickHandler=$.proxy(aJ.onAccept,aJ);s.fn.init.apply(aJ,[]);aJ.bind("change",$.proxy(aJ.onPropertyChanged,aJ));aJ.bind("bind",$.proxy(aJ.onBind,aJ));aJ.featureCategory=w.TrackingTags.featureCategory.ProjectManagement.name;aJ.featureName=w.TrackingTags.featureCategory.ProjectManagement.features.AddNewFile},onBind:function(aD){$("input",aD.view).placeholder();$("li:first",$(aD.view).find("#itemTemplatesList")).addClass("k-state-selected");this._selectFileName(aD.view)},onSelectTemplate:function(aD){var aF=this,aG=aD.sender.select().data().uid,aE=aF.itemTemplates.getByUid(aG);this.set("selectedTemplate",aE)},getProjectType:function(aD){var aE;if(aD instanceof X){aE=aD}else{aE=aD.project}return aE.type()},getTemplateCategory:function(aE){var aD;if(aE===w.MSBUILD_PROJECT_TYPE_MVC3){aD=w.ITEM_TEMPLATE_CATEGORY_CSHARP}else{if(aE===w.MSBUILD_PROJECT_TYPE_CALLBACK){aD=w.ITEM_TEMPLATE_CATEGORY_MOBILE}}return aD},canAccept:function(){var aF=this,aD=aF.getTrimmedName(),aE=ay.canAddNewItem(aF._populatedItem,aD),aH=aF.validator(),aG=(aH)?aH.validate():true;return aG&&aD.length>0&&aF.get("selectedTemplate")&&aE},onPropertyChanged:function(aD){if(aD.field==="selectedTemplate"){this.onSelectionChanged(aD)}},onSelectionChanged:function(aE){var aG=this;var aD=aG.get("selectedTemplate");if(aD){var aF=aG._previouslySelectedTemplate;if(aD!==aF){aG.set("itemName",aD.DefaultName);aG._previouslySelectedTemplate=aD;aG._selectFileName(aE.view)}}},onAccept:function(){var aE=this,aD=aE.get("selectedTemplate");at.addNewItemByTemplate(aE._populatedItem,aD,aE.getTrimmedName());ay.cachedFunc={}},itemTemplates:[],selectedTemplate:{},acceptText:w.OK_TEXT,rejectText:w.CANCEL_TEXT,_selectFileName:function(aG){var aE=$("input",aG);var aF=aE.val();var aD=aF.lastIndexOf(".");aD=(aD>-1)?aD:aF.length;aE.focus();L.selectInputValue(aE[0],0,aD)}});var m=s.extend({init:function(aD){var aE=this;aE._populatedItem=aD;aE.acceptClickHandler=$.proxy(aE.onAccept,aE);s.fn.init.apply(aE,[])},canAccept:function(){var aE=this;var aD=aE.getTrimmedName();var aG=aE.validator();var aF=(aG)?aG.validate():true;return aF&&aD.length>0&&ay.canAddNewItem(aE._populatedItem,aD)},onAccept:function(){var aD=this.getTrimmedName();var aE=true;at.addNewFolder(this._populatedItem,aD,aE)},placeHolderText:"Folder Name",acceptText:w.OK_TEXT,rejectText:w.CANCEL_TEXT});var v=s.extend({init:function(){var aE=this;s.fn.init.apply(aE,[]);var aD=aA.solutionSettings().BuildConfiguration;if(!aD){aD=w.BUILD_CONFIG_DEBUG}aE.set("configurations",[w.BUILD_CONFIG_DEBUG,w.BUILD_CONFIG_RELEASE]);aE.set("config",aD)},config:"",configurations:[],onAcceptClicked:function(){var aD=this;ap.solutionUserSettingsService.setActiveBuildConfiguration({solutionName:iceConfiguration.solutionName,buildConfiguration:aD.get("config")}).done(function(){aA.solutionSettings().BuildConfiguration=aD.get("config");aD._buttonClickHandler("okClickHandler");aD._deferred.resolve()}).fail(function(aE){B.showMessageBox("Icenium","an error occured while setting remote repository url")})},acceptText:w.OK_TEXT,rejectText:w.CANCEL_TEXT});var G=r.CommandBase.extend({init:function(){var aD=this;r.CommandBase.fn.init.apply(aD,arguments)},execute:function(){},getType:function(){return w.COMMAND_EDIT_CONFIGURATION}});var F=r.CommandBase.extend({init:function(){var aD=this;r.CommandBase.fn.init.apply(aD,arguments);aD.ResroucesBaseFolder="App_Resources";aD.Folder="";aD.TemplateIdentifier="";aD.ResourcesRelativeFilePath="";aD.featureCategory=w.TrackingTags.featureCategory.ProjectManagement.name},execute:function(){var aJ=this;if(!aJ.TemplateIdentifier||!aJ.ResourcesRelativeFilePath){throw new Error("EditConfigurationBaseCommand::execute: TemplateIdentifier and ResourcesRelativeFilePath should be specified before calling execute.")}var aH=ay.solution();var aG=aH.getMobileProject();var aF=aG.getPath()+"\\"+aJ.ResourcesRelativeFilePath;var aE=aG._getResourceItem([aJ.Folder,aJ.Filename].join("\\"),"Folder");if(aE){at.triggerOpenFile({filename:aJ.Filename,filePath:aF,readOnly:false,virtual:false,dataItem:aE})}else{var aD=aG._getResourceItem(aJ.Folder,"Folder");var aI={Identifier:aJ.TemplateIdentifier};at.addNewItemByTemplate(aD,aI,aJ.Filename,true);at.reloadSolution()}},canExecute:function(){return true}});var E=F.extend({init:function(){var aD=this;F.fn.init.apply(aD,arguments);aD.Folder="Android";aD.Filename="AndroidManifest.xml";aD.TemplateIdentifier="Mobile.Android.ManifestXml";aD.ResourcesRelativeFilePath=[aD.ResroucesBaseFolder,aD.Folder,aD.Filename].join("\\");aD.featureName=w.TrackingTags.featureCategory.ProjectManagement.features.EditAndroidManifest},getType:function(){return w.COMMAND_EDIT_ANDROID_MANIFEST}});var D=F.extend({init:function(){var aD=this;F.fn.init.apply(aD,arguments);aD.Folder="Android\\xml";aD.Filename="config.xml";aD.TemplateIdentifier="Mobile.Cordova.Android.ConfigXml";aD.ResourcesRelativeFilePath="App_Resources\\Android\\xml\\config.xml";aD.featureName=w.TrackingTags.featureCategory.ProjectManagement.features.EditAndroidConfig},getType:function(){return w.COMMAND_EDIT_ANDROID_CONFIG},ensureConfigFolder:function(){var aK=this,aF=ay.solution().getMobileProject(),aE="App_Resources\\Android\\xml",aJ=aF.solution.text,aH=aF.text,aI=aE.split("\\").splice(1).join("\\"),aG=aF._getResourceItem(aI,"Folder");if(!aG){var aD=aF._getResourceItem("Android","Folder");at.addNewFolder(aD,"xml",false)}return(new $.Deferred()).resolve().promise()},execute:function(){var aD=this;aD.ensureConfigFolder().done(function(){F.fn.execute.apply(aD,arguments)})}});var I=F.extend({init:function(){var aD=this;F.fn.init.apply(aD,arguments);aD.Folder="iOS";aD.Filename="Info.plist";aD.TemplateIdentifier="Mobile.iOS.InfoPlist";aD.ResourcesRelativeFilePath=[aD.ResroucesBaseFolder,aD.Folder,aD.Filename].join("\\");aD.featureName=w.TrackingTags.featureCategory.ProjectManagement.features.EditiOSInfoPList},getType:function(){return w.COMMAND_EDIT_iOS_INFO_PLIST}});var H=F.extend({init:function(){var aD=this;F.fn.init.apply(aD,arguments);aD.Folder="iOS";aD.Filename="config.xml";aD.TemplateIdentifier="Mobile.Cordova.iOS.ConfigXml";aD.ResourcesRelativeFilePath=[aD.ResroucesBaseFolder,aD.Folder,aD.Filename].join("\\");aD.featureName=w.TrackingTags.featureCategory.ProjectManagement.features.EditiOSConfig},canExecute:function(){var aD=ay.solution().getMobileProject().properties.FrameworkVersion;aD=aD.replace(/\./g,"");return aD>=240},getType:function(){return w.COMMAND_EDIT_iOS_CONFIG}});var p=r.CommandBase.extend({init:function(){var aD=this;r.CommandBase.fn.init.apply(aD,arguments)},execute:function(){},getType:function(){return w.COMMAND_ADD_ROOT}});var n=r.CommandBase.extend({init:function(){var aD=this;aD.itemToPopulate=null;r.CommandBase.fn.init.apply(aD,arguments)},canExecute:function(){var aI=this;var aE=ad.selectedDomElements();aI.itemToPopulate=null;if(aE){var aJ=$(aE[0]).closest("[data-role=treeview]").data("kendoTreeView");for(var aG=0;aG<aE.length;aG++){var aD=aJ.dataItem(aE[aG]);var aH=aD.parentItem;if(aD.getIsDropTarget()){aI.itemToPopulate=aD;break}else{if(aH&&aH.getIsDropTarget()){aI.itemToPopulate=aH;break}else{if(aD instanceof ar){var aF=aD.childItems(0);if(aF){aI.itemToPopulate=aF;break}}}}}}return(aI.itemToPopulate!==null)},execute:function(){}});var i=n.extend({init:function(){var aD=this;n.fn.init.apply(aD,arguments);aD.featureCategory=w.TrackingTags.featureCategory.ProjectManagement.name;aD.featureName=w.TrackingTags.featureCategory.ProjectManagement.features.AddNewFile},execute:function(){var aD=this;ap.projectService.getItemTemplates().done(function(aG){var aH=$(j);var aK=new k(aD.itemToPopulate,aG);var aI=aH.kendoValidator({rules:{isNotItemExtensionProj:function(aL){return ay.isNotItemExtensionProj(aL.val())},fileExists:function(aL){var aM=$.trim(arguments[0].val()).replace(/[. ]+$/,""),aN=ay.canAddNewItem(aK._populatedItem,aM);return aM.length>0&&aN}},messages:{fileExists:"File with this name already exists."}}).data("kendoValidator");O.ui.ListView.fn.options.selectable=false;var aF;var aJ=function(aL){aF=aL};var aE=L.buildDialogInputHandler(aK);B.showConfirmationDialog("Add New File",{template:aH,viewModel:aK,validator:aI,viewInitialized:aJ,active:function(){aE(aF)},width:"410px"})})},getType:function(){return w.COMMAND_ADD_FILE}});var c=n.extend({init:function(){n.fn.init.apply(this,arguments)},execute:function(){var aE=this;var aF=new e(aE.itemToPopulate);var aD=B.showModalDialog("Add Existing Files",{template:d,viewModel:aF,viewInitialized:function(aG){aF.initializeView(aG)},width:"410px",maxHeight:"410px"});aF.dialog(aD)},getType:function(){return w.COMMAND_ADD_EXISTING_FILES}});var aq=function(aE){var aF=this,aG=new h(aE),aD=B.showModalDialog("Add From Archive",{template:g,viewModel:aG,viewInitialized:function(aH){aG.initializeView(aH)},width:"410px",maxHeight:"410px"});aG.dialog(aD)};var f=n.extend({init:function(){n.fn.init.apply(this,arguments)},execute:function(){var aD=this;aq.apply(aD,[aD.itemToPopulate])},getType:function(){return w.COMMAND_ADD_FROM_ARCHIVE}});var o=r.CommandBase.extend({execute:function(){var aE=this,aD=ay.solution().getMobileProject()._getPluginsDir();aq.apply(aE,[aD])},canExecute:function(){return true},getType:function(){return w.COMMAND_ADD_PLUGIN_FROM_ARCHIVE}});var l=n.extend({init:function(){var aD=this;n.fn.init.apply(this,arguments);aD.featureCategory=w.TrackingTags.featureCategory.ProjectManagement.name;aD.featureName=w.TrackingTags.featureCategory.ProjectManagement.features.AddNewFolder},execute:function(){var aG=this;var aF=$(M);var aH=aF.kendoValidator().data("kendoValidator");var aJ=new m(aG.itemToPopulate);var aE;var aI=function(aK){aE=aK};var aD=L.buildDialogInputHandler(aJ);B.showConfirmationDialog("Add New Folder",{template:aF,viewModel:aJ,validator:aH,viewInitialized:aI,active:function(){aD(aE)},width:"410px"})},getType:function(){return w.COMMAND_ADD_FOLDER}});var A=r.CommandBase.extend({init:function(){var aD=this;aD.elementsToDelete=null;r.CommandBase.fn.init.apply(aD,arguments);aD.featureCategory=w.TrackingTags.featureCategory.ProjectManagement.name;aD.featureName=w.TrackingTags.featureCategory.ProjectManagement.features.DeleteItems},canExecute:function(){var aJ=this,aE=ad.selectedDomElements();aJ.elementsToDelete=[];if(aE){for(var aF=0;aF<aE.length;aF++){var aD=$(aE[aF]).data("dataItem"),aH=aD.projectItemType(),aG=aD.parentItem,aI=aD.getIsDeletable()&&!(aD instanceof ar)&&!(aD instanceof X)&&aH!==w.PROJECT_ITEM_PROJECT_REFERENCE&&aH!==w.PROJECT_ITEM_PROPERTIES_DIRECTORY&&aH!==w.PROJECT_ITEM_REFERENCES_DIRECTORY&&aH!==w.PROJECT_ITEM_CORDOVA_GROUP;if(aI){aJ.elementsToDelete.push(aE[aF])}}}return(aJ.elementsToDelete.length>0)},execute:function(){var aE=this;var aD=$(aE.elementsToDelete[0]).data("dataItem");B.showFileListConfirmationDialog("Delete",{message:"Are you sure you want to delete this item?",fileList:[{FilePath:aD.text,IconType:aD.iconType()}],accept:function(){at.deleteItems(aE.elementsToDelete)}})},getType:function(){return w.COMMAND_DELETE_ITEMS}});var R=r.CommandBase.extend({init:function(){var aD=this;aD.elementsToOpen=null;r.CommandBase.fn.init.apply(aD,arguments);aD.featureCategory=w.TrackingTags.featureCategory.ProjectManagement.name;aD.featureName=w.TrackingTags.featureCategory.ProjectManagement.features.OpenItem},canExecute:function(){var aG=this,aE=ad.selectedDomElements();aG.elementsToOpen=[];if(aE){var aH=$(aE[0]).closest("[data-role=treeview]").data("kendoTreeView");for(var aF=0;aF<aE.length;aF++){var aD=aH.dataItem(aE[aF]);if(aD.projectItemType()===w.PROJECT_ITEM_FILE||aD.projectItemType()===w.PROJECT_ITEM_PROPERTIES_DIRECTORY){aG.elementsToOpen.push(aE[aF])}}}return(aG.elementsToOpen.length>0)},execute:function(){var aE=this;var aD=$(aE.elementsToOpen[0]).data("dataItem");at.openProjectItem(aD);y.keyBindingService.focusRegion(w.VIEWPANE_REGION)},getType:function(){return w.COMMAND_OPEN_ITEM}});var am=s.extend({init:function(aD){var aE=this;aE.itemName=aD.text;aE._item=aD;aE._dialog=null;aE.acceptClickHandler=$.proxy(aE.onAccept,aE);s.fn.init.apply(aE,[]);aE.bind("bind",$.proxy(aE.onBind,aE))},onBind:function(aD){$("input",aD.view).placeholder()},canAccept:function(){var aF=this,aD=aF._item,aE=aF.getTrimmedName(),aH=aF.validator(),aG=(aH)?aH.validate():true;return aG&&aE.length>0&&ay.canRenameItem(aD,aE)},onAccept:function(){var aF=this,aE=aF.getTrimmedName(),aD=aF._item;if(aD.text!==aE){at.renameItem(aD,aE);ay.cachedFunc={}}},placeHolderText:"Item Name",acceptText:w.OK_TEXT,rejectText:w.CANCEL_TEXT});var al=r.CommandBase.extend({init:function(){var aD=this;r.CommandBase.fn.init.apply(aD,arguments);aD.itemToRename=null;aD.featureCategory=w.TrackingTags.featureCategory.ProjectManagement.name;aD.featureName=w.TrackingTags.featureCategory.ProjectManagement.features.RenameItem},canExecute:function(){var aJ=this;var aE=ad.selectedDomElements();aJ.itemToRename=null;if(aE){for(var aF=0;aF<aE.length;aF++){var aD=$(aE[aF]).data("dataItem"),aH=aD.projectItemType(),aG=aD.parentItem,aI=aD.getIsRenamable()&&aH!==w.PROJECT_ITEM_ASSEMBLY_REFERENCE&&aH!==w.PROJECT_ITEM_PROJECT_REFERENCE&&aH!==w.PROJECT_ITEM_PROPERTIES_DIRECTORY&&aH!==w.PROJECT_ITEM_REFERENCES_DIRECTORY&&aH!==w.PROJECT_ITEM_CORDOVA_GROUP;if(aI){aJ.itemToRename=aD;break}}}return(aJ.itemToRename!==null)},execute:function(){var aG=this,aK=new am(aG.itemToRename);var aF=$(M);var aH=aF.kendoValidator({rules:{isNotItemExtensionProj:function(aL){return ay.isNotItemExtensionProj(aL.val())},solutionWithSameNameExists:function(aL){var aM=$.trim(aL.val());if(aG.itemToRename.isSolution){if(aM===iceConfiguration.solutionName){return true}else{return !ay.solutionNameExists(aM)}}else{return true}},fileExists:function(aL){var aM=aG.itemToRename,aN=$.trim(arguments[0].val()).replace(/[. ]+$/,"");return aN.length>0&&ay.canRenameItem(aM,aN)}},messages:{fileExists:"File with this name already exists."}}).data("kendoValidator");var aE;var aJ=function(aL){aE=aL};var aI=function(){var aN=$("input",aE);var aM=aN[0];aN.focus();var aO=aN.val();var aL=aO.lastIndexOf(".");aL=(aL>-1)?aL:aO.length;L.selectInputValue(aM,0,aL);aN.keypress(function(aP){if(aP.keyCode===w.KEY_ENTER&&aK.canAccept()){aK.onAcceptClicked();aP.preventDefault();aP.stopPropagation()}})};if(aG.itemToRename.isSolution){var aD=ay.loadExistingSolutions();y.progressService.showProgress("Loading...");aD.done(function(){y.progressService.hideProgress();aG.showDialog(aF,aK,aH,aJ,aI)})}else{aG.showDialog(aF,aK,aH,aJ,aI)}},showDialog:function(aD,aH,aE,aG,aF){B.showConfirmationDialog("Rename",{template:aD,viewModel:aH,validator:aE,viewInitialized:aG,active:aF})},getType:function(){return w.COMMAND_RENAME_ITEM}});var x=r.CommandBase.extend({init:function(){var aD=this;r.CommandBase.fn.init.apply(aD,arguments);aD.itemsToCopy=[];aD.featureCategory=w.TrackingTags.featureCategory.ProjectManagement.name;aD.featureName=w.TrackingTags.featureCategory.ProjectManagement.features.CopyItems},canExecute:function(){var aI=this,aE=ad.selectedDomElements();aI.itemsToCopy=[];if(aE){for(var aF=0;aF<aE.length;aF++){var aG,aH,aD=$(aE[aF]).data("dataItem");if(aD){aG=aD.projectItemType(),aH=aD.getIsCopyable()&&!(aD instanceof ar)&&!(aD instanceof X)&&aG!==w.PROJECT_ITEM_ASSEMBLY_REFERENCE&&aG!==w.PROJECT_ITEM_PROJECT_REFERENCE&&aG!==w.PROJECT_ITEM_PROPERTIES_DIRECTORY&&aG!==w.PROJECT_ITEM_REFERENCES_DIRECTORY&&aG!==w.PROJECT_ITEM_CORDOVA_GROUP;if(aH){aI.itemsToCopy.push(aD)}}}}return(aI.itemsToCopy.length>0)},execute:function(){U.copyProjectItems(this.itemsToCopy)},getType:function(){return w.COMMAND_COPY_ITEMS}});var z=x.extend({init:function(){var aD=this;x.fn.init.apply(aD,arguments)},execute:function(){U.cutProjectItems(this.itemsToCopy)},getType:function(){return w.COMMAND_CUT_ITEMS}});var W=r.CommandBase.extend({init:function(){var aD=this;r.CommandBase.fn.init.apply(aD,arguments);aD.pasteTarget=null;aD.coppiedItems=null;aD.featureCategory=w.TrackingTags.featureCategory.ProjectManagement.name;aD.featureName=w.TrackingTags.featureCategory.ProjectManagement.features.PasteItems},canExecute:function(){var aG=this;var aE=ad.selectedDomElements();aG.pasteTarget=null;aG.coppiedItems=U.getCopiedItems();if(aG.coppiedItems.length>0){if(aE){for(var aF=0;aF<aE.length;aF++){var aD=$(aE[aF]).data("dataItem");if(aD.getIsPasteTarget()){aG.pasteTarget=aD;break}}}return(aG.pasteTarget&&aG.coppiedItems.indexOf(aG.pasteTarget)<0)&&!aG.pasteTarget.getIsChildOf(aG.coppiedItems)}return false},execute:function(){var aD=this;at.pasteProjectItemsInternally(aD.pasteTarget,U.getAreItemsCut(),aD.coppiedItems)},getType:function(){return w.COMMAND_PASTE_ITEMS}});var t=r.CommandBase.extend({init:function(){var aD=this;r.CommandBase.fn.init.apply(aD,arguments)},execute:function(){B.showConfirmationDialog("Build Settings",{template:u,viewModel:new v(),width:"410px"})},getType:function(){return w.COMMAND_BUILD_SETTINGS}});var aj=r.CommandBase.extend({init:function(){var aD=this;r.CommandBase.fn.init.apply(aD,arguments);aD.featureCategory=w.TrackingTags.featureCategory.ProjectManagement.name;aD.featureName=w.TrackingTags.featureCategory.ProjectManagement.features.ProjectProperties},execute:function(){var aD=ay.solution().getMobileProject().getPropertiesFolderItem();at.openProjectItem(aD)},getType:function(){return w.COMMAND_PROJECT_PROPERTIES}});var T=aj.extend({init:function(){var aD=this;aj.fn.init.apply(aD,arguments)},getType:function(){return w.COMMAND_OPEN_PROJECT_PROPERTIES}});var K=r.CommandBase.extend({init:function(){var aD=this;r.CommandBase.fn.init.apply(aD,arguments)},execute:function(){y.keyBindingService.focusRegion(w.PROJECT_NAVIGATOR_REGION)},getType:function(){return w.COMMAND_FOCUS_PROJECT_TREE}});var S=r.CommandBase.extend({init:function(){var aD=this;r.CommandBase.fn.init.apply(aD,arguments)},execute:function(aD){var aE=this,aF;y.progressService.showProgress("Loading plugin xml...");$.ajax({type:"GET",url:aD}).done(function(aG){aF=new Z();aF.type(w.MSBUILD_CONTENT);aF.projectItemType(w.PROJECT_ITEM_FILE);aF.documentType(w.DOCUMENT_TYPE_CONFIG);at.triggerOpenFile({filename:"plugin.xml",filePath:aD,dataItem:aF,fileContent:(new XMLSerializer()).serializeToString(aG),readOnly:true,virtual:true})}).always(function(){y.progressService.hideProgress()})},getType:function(){return w.COMMAND_OPEN_PLUGIN_XML}});var a=null;function ac(){var aD=this;ag=new ah();aD.solutionController=at=new au();aD.projectNavigatorService=ad=new ae();aD.solutionService=ay=new az();aD.projectItemMetadataService=aa=new ab();aD.pasteBoardService=U=new V()}ac.prototype={init:function(){var aE=this,aD={name:"Project Navigator",iconClass:"project-nav",template:af,viewModel:ag};y.frameService.addItemToRegion(w.SIDEBAR_REGION,aD);aE.registerCommands();at.loadSolutionData(true)},registerCommands:function(){var aD=new p(w.COMMAND_ADD_ROOT,"Add",[w.SOLUTION_MENU_COMMANDS,w.PROJECT_NAVIGATOR_NODE_COMMANDS]);aD.addCommand(new i(w.COMMAND_ADD_FILE,"New File",[w.SOLUTION_MENU_COMMANDS,w.PROJECT_NAVIGATOR_NODE_COMMANDS],[{region:w.PROJECT_NAVIGATOR_REGION,keyShortcut:{modifiers:[w.KEY_CTRL,w.KEY_ALT],keys:[w.KEY_N]}}])).addCommand(new l(w.COMMAND_ADD_FOLDER,"New Folder",[w.SOLUTION_MENU_COMMANDS,w.PROJECT_NAVIGATOR_NODE_COMMANDS],[{region:w.PROJECT_NAVIGATOR_REGION,keyShortcut:{modifiers:[w.KEY_CTRL,w.KEY_ALT],keys:[w.KEY_D]}}])).addCommand(new c(w.COMMAND_ADD_EXISTING_FILES,"Existing Files",[w.SOLUTION_MENU_COMMANDS,w.PROJECT_NAVIGATOR_NODE_COMMANDS],[{region:w.PROJECT_NAVIGATOR_REGION,keyShortcut:{modifiers:[w.KEY_CTRL,w.KEY_ALT],keys:[w.KEY_X]}}])).addCommand(new f(w.COMMAND_ADD_FROM_ARCHIVE,"From Archive",[w.SOLUTION_MENU_COMMANDS,w.PROJECT_NAVIGATOR_NODE_COMMANDS],[{region:w.PROJECT_NAVIGATOR_REGION,keyShortcut:{modifiers:[w.KEY_CTRL,w.KEY_ALT],keys:[w.KEY_A]}}]));var aE=new G(w.COMMAND_EDIT_CONFIGURATION,"Edit Configuration",[w.SOLUTION_MENU_COMMANDS,w.PROJECT_NAVIGATOR_NODE_COMMANDS]);aE.addCommand(new E(w.COMMAND_EDIT_ANDROID_MANIFEST,"Android Manifest",[w.SOLUTION_MENU_COMMANDS,w.PROJECT_NAVIGATOR_NODE_COMMANDS])).addCommand(new D(w.COMMAND_EDIT_ANDROID_CONFIG,"Android Config.xml",[w.SOLUTION_MENU_COMMANDS,w.PROJECT_NAVIGATOR_NODE_COMMANDS])).addCommand(new I(w.COMMAND_EDIT_iOS_INFO_PLIST,"iOS Info.plist",[w.SOLUTION_MENU_COMMANDS,w.PROJECT_NAVIGATOR_NODE_COMMANDS])).addCommand(new H(w.COMMAND_EDIT_iOS_CONFIG,"iOS Config.xml",[w.SOLUTION_MENU_COMMANDS,w.PROJECT_NAVIGATOR_NODE_COMMANDS]));y.commandService.registerCommand(new R(w.COMMAND_OPEN_ITEM,"Open",[w.PROJECT_NAVIGATOR_NODE_COMMANDS],[{region:w.PROJECT_NAVIGATOR_REGION,keyShortcut:{modifiers:[],keys:[w.KEY_ENTER]}}])).registerCommand(aD).registerCommand(aE).registerCommand(new t(w.COMMAND_BUILD_SETTINGS,"Build Settings",[w.PROJECT_NAVIGATOR_NODE_COMMANDS])).registerCommand(new al(w.COMMAND_RENAME_ITEM,"Rename",[w.PROJECT_NAVIGATOR_NODE_COMMANDS],[{region:w.PROJECT_NAVIGATOR_REGION,keyShortcut:{modifiers:[],keys:[w.KEY_F2],preventDefaultBrowserAction:true}}])).registerCommand(new z(w.COMMAND_CUT_ITEMS,"Cut",[w.PROJECT_NAVIGATOR_NODE_COMMANDS],[{region:w.PROJECT_NAVIGATOR_REGION,keyShortcut:{modifiers:[w.KEY_CTRL],keys:[w.KEY_X],modifiersOSX:[w.KEY_CMD]}}])).registerCommand(new x(w.COMMAND_COPY_ITEMS,"Copy",[w.PROJECT_NAVIGATOR_NODE_COMMANDS],[{region:w.PROJECT_NAVIGATOR_REGION,keyShortcut:{modifiers:[w.KEY_CTRL],keys:[w.KEY_C],modifiersOSX:[w.KEY_CMD]}}])).registerCommand(new A(w.COMMAND_DELETE_ITEMS,"Delete",[w.PROJECT_NAVIGATOR_NODE_COMMANDS],[{region:w.PROJECT_NAVIGATOR_REGION,keyShortcut:{modifiers:[],keys:[w.KEY_DEL]}}])).registerCommand(new W(w.COMMAND_PASTE_ITEMS,"Paste",[w.PROJECT_NAVIGATOR_NODE_COMMANDS],[{region:w.PROJECT_NAVIGATOR_REGION,keyShortcut:{modifiers:[w.KEY_CTRL],keys:[w.KEY_V],modifiersOSX:[w.KEY_CMD]}}])).registerCommand(new aj(w.COMMAND_PROJECT_PROPERTIES,"Properties",[w.PROJECT_NAVIGATOR_NODE_COMMANDS],[{region:w.PROJECT_NAVIGATOR_REGION}],this)).registerCommand(new T(w.COMMAND_OPEN_PROJECT_PROPERTIES,"Open",[w.PROJECT_NAVIGATOR_NODE_COMMANDS],[{region:w.PROJECT_NAVIGATOR_REGION}],this));y.commandService.registerCommand(new K(w.COMMAND_FOCUS_PROJECT_TREE,"Focus Project Tree",[w.GLOBAL_NON_UI_COMMANDS],[{region:w.GLOBAL_REGION,keyShortcut:{modifiers:[w.KEY_CTRL,w.KEY_SHIFT],keys:[w.KEY_P],preventDefaultBrowserAction:true}}])).registerCommand(new o(w.COMMAND_ADD_PLUGIN_FROM_ARCHIVE,"Add plugin from archive",[w.PLUGIN_PROPERTIES_COMMANDS])).registerCommand(new S(w.COMMAND_OPEN_PLUGIN_XML,"Open plugin xml",[w.PLUGIN_PROPERTIES_COMMANDS]))},_consts:b};var ak=new ac();ak.init();Q.exports={solutionController:ak.solutionController,projectNavigatorService:ak.projectNavigatorService,solutionService:ak.solutionService,projectItemMetadataService:ak.projectItemMetadataService,pasteBoardService:ak.pasteBoardService}});