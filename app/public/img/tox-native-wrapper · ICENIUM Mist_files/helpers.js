define(function(c){var a=window;var b={getNode:function(e,d){d++;return $(">ul.k-group>li:nth-child("+d+")",e)[0]},mimeTypeCache:{},assignTreeViewDataItems:function(j,h){var k=this;if(h){var g=$.map(h,function(l,i){return{node:k.getNode(j,i),dataItem:l}});while(g.length>0){var d=g.shift();var e=d.dataItem;if(e.childItems&&e.childItems()){for(var f=0;f<e.childItems().length;f++){g.push({node:k.getNode(d.node,f),dataItem:e.childItems(f)})}}$(d.node).data("dataItem",d.dataItem);if(!d.dataItem.element){d.dataItem.element=$.proxy(k.element,d.dataItem)}d.dataItem.element(d.node)}}},getDocumentTypeByFilePath:function(f){var g=this;var e=g.getFileExtension(f);var d;switch(e){case a.DOCUMENT_TYPE_TEXT:case a.DOCUMENT_TYPE_DB_SDF:case a.DOCUMENT_TYPE_XAML:case a.DOCUMENT_TYPE_VB:case a.DOCUMENT_TYPE_MASTER:case a.DOCUMENT_TYPE_JAVA_SCRIPT:case a.DOCUMENT_TYPE_CSS:case a.DOCUMENT_TYPE_CSHTML:case a.DOCUMENT_TYPE_CSHARP:case a.DOCUMENT_TYPE_CONFIG:case a.DOCUMENT_TYPE_ASPX:case a.DOCUMENT_TYPE_ASCX:case a.DOCUMENT_TYPE_ASAX:d=e;break;default:d=g._selectTypeFromExtensionTuples(e,[a.DOCUMENT_TYPE_HTML]);if(!d){d=a.DOCUMENT_TYPE_UNKNOWN}break}return d},_selectTypeFromExtensionTuples:function(e,h){var g=null;for(var f=0;f<h.length;f++){var d=h[f].split(",");if(d.indexOf(e)!==-1){g=d[0];break}}return g},getIconTypeByFilePath:function(e){var h=this;var f=a.ICON_UNKNOWN,d=h.getDocumentTypeByFilePath(e);if(d!==a.DOCUMENT_TYPE_UNKNOWN){if(a.ICON_FILE_EXTENSIONS.indexOf(d)!==-1){f=d}}else{var g=b.isImageFile(e);if(g){f=a.ICON_IMAGE}}return f},getFileExtension:function(d){var e=d.split(".");return e[e.length-1].toLowerCase()},IMAGE_EXTENSIONS:["png","jpg","jpeg","gif","bmp","ico"],isImageFile:function(e){var g=this,d=g.getFileExtension(e),f=g.getResourceTypeByExtension(d);return((g.IMAGE_EXTENSIONS.indexOf(d)>=0)||(f.indexOf("image")>=0))},getResourceTypeByExtension:function(d){var k=this,h,e,j=[];if(k.mimeTypeCache[d]===undefined){for(var f=0,g=navigator.mimeTypes.length;f<g;f++){h=navigator.mimeTypes[f];if(h.suffixes.indexOf(d)>=0){e=h.type.split("/")[0];if(j.indexOf(e)<0){j.push(e)}}}if(j.length===0){j.push("unknownMimeType")}k.mimeTypeCache[d]=j}return k.mimeTypeCache[d]},element:function(d){return Property.call.apply(this,["element",d])},compareStrings:function(d,e){if(!d||!e){return(d===e)}return($.trim(d.toLowerCase())===$.trim(e.toLowerCase()))},buildDialogInputHandler:function(g,d,e){var f=function(h,m){var k,l=$("input",h);if(l.length>0){$(l[0]).focus();for(var j=0;j<l.length;j++){k=$(l[j]);k.keypress(function(i){if(i.keyCode===a.KEY_ENTER&&m.canAccept()){m.onAcceptClicked();i.preventDefault();i.stopPropagation()}})}}};return function(h){if(!e){f.apply(this,[h,g])}if(d){d.apply(this,[h])}}},selectInputValue:function(e,g,d){if(typeof e.selectionStart!=="undefined"){e.selectionStart=g;e.selectionEnd=d}else{if(document.selection&&document.selection.createRange){e.focus();e.select();var f=document.selection.createRange();f.collapse(true);f.moveEnd("character",d);f.moveStart("character",g);f.select()}}},getNonCachedUrl:function(d){return d+this.getNonCachedUrlEnding()},getNonCachedUrlEnding:function(){return"?timestamp="+(new Date()).toString().replace(/\s/g,"_")},applyAlternationToElements:function(e,d){var f=false;$(e).each(function(){var g=$(this);if(f){if(!g.hasClass(d)){g.addClass(d)}}else{g.removeClass(d)}f=!f})},applyGridAlternation:function(d){this.applyAlternationToElements(d.tbody.find("tr"),"k-alt")},removeArrayPaddings:function(d){return $(d).filter(function(e){return d[e]}).toArray()},filterPendingChangesBySelection:function(f){var g=[];for(var e=0;e<f.length;e++){var d=f[e];g.push({FilePath:d.name,IconType:d.iconType,ChangeType:d.changeType})}return g},validate9PatchImage:function(g){var h=this,j=window.URL||window.webkitURL,d=document.createElement("canvas").getContext("2d"),i=j.createObjectURL(g),e=$.Deferred(),f=new Image();$(f).on("load",function(){var k;j.revokeObjectURL(i);d.drawImage(f,0,0);k=d.getImageData(0,0,f.width,f.height);e.resolve(h.isValid9PatchImage(k))});f.src=i;return e.promise()},isValid9PatchImage:function(e){var g;if(e.width<3||e.height<3){return false}function d(m,n,o){var l=(n+o*m.width)*4;return{r:m.data[l+0],g:m.data[l+1],b:m.data[l+2],a:m.data[l+3]}}function f(n){var m=n.a===0,l=n.a===255&&n.r===0&&n.g===0&&n.b===0;return m||l}for(var h=0;h<e.width;h++){g=d(e,h,0);if(!f(g)){return false}}for(var j=0;j<e.height;j++){g=d(e,0,j);if(!f(g)){return false}}for(var i=0;i<e.width;i++){g=d(e,i,e.height-1);if(!f(g)){return false}}for(var k=0;k<e.height;k++){g=d(e,e.width-1,k);if(!f(g)){return false}}return true},ensureJSON:function(d){if(typeof d==="string"){return JSON.parse(d)}return d}};return b});